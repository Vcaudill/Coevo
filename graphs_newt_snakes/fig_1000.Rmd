---
title: "Graphs for 1000  Generations"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(viridis)
library(colorspace)

#setwd("~/Desktop/Proposal Old Drafts")
```

## This is a r file to show what the phenotypess are after 1000 generations
A problem that I have been experiencing is that the phenotypes seem so go wild really quickly. One species' phenotype balloons to be really high while the other species" phenotype stays really low.  

This will be a graph that looks at the phenotypes of different simulations with a unique mutation rate and mutation effect size.

Lets just visualize what the phenotypes are doing.

## The testing Paramiters 
I used different values for snake_mu_effect_sd	newt_mu_effect_sd	snake_mu_rate	newt_mu_rate. I chose these parameters to see if there would be a seeable interaction in phenotypes 
Other params:
	sigma_i = 1, recomb=1e-8, sigma_in = 0.5, sigma_M = 0.33, SD=SI=surs=SM=sigma_in, L = 4, W=35.0, G=1e8, FECUN = 1/(L), RHO, FECUN/((1+FECUN) * K), interaction_rate =  0.05, PE = 0.1, w= 10, c = 0.0, initializeRecombinationRate(recomb), initializeMutationRate(1e-10), initializeGenomicElement(g1, 0, G-1)
	
Other things: (kind of confusing)	
	initializeMutationType("m1", 0.5, "n", 0, newt_mu_effect_sd);
	initializeMutationType("m2", 0.5, "n", 0, snake_mu_effect_sd);
	initializeGenomicElementType("g1", c(m1, m2), c(newt_mu_rate/mu_rate, 1)); // mutation proportions add the proportion (the target mutation rate)

Snake/newt mu effect sd -> is the standard deviation that each mutation would "effect" a phenotype. Values: 0.01 0.05 0.2 0.5

Snake/newt mu rate -> is the mutation rate that were assigned to newts and snakes. Values: 1.00E-08 1.00E-10 1.00E-12

In total there were 144 combinations. One simulation per combination (this experiment was not repeated) 

## Project future goal as of summer 2021
My summer 2021 goal is to get the 1 on 1 simulation to run *correctly*. For this to happen I would like the simulation to have:
-Realistic phenotypes (snake 0-3, newt 0-1.5(thoughts 2021?))
-See if the levels of toxicity and resistance interact 
-See groups of mutations/ certain phenotypes

# Mistake Simulations 
I tried to run SLiM simulation different with the selected parameters and the MSprime   both_su_1e-10_nu_1e-10_sue_0.01_nue_0.01 (s/n u mutation rate, n/s ue mutation effect size).
However I flipped the mutation rate and effect size. So... new experiment with really large mutation rate and small effect size????

# Makeing of the Figure
Loop through the files and find the max and min of each of the species phenotypes
Then set up a graph with the average phenotype 

This section of code loops though the files and finds the maximum and minumum pheotypes of newts and snakes. and make two lines (red for newts blue for snakes) and keep a minimum about of info in mem at a time

```{r functions, echo=FALSE}

collect_data_points <- function(files) {
  newt_max_pheno_1 = 0
  snake_max_pheno_1 = 0
  newt_min_pheno_1 = 0
  snake_min_pheno_1 = 0
  true_max_1 = 0
  true_min_1 = 0
  min_difference_1 = 0
  max_difference_1 = 0
  mean = 0
  sd = 0
  mean_mean_dif = 0
  sd_mean_dif = 0
 

  for (current_file in files){
  #print(current_file)

  file <- read.table(current_file, header = TRUE)
  
  file$Newt_max_Pheno[file$Newt_max_Pheno == "NULL"] <- NA
  file$Snake_max_Pheno[file$Snake_max_Pheno == "NULL"] <- NA
  file$Newt_min_Pheno[file$Newt_min_Pheno == "NULL"] <- NA
  file$Snake_min_Pheno[file$Snake_min_Pheno == "NULL"] <- NA
  file$Newt_mean_Pheno[file$Newt_mean_Pheno == "NULL"] <- NA
  file$Snake_mean_Pheno[file$Snake_mean_Pheno == "NULL"] <- NA
  file$Newt_mean_Pheno <- lapply(file$Newt_mean_Pheno,as.numeric)
  file$Snake_mean_Pheno <- lapply(file$Snake_mean_Pheno,as.numeric)
  file$Newt_max_Pheno <- lapply(file$Newt_max_Pheno,as.numeric)
  file$Snake_max_Pheno <- lapply(file$Snake_max_Pheno,as.numeric)
  file$Newt_min_Pheno <- lapply(file$Newt_min_Pheno,as.numeric)
  file$Snake_min_Pheno <- lapply(file$Snake_min_Pheno,as.numeric)
  
  mean = mean(c(as.numeric(file$Newt_mean_Pheno), as.numeric(file$Snake_mean_Pheno)), na.rm = TRUE)
  sd = sd(c(as.numeric(file$Newt_mean_Pheno), as.numeric(file$Snake_mean_Pheno)), na.rm = TRUE)
  mean_mean_dif = mean(as.numeric(file$Snake_mean_Pheno) - as.numeric(file$Newt_mean_Pheno),na.rm = TRUE)
  sd_mean_dif = sd(as.numeric(file$Snake_mean_Pheno) - as.numeric(file$Newt_mean_Pheno),na.rm = TRUE)
  

    if (max(as.numeric(file$Newt_max_Pheno), na.rm = TRUE) > newt_max_pheno_1){
    newt_max_pheno_1 = max(as.numeric(file$Newt_max_Pheno), na.rm = TRUE) }
  
  if (max(as.numeric(file$Snake_max_Pheno), na.rm = TRUE) > snake_max_pheno_1){
    snake_max_pheno_1 = max(as.numeric(file$Snake_max_Pheno), na.rm = TRUE) }
  
  if (min(as.numeric(file$Newt_min_Pheno), na.rm = TRUE) < newt_min_pheno_1){
    newt_min_pheno_1 = min(as.numeric(file$Newt_min_Pheno), na.rm = TRUE) }
  
  if (min(as.numeric(file$Snake_min_Pheno), na.rm = TRUE) < snake_min_pheno_1){
    snake_min_pheno_1 = min(as.numeric(file$Snake_min_Pheno), na.rm = TRUE) }
  
  if (min(as.numeric(file$Snake_mean_Pheno), na.rm = TRUE) - max(as.numeric(file$Newt_mean_Pheno), na.rm = TRUE) < min_difference_1){
    min_difference_1 = min(as.numeric(file$Snake_mean_Pheno), na.rm = TRUE) - max(as.numeric(file$Newt_mean_Pheno), na.rm = TRUE)
  }
  
  
  if (max(as.numeric(file$Snake_mean_Pheno), na.rm = TRUE) - min(as.numeric(file$Newt_mean_Pheno), na.rm = TRUE) > max_difference_1){
    max_difference_1 = max(as.numeric(file$Snake_mean_Pheno), na.rm = TRUE) - min(as.numeric(file$Newt_mean_Pheno), na.rm = TRUE)
  }
  }
  
    if (newt_max_pheno_1 > snake_max_pheno_1){
    true_max_1 = newt_max_pheno_1 }
  if ( snake_max_pheno_1 > newt_max_pheno_1){
    true_max_1 = snake_max_pheno_1 }
  
    if (newt_min_pheno_1 < snake_min_pheno_1){
    true_min_1 = newt_min_pheno_1 }
  if ( snake_min_pheno_1 < newt_min_pheno_1){
    true_min_1 = snake_min_pheno_1 }
  
  return(c(newt_max_pheno_1, snake_max_pheno_1, newt_min_pheno_1, snake_min_pheno_1, true_max_1, true_min_1, min_difference_1, max_difference_1, mean, sd, mean_mean_dif, sd_mean_dif))
}


phenotype_graph <- function(files, the_mean, the_sd, title, is_log=FALSE){

  file1 <- read.table(files[1], header = TRUE)
  file1$Newt_mean_Pheno[file$Newt_mean_Pheno == "NULL"] <- NA
  file1$Snake_mean_Pheno[file$Snake_mean_Pheno == "NULL"] <- NA
p <- ggplot(file1, aes(x=gen)) +
  xlim(0, 1000)+
  #ylim(0, true_max_1)+
  geom_line(aes(y = Newt_mean_Pheno), color = "darkred") + 
  geom_line(aes(y = Snake_mean_Pheno), color="steelblue", linetype="twodash")+
  ggtitle(title) +
  xlab("Generation") + ylab("Average Phenotypes")+
  theme_bw()

if(is_log==TRUE){
  p = p + ylab("Average Phenotypes (Log)") + scale_y_log10(limits=c(the_mean-(the_sd*10), the_mean+(the_sd*10)))
  }

for (current_file in files){
  #print(current_file)

  file <- read.table(current_file, header = TRUE)
  file$Newt_mean_Pheno[file$Newt_mean_Pheno == "NULL"] <- NA
  file$Snake_mean_Pheno[file$Snake_mean_Pheno == "NULL"] <- NA
 p <- p +
  geom_line(data=file, aes(y = Newt_mean_Pheno), color = "darkred") + 
  geom_line(data=file, aes(y = Snake_mean_Pheno), color="steelblue", linetype="twodash") 
  #Sys.sleep(2)
}
return(p)
}

differnce_graph <- function(files, the_mean, the_sd, title, is_log=FALSE){
  
 file1 <- read.table(files[1], header = TRUE)
p <- ggplot(file1, aes(x=gen)) +
  xlim(0, 1000)+
  geom_line(aes(y = abs(Snake_mean_Pheno - Newt_mean_Pheno)), color = "mediumseagreen") + 
  ggtitle(title) +
  xlab("Generation") + ylab("Average Difference")+
  theme_bw()

if(is_log==TRUE){
  p = p + scale_y_log10(limits=c(abs(the_mean)-the_sd*10, abs(the_mean)+the_sd*10)) + ylab("Average Difference (Log)")
}

if(is_log==FALSE){
  p = p + ylim(abs(the_mean)-the_sd*10, abs(the_mean)+the_sd*10)
}

for (current_file in files){
  #print(current_file)

  file <- read.table(current_file, header = TRUE)
  file$Newt_mean_Pheno[file$Newt_mean_Pheno == "NULL"] <- NA
  file$Snake_mean_Pheno[file$Snake_mean_Pheno == "NULL"] <- NA
  file <- file[complete.cases(file), ]
  file$mean_dif = as.numeric(file$Snake_mean_Pheno) - as.numeric(file$Newt_mean_Pheno)
  file$mean_dif[file$mean_dif == 0] <- 0.01
  file$pos <- "Snake"
  file$pos[file$mean_dif < 0] <- "Newt"
  file$pos[file$mean_dif ==  0.01] <- "Equal"

 p <- p + geom_line(data=file, aes(x=gen, y=abs(mean_dif), color = pos), na.rm=TRUE)
  #Sys.sleep(2) na.rm=TRUE
 # color = "mediumseagreen"

}
return(p)
}


phenotype_change_graph <- function(files, the_mean, the_sd, title, is_log=FALSE){
file1 <- read.table(files[1], header = TRUE)
p <- ggplot(file1, aes(x=1:144)) +
  xlim(0, 145)+
  ggtitle(title) +
  xlab("Simulation number") + ylab("Phenotype")+
  theme_bw()


if(is_log==TRUE){
  p = p + scale_y_log10() + ylab("Phenotype  (Log)")
  
}
i=1
for (current_file in files){

  file <- read.table(current_file, header = TRUE)
  file$Newt_mean_Pheno[file$Newt_mean_Pheno == "NULL"] <- 0
  file$Snake_mean_Pheno[file$Snake_mean_Pheno == "NULL"] <- 0
  file <- file[complete.cases(file), ]
 p <- p + geom_point(data= file, x = i, aes(y = as.numeric(Newt_mean_Pheno[1])+0.1), color = darken("darkred")) +
   geom_point(data= file,x = i, aes(y = as.numeric(Newt_mean_Pheno[50])+0.1), color = lighten("darkred"))  + geom_point(data= file, x = i, aes(y = as.numeric(Snake_mean_Pheno[1])+0.1), color = darken("steelblue")) +
  geom_point(data= file, x = i, aes(y = as.numeric(Snake_mean_Pheno[50])+0.1), color = lighten("steelblue"))
 i = i+1
}
return(p)
}
  
untrasform <- function(files, the_mean, the_sd, title1, title2, is_log=FALSE){

file1 <- read.table(files[1], header = TRUE)
p <- ggplot(file1, aes(x=as.numeric(Newt_mean_Pheno))) +
  #ylim(0, true_max_1)+
  geom_line(aes(y = (log(as.numeric(Newt_mean_Pheno))*10)), color = "darkred") + 
  ggtitle(title1) +
  xlab("Trasnformed") + ylab("Untransformed")+
  theme_bw()
q <- ggplot(file1, aes(x=as.numeric(Snake_mean_Pheno))) +
  #ylim(0, true_max_1)+
  geom_line(aes(y = (log(as.numeric(Snake_mean_Pheno))*10)), color = "steelblue") + 
  ggtitle(title2) +
  xlab("Trasnformed") + ylab("Untransformed")+
  theme_bw()


for (current_file in files){
  #print(current_file)
  file <- read.table(current_file, header = TRUE)
  file$Newt_mean_Pheno[file$Newt_mean_Pheno == "NULL"] <- NA
  file$Snake_mean_Pheno[file$Snake_mean_Pheno == "NULL"] <- NA
  file <- file[complete.cases(file), ]
  #print(file$Newt_mean_Pheno)
  #print(exp(file$Newt_mean_Pheno/10))
  #print(log(as.numeric(file$Newt_mean_Pheno))*10)
  file <- read.table(current_file, header = TRUE)
 p <- p + geom_line(data=file, aes(y = (log(as.numeric(Newt_mean_Pheno))*10)), color = "darkred",na.rm = TRUE) 

 q <- q + geom_line(data=file, aes(y = (log(as.numeric(Snake_mean_Pheno))*10)), color="steelblue", linetype="twodash", na.rm = FALSE)
}
return(list(p,q))

}

```

```{r data from the mistake folder, echo=FALSE}
files <- list.files(path="~/Desktop/pheno_test_1000_old/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)

out = collect_data_points(files)

newt_max_pheno_1 = out[1]
snake_max_pheno_1 = out[2]
newt_min_pheno_1  = out[3]
snake_min_pheno_1 = out[4]
true_max_1 = out[5]
true_min_1 = out[6]
min_difference_1 = out[7]
max_difference_1 = out[8]
my_mean = out[9]
my_sd = out[10]
mean_mean_dif = out[11]
sd_mean_dif = out[12]

print(paste0("Newt max pheno: ", newt_max_pheno_1))
print(paste0("Snake max phenot: ", snake_max_pheno_1))
print(paste0("Newt min pheno: ", newt_min_pheno_1))
print(paste0("Snake min Pheno: ", snake_min_pheno_1))
print(paste0("Mean of combined snake and newt: ", my_mean))
print(paste0("Sd of combined snake and newt: ", my_sd))
print(paste0("Mean of the mean difference: ", mean_mean_dif))
print(paste0("SD of the mean difference: ", sd_mean_dif))

```

This section of code loops though the files and make two lines (red for newts blue for snakes). This figure shows how the pheotypes change over 1000 generations. It also keeps a minimum about of info in memory at a time. aka dont open all of the files and put it into a large dataframe.




```{r phenotype graph for mistake sims, echo=FALSE}


files <- list.files(path="~/Desktop/pheno_test_1000_old/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)
title="Wrong1sim: Phenotype Measurements for Newts and Snakes"
q = phenotype_graph(files, my_mean, my_sd, title, is_log = TRUE)
p = phenotype_graph(files, my_mean, my_sd, title)
q
p 
```


## Difference between snake and newt pheotypes

This figure represents the difference between the snake and the newt phenotype. The pink lines indicate that the newt is more toxit than the snakes, while the blue line indicates that the snakes are more resitant than the newts


```{r difference wrong sim, echo=FALSE}

## need to work on making this figure better 
files <- list.files(path="~/Desktop/pheno_test_1000_old/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)
title = "Wrong1sim: Difference Between Phenotypes (Snakes-Newts)"
p = differnce_graph(files, mean_mean_dif, sd_mean_dif, title, is_log=FALSE)

p
```

## How much did the phenotypes of newts and snakes change over 1000 generations

For this figure I want there to be 2 sets of points (4 complete points) for each simulation taking the first and last mean phenotype for the newt and the snake. Essentially, asking if the phenotypes of the newts and snakes changed over 1000 generations?

```{r pheno change, echo=FALSE}

files <- list.files(path="~/Desktop/pheno_test_1000_old/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)
title = "Wrong1sim: Phenotype Change"
p=phenotype_change_graph(files, my_mean, my_sd, title, is_log=FALSE)
  
p 

```

## Trasforming the phenotypes back

I want to see what the un-transformed phentypes are and compare them to their transformed buddies to figure out what values I should be using for sigma and mu.

I calculated the phenotypes from this expression, newt pheno = exp(inds_n.sumOfMutationsOfType(m1)/10). So to un-transform and find the # of mutations I need to ln both sides of the equation ln(pheno=e^(sumOfMutations/10)). Then solve for sumOfMutations,  sumOfMutations = 10 * ln(pheno)

Notes:
difference in the trees betw two chromosomes in a pop of size N is 4N
so # of differing mutations is like 4 N L mu where L = genome length, mu = mutaiton rate per bp and if each mutation has an effect size that is N(0, sd=sigma), then the sum of K of these has mean 0 and SD= sigma * sqrt(K). So untransformed phenotypes (sum of effect sizes) should have mean 0 and SD= sigma * sqrt(4 N L mu). So, you'd work out what SD you want, then given mu solve for sigma (the SD of effect size)


```{r trasformation, echo=FALSE}

files <- list.files(path="~/Desktop/pheno_test_1000_old/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)

title1 = "Wrong1sim: Newt trasnformed vs un-trasformed"
title2 = "Wrong1sim: Snake trasnformed vs un-trasformed"
graph = untrasform(files, my_mean, my_sd, title1, title2, is_log=FALSE)
graph[1]
graph[2]


```

# The Correct Experiment 

I ran 144 SLiM simulations with different parameters values and used the MSprime   both_su_1e-10_nu_1e-10_sue_0.01_nue_0.01 (s/n u mutation rate, n/s ue mutation effect size) file.

Again I looped through the files and find the max and min of each of the species pheotypes
Then set up a graph with the average pheotypes over 1000 generations (red line for newts blue linesfor snakes).

This is the correct one:

```{r data 1 msprime photype graph, echo=FALSE}
files <- list.files(path="~/Desktop/pheno_test_1000/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)

out = collect_data_points(files)

newt_max_pheno_1 = out[1]
snake_max_pheno_1 = out[2]
newt_min_pheno_1  = out[3]
snake_min_pheno_1 = out[4]
true_max_1 = out[5]
true_min_1 = out[6]
min_difference_1 = out[7]
max_difference_1 = out[8]
my_mean = out[9]
my_sd = out[10]
mean_mean_dif = out[11]
sd_mean_dif = out[12]

print(paste0("Newt max pheno: ", newt_max_pheno_1))
print(paste0("Snake max phenot: ", snake_max_pheno_1))
print(paste0("Newt min pheno: ", newt_min_pheno_1))
print(paste0("Snake min Pheno: ", snake_min_pheno_1))
print(paste0("Mean of combined snake and newt: ", my_mean))
print(paste0("Sd of combined snake and newt: ", my_sd))
print(paste0("Mean of the mean difference: ", mean_mean_dif))
print(paste0("SD of the mean difference: ", sd_mean_dif))

```

```{r data 1 msprime dif pheno graph, echo=FALSE}


files <- list.files(path="~/Desktop/pheno_test_1000/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)
title = "1sim: Phenotype Measurements for Newts and Snake"
q = phenotype_graph(files, my_mean, my_sd, title, is_log = TRUE)
p = phenotype_graph(files, my_mean, my_sd, title)
q
p 
```


## Difference between snake and newt pheotypes

```{r data from multiple msprime, echo=FALSE}


files <- list.files(path="~/Desktop/pheno_test_1000/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)

title = "1sim: Difference Between Phenotypes (Snakes-Newts)"
p = differnce_graph(files, mean_mean_dif, sd_mean_dif, title, is_log=FALSE)

p 
```
## How much did the phenotypes of newts and snakes change over 1000 generations

```{r 1sim pheno change, echo=FALSE}

files <- list.files(path="~/Desktop/pheno_test_1000/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)

title = "1sim: Phenotype Change"
p=phenotype_change_graph(files, my_mean, my_sd, title, is_log=FALSE)
  
p  

```

## Trasforming the phenotypes back

```{r trasformation cor sim, echo=FALSE}

files <- list.files(path="~/Desktop/pheno_test_1000/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)

title1 = "1som: Newt trasnformed vs un-trasformed"
title2 = "g1sim: Snake trasnformed vs un-trasformed"
graph = untrasform(files, my_mean, my_sd, title1, title2, is_log=FALSE)
graph[1]
graph[2]



```

# Expanded Experiment 2sims: 
This time I examine what the SLIM script would generate is both the MSprime and SLIM are ran with the variables that I picked. I ran 144 SLiM simulations & MSprime with different parameters values.

Again I looped through the files and find the max and min of each of the species pheotypes
Then set up a graph with the average phenotypes over 1000 generations (red line for newts blue lines for snakes).

```{r gathering data for dif var for msprim sim and slim, echo=FALSE}

files <- list.files(path="~/Desktop/pheno_test_1000_2/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)

out = collect_data_points(files)

newt_max_pheno_1 = out[1]
snake_max_pheno_1 = out[2]
newt_min_pheno_1  = out[3]
snake_min_pheno_1 = out[4]
true_max_1 = out[5]
true_min_1 = out[6]
min_difference_1 = out[7]
max_difference_1 = out[8]
my_mean = out[9]
my_sd = out[10]
mean_mean_dif = out[11]
sd_mean_dif = out[12]

print(paste0("Newt max pheno: ", newt_max_pheno_1))
print(paste0("Snake max phenot: ", snake_max_pheno_1))
print(paste0("Newt min pheno: ", newt_min_pheno_1))
print(paste0("Snake min Pheno: ", snake_min_pheno_1))
print(paste0("Mean of combined snake and newt: ", my_mean))
print(paste0("Sd of combined snake and newt: ", my_sd))
print(paste0("Mean of the mean difference: ", mean_mean_dif))
print(paste0("SD of the mean difference: ", sd_mean_dif))

```
some of these values are in quotes, why?

```{r 2sims phenotypes, echo=FALSE}


files <- list.files(path="~/Desktop/pheno_test_1000_2/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)
file1 <- read.table(files[1], header = TRUE)
p <- ggplot(file1, aes(x=gen)) +
  xlim(0, 1000)+
  #ylim(0, true_max_3)+
  #scale_y_continuous(trans=log10_trans(), limits=c(0,true_max_3))+
  #scale_y_log10()+
  scale_y_log10(limits=c(0.001,true_max_3))+
  geom_line(aes(y = Newt_mean_Pheno), color = "darkred") + 
  geom_line(aes(y = Snake_mean_Pheno), color="steelblue", linetype="twodash")+
  ggtitle("2sims: Phenotype Measurements for Newts and Snakes") +
  xlab("Generation") + ylab("Average Phenotypes  (Log)")+
  theme_bw()

for (current_file in files){
  #print(current_file)

  file <- read.table(current_file, header = TRUE)
  file$Newt_mean_Pheno[file$Newt_mean_Pheno == "NULL"] <- NA
  file$Snake_mean_Pheno[file$Snake_mean_Pheno == "NULL"] <- NA
  
 p <- p +
  geom_line(data=file, aes(y = as.numeric(Newt_mean_Pheno)), color = "darkred",na.rm=TRUE) + 
  geom_line(data=file, aes(y = as.numeric(Snake_mean_Pheno)), color="steelblue", linetype="twodash", na.rm=TRUE) 
  #Sys.sleep(2) na.rm=TRUE

}

p 
```


## Difference between snake and newt pheotypes



```{r 2sim phendif, echo=FALSE}


files <- list.files(path="~/Desktop/pheno_test_1000_2/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)
file1 <- read.table(files[1], header = TRUE)
p <- ggplot(file1, aes(x=gen)) +
  xlim(0, 1000)+
  #ylim(min_difference, max_difference)+
  #scale_y_continuous(trans=log10_trans(), limits=c(min_difference, max_difference))+
  #scale_y_log10()+
  scale_y_log10(limits=c(min_difference_3, max_difference_3))+
  geom_line(aes(y = Snake_mean_Pheno - Newt_mean_Pheno), color = "mediumseagreen") + 
  ggtitle("2sims: Difference Between Phenotypes (Snakes-Newts)") +
  xlab("Generation") + ylab("Average Difference (Log)")+
  theme_bw()

for (current_file in files){
  #print(current_file)

  file <- read.table(current_file, header = TRUE)
  file$Newt_mean_Pheno[file$Newt_mean_Pheno == "NULL"] <- NA
  file$Snake_mean_Pheno[file$Snake_mean_Pheno == "NULL"] <- NA
  file <- file[complete.cases(file), ]
  file$mean_dif = as.numeric(file$Snake_mean_Pheno) - as.numeric(file$Newt_mean_Pheno)
  file$mean_dif[file$mean_dif == 0] <- 0.01
  file$pos <- TRUE
  file$pos[file$mean_dif < 0] <- FALSE
  

 p <- p + geom_line(data=file, aes(x=gen, y=abs(mean_dif), color = pos), na.rm=TRUE)
  #Sys.sleep(2) na.rm=TRUE
 # color = "mediumseagreen"

}

p 
```
## How much did the phenotypes of newts and snakes change over 1000 generations



```{r 2sim pheno change, echo=FALSE}

files <- list.files(path="~/Desktop/pheno_test_1000_2/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)
file1 <- read.table(files[1], header = TRUE)
p <- ggplot(file1, aes(x=1:144)) +
  xlim(0, 145)+
  scale_y_log10()+
  geom_point(aes(x = 1, y = as.numeric(Newt_mean_Pheno[1])), color = darken("darkred")) +
  geom_point(aes(x = 1, y = as.numeric(Newt_mean_Pheno[50])), color = lighten("darkred")) +
  geom_point(aes(x = 1, y = as.numeric(Snake_mean_Pheno[1])), color = darken("steelblue")) +
  geom_point(aes(x = 1, y = as.numeric(Snake_mean_Pheno[50])), color = lighten("steelblue")) +
  ggtitle("2sim: Phenotype Change") +
  xlab("Simulation number") + ylab("Phenotype  (Log)")+
  theme_bw()
i=1
for (current_file in files){

  file <- read.table(current_file, header = TRUE)
  file$Newt_mean_Pheno[file$Newt_mean_Pheno == "NULL"] <- 0
  file$Snake_mean_Pheno[file$Snake_mean_Pheno == "NULL"] <- 0
  file <- file[complete.cases(file), ]
 p <- p + geom_point(data= file, x = i, aes(y = as.numeric(Newt_mean_Pheno[1])+0.1), color = darken("darkred")) +
   geom_point(data= file,x = i, aes(y = as.numeric(Newt_mean_Pheno[50])+0.1), color = lighten("darkred"))  + geom_point(data= file, x = i, aes(y = as.numeric(Snake_mean_Pheno[1])+0.1), color = darken("steelblue")) +
  geom_point(data= file, x = i, aes(y = as.numeric(Snake_mean_Pheno[50])+0.1), color = lighten("steelblue"))
 i = i+1
}


p 

```


## Trasforming the phenotypes back


```{r trasformation 2sim, echo=FALSE}

files <- list.files(path="~/Desktop/pheno_test_1000_2/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)
file1 <- read.table(files[1], header = TRUE)
p <- ggplot(file1, aes(x=as.numeric(Newt_mean_Pheno))) +
  #ylim(0, true_max_1)+
  geom_line(aes(y = (log(as.numeric(Newt_mean_Pheno))*10)), color = "darkred") + 
  ggtitle("2sims: Newt trasnformed vs un-trasformed") +
  xlab("Trasnformed") + ylab("Untransformed")+
  theme_bw()
q <- ggplot(file1, aes(x=as.numeric(Snake_mean_Pheno))) +
  #ylim(0, true_max_1)+
  geom_line(aes(y = (log(as.numeric(Snake_mean_Pheno))*10)), color = "steelblue") + 
  ggtitle("2sims: Newt trasnformed vs un-trasformed") +
  xlab("Trasnformed") + ylab("Untransformed")+
  theme_bw()

for (current_file in files){
  #print(current_file)
  file <- read.table(current_file, header = TRUE)
  file$Newt_mean_Pheno[file$Newt_mean_Pheno == "NULL"] <- NA
  file$Snake_mean_Pheno[file$Snake_mean_Pheno == "NULL"] <- NA
  file <- file[complete.cases(file), ]
  #print(file$Newt_mean_Pheno)
  #print(exp(file$Newt_mean_Pheno/10))
  #print(log(as.numeric(file$Newt_mean_Pheno))*10)
  file <- read.table(current_file, header = TRUE)
 p <- p + geom_line(data=file, aes(y = (log(as.numeric(Newt_mean_Pheno))*10)), color = "darkred",na.rm = TRUE) 

 q <- q + geom_line(data=file, aes(y = (log(as.numeric(Snake_mean_Pheno))*10)), color="steelblue", linetype="twodash", na.rm = FALSE)
}


p
q



```

