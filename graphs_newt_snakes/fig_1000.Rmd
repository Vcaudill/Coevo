---
title: "1000 Graphs"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(viridis)
#setwd("~/Desktop/Proposal Old Drafts")
```

## This is a r file to show what the phenotypess are after 1000 generations
- A problem that I have been experiencing is that the phenotypes seem so go wild really quickly 
- This will be a graph that looks at the phenotypes of different simulations with a unique mutation rate and mutation effect size.

- Lets just visualize what the phenotypes are doing

## The Figure
Loop through the files and find the max and min of each of the species pheotypes
Then set up a graph with the max max
Loop though the files and make two lines (red for newts blue for snakes) and keep a minimum about of info in mem at a time

I made a mistake. I switched the mutation rates and the effect sizes

```{r data from the mistake folder, echo=FALSE}
newt_max_pheno_1 = 0
snake_max_pheno_1 = 0
newt_min_pheno_1 = 0
snake_min_pheno_1 = 0
true_max_1 = 0
true_min_1 = 0
min_difference_1 = 0
max_difference_1 = 0

files <- list.files(path="~/Desktop/pheno_test_1000_old/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)

for (current_file in files){
  #print(current_file)

  file <- read.table(current_file, header = TRUE)
  
  file$Newt_max_Pheno[file$Newt_max_Pheno == "NULL"] <- NA
  file$Snake_max_Pheno[file$Snake_max_Pheno == "NULL"] <- NA
  file$Newt_min_Pheno[file$Newt_min_Pheno == "NULL"] <- NA
  file$Snake_min_Pheno[file$Snake_min_Pheno == "NULL"] <- NA
  file$Newt_mean_Pheno[file$Newt_mean_Pheno == "NULL"] <- NA
  file$Snake_mean_Pheno[file$Snake_mean_Pheno == "NULL"] <- NA

  if (max(file$Newt_max_Pheno) > newt_max_pheno_1){
    newt_max_pheno_1 = max(file$Newt_max_Pheno) }
  
  if (max(file$Snake_max_Pheno) > snake_max_pheno_1){
    snake_max_pheno_1 = max(file$Snake_max_Pheno) }
  
  if (min(file$Newt_min_Pheno) < newt_min_pheno_1){
    newt_min_pheno_1 = min(file$Newt_min_Pheno) }
  
  if (min(file$Snake_min_Pheno) > snake_min_pheno_1){
    snake_min_pheno_1 = max(file$Snake_min_Pheno) }
  
  if (as.numeric(max(file$Snake_mean_Pheno, na.rm = TRUE)) - as.numeric(min(file$Newt_mean_Pheno, na.rm = TRUE)) < min_difference_1){
    min_difference_1 = as.numeric(max(file$Snake_mean_Pheno, na.rm = TRUE)) - as.numeric(min(file$Newt_mean_Pheno, na.rm = TRUE))
  }

  
  if (as.numeric(max(file$Snake_mean_Pheno, na.rm = TRUE)) - as.numeric(min(file$Newt_mean_Pheno, na.rm = TRUE)) > max_difference_1){
    max_difference_1 = as.numeric(max(file$Snake_mean_Pheno, na.rm = TRUE)) - as.numeric(min(file$Newt_mean_Pheno, na.rm = TRUE))
  }
}

  print(newt_max_pheno_1)
  print(snake_max_pheno_1)
   print(newt_min_pheno_1)
  print(snake_min_pheno_1)
  
  if (newt_max_pheno_1 > snake_max_pheno_1){
    true_max_1 = newt_max_pheno_1 }
  if ( snake_max_pheno_1 > newt_max_pheno_1){
    true_max_1 = snake_max_pheno_1 }
  
    if (newt_min_pheno_1 < snake_min_pheno_1){
    true_min_1 = newt_min_pheno_1 }
  if ( snake_min_pheno_1 < newt_min_pheno_1){
    true_min_1 = snake_min_pheno_1 }
  
```
```{r phenotype graph for mistake sims, echo=FALSE}


files <- list.files(path="~/Desktop/pheno_test_1000_old/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)
file1 <- read.table(files[1], header = TRUE)
p <- ggplot(file1, aes(x=gen)) +
  xlim(0, 1000)+
  #ylim(0, true_max_1)+
  scale_y_log10(limits=c(true_min_1+0.8, true_max_1))+
  geom_line(aes(y = Newt_mean_Pheno), color = "darkred") + 
  geom_line(aes(y = Snake_mean_Pheno), color="steelblue", linetype="twodash")+
  ggtitle("Phenotype Measurements for Newts and Snakes") +
  xlab("Generation") + ylab("Average Phenotypes")+
  theme_bw()

for (current_file in files){
  #print(current_file)

  file <- read.table(current_file, header = TRUE)
 p <- p +
  geom_line(data=file, aes(y = Newt_mean_Pheno), color = "darkred") + 
  geom_line(data=file, aes(y = Snake_mean_Pheno), color="steelblue", linetype="twodash") 
  #Sys.sleep(2)

}

p 
```

```{r difference wrong sim, echo=FALSE}

## need to work on making this figure better 
files <- list.files(path="~/Desktop/pheno_test_1000_old/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)
file1 <- read.table(files[1], header = TRUE)
p <- ggplot(file1, aes(x=gen)) +
  xlim(0, 1000)+
  #ylim(min_difference, max_difference)+
  #scale_y_continuous(trans=log10_trans(), limits=c(min_difference, max_difference))+
  #scale_y_log10()+
  scale_y_log10(limits=c(min_difference_1, max_difference_1))+
  geom_line(aes(y = Snake_mean_Pheno - Newt_mean_Pheno), color = "mediumseagreen") + 
    ggtitle("Difference Between Phenotypes (Snakes-Newts)") +
  xlab("Generation") + ylab("Average Difference")+
  theme_bw()

for (current_file in files){
  #print(current_file)

  file <- read.table(current_file, header = TRUE)
  file$Newt_mean_Pheno[file$Newt_mean_Pheno == "NULL"] <- NA
  file$Snake_mean_Pheno[file$Snake_mean_Pheno == "NULL"] <- NA
  file <- file[complete.cases(file), ]
  file$mean_dif = as.numeric(file$Snake_mean_Pheno) - as.numeric(file$Newt_mean_Pheno)
  file$mean_dif[file$mean_dif == 0] <- 0.01
  file$pos <- TRUE
  file$pos[file$mean_dif < 0] <- FALSE
  

 p <- p + geom_line(data=file, aes(x=gen, y=abs(mean_dif), color = pos), na.rm=TRUE)
  #Sys.sleep(2) na.rm=TRUE
 # color = "mediumseagreen"

}

p 
```

## The Figure
Loop through the files and find the max and min of each of the species pheotypes
Then set up a graph with the max max
Loop though the files and make two lines (red for newts blue for snakes) and keep a minimum about of info in mem at a time

This is the correct one
```{r data 1 msprime photype graph, echo=FALSE}
newt_max_pheno_2 = 0
snake_max_pheno_2 = 0
newt_min_pheno_2 = 0
snake_min_pheno_2 = 0
true_max_2 = 0
true_min_2 = 0
min_difference_2 = 0
max_difference_2 = 0

files <- list.files(path="~/Desktop/pheno_test_1000/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)

for (current_file in files){
  #print(current_file)

  file <- read.table(current_file, header = TRUE)
  #print(max(file$Newt_max_Pheno))
  #print(max(file$Snake_max_Pheno))
  
  file$Newt_max_Pheno[file$Newt_max_Pheno == "NULL"] <- NA
  file$Snake_max_Pheno[file$Snake_max_Pheno == "NULL"] <- NA
  file$Newt_min_Pheno[file$Newt_min_Pheno == "NULL"] <- NA
  file$Snake_min_Pheno[file$Snake_min_Pheno == "NULL"] <- NA
  file$Newt_mean_Pheno[file$Newt_mean_Pheno == "NULL"] <- NA
  file$Snake_mean_Pheno[file$Snake_mean_Pheno == "NULL"] <- NA
  
  if (max(file$Newt_max_Pheno) > newt_max_pheno_2){
    newt_max_pheno_2 = max(file$Newt_max_Pheno) }
  
  if (max(file$Snake_max_Pheno) > snake_max_pheno_2){
    snake_max_pheno_2 = max(file$Snake_max_Pheno) }
  
  if (min(file$Newt_min_Pheno) < newt_min_pheno_2){
    newt_min_pheno_2 = max(file$Newt_min_Pheno) }
  
  if (max(file$Snake_min_Pheno) < snake_min_pheno_2){
    snake_min_pheno_2 = max(file$Snake_min_Pheno) }

  if (as.numeric(max(file$Snake_mean_Pheno, na.rm = TRUE)) - as.numeric(min(file$Newt_mean_Pheno, na.rm = TRUE)) < min_difference_2){
      min_difference_2 = as.numeric(max(file$Snake_mean_Pheno, na.rm = TRUE)) - as.numeric(min(file$Newt_mean_Pheno, na.rm = TRUE))
  }

  
  if (as.numeric(max(file$Snake_mean_Pheno, na.rm = TRUE)) - as.numeric(min(file$Newt_mean_Pheno, na.rm = TRUE)) > max_difference_2){
    max_difference_2 = as.numeric(max(file$Snake_mean_Pheno, na.rm = TRUE)) - as.numeric(min(file$Newt_mean_Pheno, na.rm = TRUE))
  }
}

  print(newt_max_pheno_2)
  print(snake_max_pheno_2)
  print(newt_min_pheno_2)
  print(snake_min_pheno_2)
  
  if (newt_max_pheno_2 > snake_max_pheno_2){
    true_max_2 = newt_max_pheno_2 }
  if ( snake_max_pheno_2 > newt_max_pheno_2){
    true_max_2 = snake_max_pheno_2 }
  
  if (newt_min_pheno_2 < snake_min_pheno_2){
    true_min_2 = newt_min_pheno_2 }
  if ( snake_min_pheno_2 < newt_min_pheno_2){
    true_min_2 = snake_min_pheno_2 }
```

```{r data 1 msprime dif pheno graph, echo=FALSE}


files <- list.files(path="~/Desktop/pheno_test_1000/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)
file1 <- read.table(files[1], header = TRUE)
p <- ggplot(file1, aes(x=gen)) +
  xlim(0, 1000)+
  #ylim(0, true_max_2)+
  scale_y_log10(limits=c(true_min_2+0.5, true_max_2))+
  geom_line(aes(y = Newt_mean_Pheno), color = "darkred") + 
  geom_line(aes(y = Snake_mean_Pheno), color="steelblue", linetype="twodash")+
  ggtitle("Phenotype Measurements for Newts and Snakes") +
  xlab("Generation") + ylab("Average Phenotypes")+
  theme_bw()

for (current_file in files){
  #print(current_file)

  file <- read.table(current_file, header = TRUE)
 p <- p +
  geom_line(data=file, aes(y = Newt_mean_Pheno), color = "darkred") + 
  geom_line(data=file, aes(y = Snake_mean_Pheno), color="steelblue", linetype="twodash") 
  #Sys.sleep(2)

}

p 
```
```{r data from multiple msprime, echo=FALSE}


files <- list.files(path="~/Desktop/pheno_test_1000/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)
file1 <- read.table(files[1], header = TRUE)
p <- ggplot(file1, aes(x=gen)) +
  xlim(0, 1000)+
  #ylim(min_difference, max_difference)+
  #scale_y_continuous(trans=log10_trans(), limits=c(min_difference, max_difference))+
  #scale_y_log10()+
  scale_y_log10(limits=c(min_difference_2, max_difference_2))+
  geom_line(aes(y = Snake_mean_Pheno - Newt_mean_Pheno), color = "mediumseagreen") + 
    ggtitle("Difference Between Phenotypes (Snakes-Newts)") +
  xlab("Generation") + ylab("Average Difference")+
  theme_bw()

for (current_file in files){
  #print(current_file)

  file <- read.table(current_file, header = TRUE)
  file$Newt_mean_Pheno[file$Newt_mean_Pheno == "NULL"] <- NA
  file$Snake_mean_Pheno[file$Snake_mean_Pheno == "NULL"] <- NA
  file <- file[complete.cases(file), ]
  file$mean_dif = as.numeric(file$Snake_mean_Pheno) - as.numeric(file$Newt_mean_Pheno)
  file$mean_dif[file$mean_dif == 0] <- 0.01
  file$pos <- TRUE
  file$pos[file$mean_dif < 0] <- FALSE
  

 p <- p + geom_line(data=file, aes(x=gen, y=abs(mean_dif), color = pos), na.rm=TRUE)
  #Sys.sleep(2) na.rm=TRUE
 # color = "mediumseagreen"

}

p 
```

## The Figure
Loop through the files and find the max and min of each of the species pheotypes
Then set up a graph with the max max
Loop though the files and make two lines (red for newts blue for snakes) and keep a minimum about of info in mem at a time 

This time I examine what the SLIM script would generate is both the MSprime and SLIM are ran with the variables that I picked. 

```{r pressure, echo=FALSE}
newt_max_pheno_3 = 0
snake_max_pheno_3 = 0
newt_min_pheno_3 = 0
snake_min_pheno_3 = 0
true_max_3 = 0
true_min_3 = 0
max_difference_3 = 0
min_difference_3 = 0 

files <- list.files(path="~/Desktop/pheno_test_1000_2/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)

for (current_file in files){
  #print(current_file)
 
  file <- read.table(current_file, header = TRUE)
  file$Newt_max_Pheno[file$Newt_max_Pheno == "NULL"] <- NA
  file$Snake_max_Pheno[file$Snake_max_Pheno == "NULL"] <- NA
  file$Newt_min_Pheno[file$Newt_min_Pheno == "NULL"] <- NA
  file$Snake_min_Pheno[file$Snake_min_Pheno == "NULL"] <- NA
  file$Newt_mean_Pheno[file$Newt_mean_Pheno == "NULL"] <- NA
  file$Snake_mean_Pheno[file$Snake_mean_Pheno == "NULL"] <- NA
  #print(max(file$Newt_max_Pheno, na.rm = TRUE))
  #print(max(file$Snake_max_Pheno, na.rm = TRUE))
  
  if (as.numeric(max(file$Newt_max_Pheno, na.rm = TRUE)) > newt_max_pheno_3){
    newt_max_pheno_3 = as.numeric(max(file$Newt_max_Pheno, na.rm = TRUE)) }
  
  if (as.numeric(max(file$Snake_max_Pheno, na.rm = TRUE)) > snake_max_pheno_3){
    snake_max_pheno = as.numeric(max(file$Snake_max_Pheno, na.rm = TRUE)) }
  
  if (as.numeric(min(file$Newt_min_Pheno, na.rm = TRUE)) < newt_min_pheno_3){
    newt_min_pheno_3 = as.numeric(max(file$Newt_min_Pheno, na.rm = TRUE)) }
  
  if (as.numeric(max(file$Snake_min_Pheno, na.rm = TRUE)) < snake_min_pheno_3){
    snake_min_pheno_3 = as.numeric(max(file$Snake_min_Pheno, na.rm = TRUE)) }
  
 if (as.numeric(max(file$Snake_mean_Pheno, na.rm = TRUE)) - as.numeric(min(file$Newt_mean_Pheno, na.rm = TRUE)) < min_difference_3){
    min_difference_3 = as.numeric(max(file$Snake_mean_Pheno, na.rm = TRUE)) - as.numeric(min(file$Newt_mean_Pheno, na.rm = TRUE))
  }

  
  if (as.numeric(max(file$Snake_mean_Pheno, na.rm = TRUE)) - as.numeric(min(file$Newt_mean_Pheno, na.rm = TRUE)) > max_difference_3){
    max_difference_3 = as.numeric(max(file$Snake_mean_Pheno, na.rm = TRUE)) - as.numeric(min(file$Newt_mean_Pheno, na.rm = TRUE))
  }

      }

  print(newt_max_pheno_3)
  print(snake_max_pheno_3)
  print(min_difference_3)
  print(max_difference_3)
  if (newt_max_pheno_3 > snake_max_pheno_3){
    true_max_3 = newt_max_pheno_3 }
  if ( snake_max_pheno_3 > newt_max_pheno_3){
    true_max_3 = snake_max_pheno_3 }
  
  if (newt_min_pheno_3 < snake_min_pheno_3){
    true_min_3 = newt_min_pheno_3 }
  if ( snake_max_pheno_3 < newt_max_pheno_3){
    true_min_3 = snake_min_pheno_3 }
```
some of these values are in quotes, why?

```{r pressure, echo=FALSE}


files <- list.files(path="~/Desktop/pheno_test_1000_2/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)
file1 <- read.table(files[1], header = TRUE)
p <- ggplot(file1, aes(x=gen)) +
  xlim(0, 1000)+
  #ylim(0, true_max_3)+
  #scale_y_continuous(trans=log10_trans(), limits=c(0,true_max_3))+
  #scale_y_log10()+
  scale_y_log10(limits=c(0.001,true_max_3))+
  geom_line(aes(y = Newt_mean_Pheno), color = "darkred") + 
  geom_line(aes(y = Snake_mean_Pheno), color="steelblue", linetype="twodash")+
  ggtitle("Phenotype Measurements for Newts and Snakes") +
  xlab("Generation") + ylab("Average Phenotypes")+
  theme_bw()

for (current_file in files){
  #print(current_file)

  file <- read.table(current_file, header = TRUE)
  file$Newt_mean_Pheno[file$Newt_mean_Pheno == "NULL"] <- NA
  file$Snake_mean_Pheno[file$Snake_mean_Pheno == "NULL"] <- NA
  
 p <- p +
  geom_line(data=file, aes(y = as.numeric(Newt_mean_Pheno)), color = "darkred",na.rm=TRUE) + 
  geom_line(data=file, aes(y = as.numeric(Snake_mean_Pheno)), color="steelblue", linetype="twodash", na.rm=TRUE) 
  #Sys.sleep(2) na.rm=TRUE

}

p 
```


Some other things that might be goo to look at:

The difference between the average phenotypes



```{r pressure, echo=FALSE}


files <- list.files(path="~/Desktop/pheno_test_1000_2/text_files/test", pattern="*.txt", full.names=TRUE, recursive=FALSE)
file1 <- read.table(files[1], header = TRUE)
p <- ggplot(file1, aes(x=gen)) +
  xlim(0, 1000)+
  #ylim(min_difference, max_difference)+
  #scale_y_continuous(trans=log10_trans(), limits=c(min_difference, max_difference))+
  #scale_y_log10()+
  scale_y_log10(limits=c(min_difference_3, max_difference_3))+
  geom_line(aes(y = Snake_mean_Pheno - Newt_mean_Pheno), color = "mediumseagreen") + 
  ggtitle("Difference Between Phenotypes (Snakes-Newts)") +
  xlab("Generation") + ylab("Average Difference")+
  theme_bw()

for (current_file in files){
  #print(current_file)

  file <- read.table(current_file, header = TRUE)
  file$Newt_mean_Pheno[file$Newt_mean_Pheno == "NULL"] <- NA
  file$Snake_mean_Pheno[file$Snake_mean_Pheno == "NULL"] <- NA
  file <- file[complete.cases(file), ]
  file$mean_dif = as.numeric(file$Snake_mean_Pheno) - as.numeric(file$Newt_mean_Pheno)
  file$mean_dif[file$mean_dif == 0] <- 0.01
  file$pos <- TRUE
  file$pos[file$mean_dif < 0] <- FALSE
  

 p <- p + geom_line(data=file, aes(x=gen, y=abs(mean_dif), color = pos), na.rm=TRUE)
  #Sys.sleep(2) na.rm=TRUE
 # color = "mediumseagreen"

}

p 
```
