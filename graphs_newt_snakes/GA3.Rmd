---
title: "GA3"
output: html_document
date: '2022-07-21'
---

```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE,echo = FALSE) 

library(ggplot2)
library(viridis)
library(colorspace)
library(gridExtra)
library(tidyverse)
require(reshape2)
library(plyr)
library(gridGraphics)
library(grid)
library(knitr)
library(kableExtra)
library("reshape")
library(ggplot2)
library(ggpubr)
theme_set(theme_pubr())
library(stringr)
library(patchwork)
```

GA3 file will be the slow evolution file. The main goal will be testing to see if there is an effect caused by mutation rate or effect size when the mutational variance between two species is the same.

Prediction: Higher mutation rate will be advantages in the beginning of a simulation. A higher effect size might lead to more spatial co-evolution. Space might separate the effects.

For the initial part of this experiment I will only be running one trial per GA combination

GA combinations:

- 1e-8*(0.005)^2 = 2.5e-13
- 1e-9*(0.0158)^2 = 2.5e-13
- 1e-10*(0.05)^2 = 2.5e-13
- 1e-11*(0.158)^2 = 2.5e-13



```{bash, data file gathering}
#!/usr/bin/env bash

# Run these comands while in The the folder that contains the file you would like to condence
# Goal is to condence all the text files into one file 
# Requirements: need to have the same name and need to add additional columns
foldername=bash_test
thefolder=/Users/victoria/Desktop/${foldername}/*
#echo ${thefolder}

#test -f /Users/victoria/Desktop/bash_test/all_lit.txt && echo "all lit file exists."
#test -f /Users/victoria/Desktop/bash_test/all_grid.txt && echo "all grid file exists."
#test -f /Users/victoria/Desktop/bash_test/all_cor.txt && echo "all cor file exists."

if [[ -f /Users/victoria/Desktop/bash_test/all_lit.txt ]] && [[ -f /Users/victoria/Desktop/bash_test/all_grid.txt ]] && [[ -f /Users/victoria/Desktop/bash_test/all_cor.txt ]]
then
  echo "All cor, lit, and grid files exist!"
  echo "This program will now end!"
  exit 0
fi

#creating the files
echo 'generation,Newt_age,Snake_age,Newt_density,Snake_density,Newt_min_Pheno,Newt_max_Pheno,Newt_mean_Pheno,Newt_sd_Pheno,Snake_min_Pheno,Snake_max_Pheno,Snake_mean_Pheno,Snake_sd_Pheno,Newt_pop_size,Snake_pop_size,mean_newts_eaten,sd_newts_eaten,mean_snakes_eaten,sd_snakes_eaten,beta_n,beta_s,snake_found_newt,newt_found,snake_deaths,newt_deaths,time,rep,snake_mu_rate,snake_mu_effect_sd,newt_mu_rate,newt_mu_effect_sd' > /Users/victoria/Desktop/bash_test/all_lit.txt
echo 'generation,newt_num_ind_0,snake_num_ind_0,newt_max_pheno_0,snake_max_pheno_0,newt_mean_pheno_0,snake_mean_pheno_0,newt_sd_pheno_0,snake_sd_pheno_0,newt_min_pheno_0,snake_min_pheno_0,newt_num_ind_1,snake_num_ind_1,newt_max_pheno_1,snake_max_pheno_1,newt_mean_pheno_1,snake_mean_pheno_1,newt_sd_pheno_1,snake_sd_pheno_1,newt_min_pheno_1,snake_min_pheno_1,newt_num_ind_2,snake_num_ind_2,newt_max_pheno_2,snake_max_pheno_2,newt_mean_pheno_2,snake_mean_pheno_2,newt_sd_pheno_2,snake_sd_pheno_2,newt_min_pheno_2,snake_min_pheno_2,newt_num_ind_3,snake_num_ind_3,newt_max_pheno_3,snake_max_pheno_3,newt_mean_pheno_3,snake_mean_pheno_3,newt_sd_pheno_3,snake_sd_pheno_3,newt_min_pheno_3,snake_min_pheno_3,newt_num_ind_4,snake_num_ind_4,newt_max_pheno_4,snake_max_pheno_4,newt_mean_pheno_4,snake_mean_pheno_4,newt_sd_pheno_4,snake_sd_pheno_4,newt_min_pheno_4,snake_min_pheno_4,newt_num_ind_5,snake_num_ind_5,newt_max_pheno_5,snake_max_pheno_5,newt_mean_pheno_5,snake_mean_pheno_5,newt_sd_pheno_5,snake_sd_pheno_5,newt_min_pheno_5,snake_min_pheno_5,newt_num_ind_6,snake_num_ind_6,newt_max_pheno_6,snake_max_pheno_6,newt_mean_pheno_6,snake_mean_pheno_6,newt_sd_pheno_6,snake_sd_pheno_6,newt_min_pheno_6,snake_min_pheno_6,newt_num_ind_7,snake_num_ind_7,newt_max_pheno_7,snake_max_pheno_7,newt_mean_pheno_7,snake_mean_pheno_7,newt_sd_pheno_7,snake_sd_pheno_7,newt_min_pheno_7,snake_min_pheno_7,newt_num_ind_8,snake_num_ind_8,newt_max_pheno_8,snake_max_pheno_8,newt_mean_pheno_8,snake_mean_pheno_8,newt_sd_pheno_8,snake_sd_pheno_8,newt_min_pheno_8,snake_min_pheno_8,newt_num_ind_9,snake_num_ind_9,newt_max_pheno_9,snake_max_pheno_9,newt_mean_pheno_9,snake_mean_pheno_9,newt_sd_pheno_9,snake_sd_pheno_9,newt_min_pheno_9,snake_min_pheno_9,newt_num_ind_10,snake_num_ind_10,newt_max_pheno_10,snake_max_pheno_10,newt_mean_pheno_10,snake_mean_pheno_10,newt_sd_pheno_10,snake_sd_pheno_10,newt_min_pheno_10,snake_min_pheno_10,newt_num_ind_11,snake_num_ind_11,newt_max_pheno_11,snake_max_pheno_11,newt_mean_pheno_11,snake_mean_pheno_11,newt_sd_pheno_11,snake_sd_pheno_11,newt_min_pheno_11,snake_min_pheno_11,newt_num_ind_12,snake_num_ind_12,newt_max_pheno_12,snake_max_pheno_12,newt_mean_pheno_12,snake_mean_pheno_12,newt_sd_pheno_12,snake_sd_pheno_12,newt_min_pheno_12,snake_min_pheno_12,newt_num_ind_13,snake_num_ind_13,newt_max_pheno_13,snake_max_pheno_13,newt_mean_pheno_13,snake_mean_pheno_13,newt_sd_pheno_13,snake_sd_pheno_13,newt_min_pheno_13,snake_min_pheno_13,newt_num_ind_14,snake_num_ind_14,newt_max_pheno_14,snake_max_pheno_14,newt_mean_pheno_14,snake_mean_pheno_14,newt_sd_pheno_14,snake_sd_pheno_14,newt_min_pheno_14,snake_min_pheno_14,newt_num_ind_15,snake_num_ind_15,newt_max_pheno_15,snake_max_pheno_15,newt_mean_pheno_15,snake_mean_pheno_15,newt_sd_pheno_15,snake_sd_pheno_15,newt_min_pheno_15,snake_min_pheno_15,newt_num_ind_16,snake_num_ind_16,newt_max_pheno_16,snake_max_pheno_16,newt_mean_pheno_16,snake_mean_pheno_16,newt_sd_pheno_16,snake_sd_pheno_16,newt_min_pheno_16,snake_min_pheno_16,newt_num_ind_17,snake_num_ind_17,newt_max_pheno_17,snake_max_pheno_17,newt_mean_pheno_17,snake_mean_pheno_17,newt_sd_pheno_17,snake_sd_pheno_17,newt_min_pheno_17,snake_min_pheno_17,newt_num_ind_18,snake_num_ind_18,newt_max_pheno_18,snake_max_pheno_18,newt_mean_pheno_18,snake_mean_pheno_18,newt_sd_pheno_18,snake_sd_pheno_18,newt_min_pheno_18,snake_min_pheno_18,newt_num_ind_19,snake_num_ind_19,newt_max_pheno_19,snake_max_pheno_19,newt_mean_pheno_19,snake_mean_pheno_19,newt_sd_pheno_19,snake_sd_pheno_19,newt_min_pheno_19,snake_min_pheno_19,newt_num_ind_20,snake_num_ind_20,newt_max_pheno_20,snake_max_pheno_20,newt_mean_pheno_20,snake_mean_pheno_20,newt_sd_pheno_20,snake_sd_pheno_20,newt_min_pheno_20,snake_min_pheno_20,newt_num_ind_21,snake_num_ind_21,newt_max_pheno_21,snake_max_pheno_21,newt_mean_pheno_21,snake_mean_pheno_21,newt_sd_pheno_21,snake_sd_pheno_21,newt_min_pheno_21,snake_min_pheno_21,newt_num_ind_22,snake_num_ind_22,newt_max_pheno_22,snake_max_pheno_22,newt_mean_pheno_22,snake_mean_pheno_22,newt_sd_pheno_22,snake_sd_pheno_22,newt_min_pheno_22,snake_min_pheno_22,newt_num_ind_23,snake_num_ind_23,newt_max_pheno_23,snake_max_pheno_23,newt_mean_pheno_23,snake_mean_pheno_23,newt_sd_pheno_23,snake_sd_pheno_23,newt_min_pheno_23,snake_min_pheno_23,newt_num_ind_24,snake_num_ind_24,newt_max_pheno_24,snake_max_pheno_24,newt_mean_pheno_24,snake_mean_pheno_24,newt_sd_pheno_24,snake_sd_pheno_24,newt_min_pheno_24,snake_min_pheno_24,newt_num_ind_25,snake_num_ind_25,newt_max_pheno_25,snake_max_pheno_25,newt_mean_pheno_25,snake_mean_pheno_25,newt_sd_pheno_25,snake_sd_pheno_25,newt_min_pheno_25,snake_min_pheno_25,newt_num_ind_26,snake_num_ind_26,newt_max_pheno_26,snake_max_pheno_26,newt_mean_pheno_26,snake_mean_pheno_26,newt_sd_pheno_26,snake_sd_pheno_26,newt_min_pheno_26,snake_min_pheno_26,newt_num_ind_27,snake_num_ind_27,newt_max_pheno_27,snake_max_pheno_27,newt_mean_pheno_27,snake_mean_pheno_27,newt_sd_pheno_27,snake_sd_pheno_27,newt_min_pheno_27,snake_min_pheno_27,newt_num_ind_28,snake_num_ind_28,newt_max_pheno_28,snake_max_pheno_28,newt_mean_pheno_28,snake_mean_pheno_28,newt_sd_pheno_28,snake_sd_pheno_28,newt_min_pheno_28,snake_min_pheno_28,newt_num_ind_29,snake_num_ind_29,newt_max_pheno_29,snake_max_pheno_29,newt_mean_pheno_29,snake_mean_pheno_29,newt_sd_pheno_29,snake_sd_pheno_29,newt_min_pheno_29,snake_min_pheno_29,newt_num_ind_30,snake_num_ind_30,newt_max_pheno_30,snake_max_pheno_30,newt_mean_pheno_30,snake_mean_pheno_30,newt_sd_pheno_30,snake_sd_pheno_30,newt_min_pheno_30,snake_min_pheno_30,newt_num_ind_31,snake_num_ind_31,newt_max_pheno_31,snake_max_pheno_31,newt_mean_pheno_31,snake_mean_pheno_31,newt_sd_pheno_31,snake_sd_pheno_31,newt_min_pheno_31,snake_min_pheno_31,newt_num_ind_32,snake_num_ind_32,newt_max_pheno_32,snake_max_pheno_32,newt_mean_pheno_32,snake_mean_pheno_32,newt_sd_pheno_32,snake_sd_pheno_32,newt_min_pheno_32,snake_min_pheno_32,newt_num_ind_33,snake_num_ind_33,newt_max_pheno_33,snake_max_pheno_33,newt_mean_pheno_33,snake_mean_pheno_33,newt_sd_pheno_33,snake_sd_pheno_33,newt_min_pheno_33,snake_min_pheno_33,newt_num_ind_34,snake_num_ind_34,newt_max_pheno_34,snake_max_pheno_34,newt_mean_pheno_34,snake_mean_pheno_34,newt_sd_pheno_34,snake_sd_pheno_34,newt_min_pheno_34,snake_min_pheno_34,newt_num_ind_35,snake_num_ind_35,newt_max_pheno_35,snake_max_pheno_35,newt_mean_pheno_35,snake_mean_pheno_35,newt_sd_pheno_35,snake_sd_pheno_35,newt_min_pheno_35,snake_min_pheno_35,newt_num_ind_36,snake_num_ind_36,newt_max_pheno_36,snake_max_pheno_36,newt_mean_pheno_36,snake_mean_pheno_36,newt_sd_pheno_36,snake_sd_pheno_36,newt_min_pheno_36,snake_min_pheno_36,newt_num_ind_37,snake_num_ind_37,newt_max_pheno_37,snake_max_pheno_37,newt_mean_pheno_37,snake_mean_pheno_37,newt_sd_pheno_37,snake_sd_pheno_37,newt_min_pheno_37,snake_min_pheno_37,newt_num_ind_38,snake_num_ind_38,newt_max_pheno_38,snake_max_pheno_38,newt_mean_pheno_38,snake_mean_pheno_38,newt_sd_pheno_38,snake_sd_pheno_38,newt_min_pheno_38,snake_min_pheno_38,newt_num_ind_39,snake_num_ind_39,newt_max_pheno_39,snake_max_pheno_39,newt_mean_pheno_39,snake_mean_pheno_39,newt_sd_pheno_39,snake_sd_pheno_39,newt_min_pheno_39,snake_min_pheno_39,newt_num_ind_40,snake_num_ind_40,newt_max_pheno_40,snake_max_pheno_40,newt_mean_pheno_40,snake_mean_pheno_40,newt_sd_pheno_40,snake_sd_pheno_40,newt_min_pheno_40,snake_min_pheno_40,newt_num_ind_41,snake_num_ind_41,newt_max_pheno_41,snake_max_pheno_41,newt_mean_pheno_41,snake_mean_pheno_41,newt_sd_pheno_41,snake_sd_pheno_41,newt_min_pheno_41,snake_min_pheno_41,newt_num_ind_42,snake_num_ind_42,newt_max_pheno_42,snake_max_pheno_42,newt_mean_pheno_42,snake_mean_pheno_42,newt_sd_pheno_42,snake_sd_pheno_42,newt_min_pheno_42,snake_min_pheno_42,newt_num_ind_43,snake_num_ind_43,newt_max_pheno_43,snake_max_pheno_43,newt_mean_pheno_43,snake_mean_pheno_43,newt_sd_pheno_43,snake_sd_pheno_43,newt_min_pheno_43,snake_min_pheno_43,newt_num_ind_44,snake_num_ind_44,newt_max_pheno_44,snake_max_pheno_44,newt_mean_pheno_44,snake_mean_pheno_44,newt_sd_pheno_44,snake_sd_pheno_44,newt_min_pheno_44,snake_min_pheno_44,newt_num_ind_45,snake_num_ind_45,newt_max_pheno_45,snake_max_pheno_45,newt_mean_pheno_45,snake_mean_pheno_45,newt_sd_pheno_45,snake_sd_pheno_45,newt_min_pheno_45,snake_min_pheno_45,newt_num_ind_46,snake_num_ind_46,newt_max_pheno_46,snake_max_pheno_46,newt_mean_pheno_46,snake_mean_pheno_46,newt_sd_pheno_46,snake_sd_pheno_46,newt_min_pheno_46,snake_min_pheno_46,newt_num_ind_47,snake_num_ind_47,newt_max_pheno_47,snake_max_pheno_47,newt_mean_pheno_47,snake_mean_pheno_47,newt_sd_pheno_47,snake_sd_pheno_47,newt_min_pheno_47,snake_min_pheno_47,newt_num_ind_48,snake_num_ind_48,newt_max_pheno_48,snake_max_pheno_48,newt_mean_pheno_48,snake_mean_pheno_48,newt_sd_pheno_48,snake_sd_pheno_48,newt_min_pheno_48,snake_min_pheno_48,newt_num_ind_49,snake_num_ind_49,newt_max_pheno_49,snake_max_pheno_49,newt_mean_pheno_49,snake_mean_pheno_49,newt_sd_pheno_49,snake_sd_pheno_49,newt_min_pheno_49,snake_min_pheno_49,newt_num_ind_50,snake_num_ind_50,newt_max_pheno_50,snake_max_pheno_50,newt_mean_pheno_50,snake_mean_pheno_50,newt_sd_pheno_50,snake_sd_pheno_50,newt_min_pheno_50,snake_min_pheno_50,newt_num_ind_51,snake_num_ind_51,newt_max_pheno_51,snake_max_pheno_51,newt_mean_pheno_51,snake_mean_pheno_51,newt_sd_pheno_51,snake_sd_pheno_51,newt_min_pheno_51,snake_min_pheno_51,newt_num_ind_52,snake_num_ind_52,newt_max_pheno_52,snake_max_pheno_52,newt_mean_pheno_52,snake_mean_pheno_52,newt_sd_pheno_52,snake_sd_pheno_52,newt_min_pheno_52,snake_min_pheno_52,newt_num_ind_53,snake_num_ind_53,newt_max_pheno_53,snake_max_pheno_53,newt_mean_pheno_53,snake_mean_pheno_53,newt_sd_pheno_53,snake_sd_pheno_53,newt_min_pheno_53,snake_min_pheno_53,newt_num_ind_54,snake_num_ind_54,newt_max_pheno_54,snake_max_pheno_54,newt_mean_pheno_54,snake_mean_pheno_54,newt_sd_pheno_54,snake_sd_pheno_54,newt_min_pheno_54,snake_min_pheno_54,newt_num_ind_55,snake_num_ind_55,newt_max_pheno_55,snake_max_pheno_55,newt_mean_pheno_55,snake_mean_pheno_55,newt_sd_pheno_55,snake_sd_pheno_55,newt_min_pheno_55,snake_min_pheno_55,newt_num_ind_56,snake_num_ind_56,newt_max_pheno_56,snake_max_pheno_56,newt_mean_pheno_56,snake_mean_pheno_56,newt_sd_pheno_56,snake_sd_pheno_56,newt_min_pheno_56,snake_min_pheno_56,newt_num_ind_57,snake_num_ind_57,newt_max_pheno_57,snake_max_pheno_57,newt_mean_pheno_57,snake_mean_pheno_57,newt_sd_pheno_57,snake_sd_pheno_57,newt_min_pheno_57,snake_min_pheno_57,newt_num_ind_58,snake_num_ind_58,newt_max_pheno_58,snake_max_pheno_58,newt_mean_pheno_58,snake_mean_pheno_58,newt_sd_pheno_58,snake_sd_pheno_58,newt_min_pheno_58,snake_min_pheno_58,newt_num_ind_59,snake_num_ind_59,newt_max_pheno_59,snake_max_pheno_59,newt_mean_pheno_59,snake_mean_pheno_59,newt_sd_pheno_59,snake_sd_pheno_59,newt_min_pheno_59,snake_min_pheno_59,newt_num_ind_60,snake_num_ind_60,newt_max_pheno_60,snake_max_pheno_60,newt_mean_pheno_60,snake_mean_pheno_60,newt_sd_pheno_60,snake_sd_pheno_60,newt_min_pheno_60,snake_min_pheno_60,newt_num_ind_61,snake_num_ind_61,newt_max_pheno_61,snake_max_pheno_61,newt_mean_pheno_61,snake_mean_pheno_61,newt_sd_pheno_61,snake_sd_pheno_61,newt_min_pheno_61,snake_min_pheno_61,newt_num_ind_62,snake_num_ind_62,newt_max_pheno_62,snake_max_pheno_62,newt_mean_pheno_62,snake_mean_pheno_62,newt_sd_pheno_62,snake_sd_pheno_62,newt_min_pheno_62,snake_min_pheno_62,newt_num_ind_63,snake_num_ind_63,newt_max_pheno_63,snake_max_pheno_63,newt_mean_pheno_63,snake_mean_pheno_63,newt_sd_pheno_63,snake_sd_pheno_63,newt_min_pheno_63,snake_min_pheno_63,newt_num_ind_64,snake_num_ind_64,newt_max_pheno_64,snake_max_pheno_64,newt_mean_pheno_64,snake_mean_pheno_64,newt_sd_pheno_64,snake_sd_pheno_64,newt_min_pheno_64,snake_min_pheno_64,newt_num_ind_65,snake_num_ind_65,newt_max_pheno_65,snake_max_pheno_65,newt_mean_pheno_65,snake_mean_pheno_65,newt_sd_pheno_65,snake_sd_pheno_65,newt_min_pheno_65,snake_min_pheno_65,newt_num_ind_66,snake_num_ind_66,newt_max_pheno_66,snake_max_pheno_66,newt_mean_pheno_66,snake_mean_pheno_66,newt_sd_pheno_66,snake_sd_pheno_66,newt_min_pheno_66,snake_min_pheno_66,newt_num_ind_67,snake_num_ind_67,newt_max_pheno_67,snake_max_pheno_67,newt_mean_pheno_67,snake_mean_pheno_67,newt_sd_pheno_67,snake_sd_pheno_67,newt_min_pheno_67,snake_min_pheno_67,newt_num_ind_68,snake_num_ind_68,newt_max_pheno_68,snake_max_pheno_68,newt_mean_pheno_68,snake_mean_pheno_68,newt_sd_pheno_68,snake_sd_pheno_68,newt_min_pheno_68,snake_min_pheno_68,newt_num_ind_69,snake_num_ind_69,newt_max_pheno_69,snake_max_pheno_69,newt_mean_pheno_69,snake_mean_pheno_69,newt_sd_pheno_69,snake_sd_pheno_69,newt_min_pheno_69,snake_min_pheno_69,newt_num_ind_70,snake_num_ind_70,newt_max_pheno_70,snake_max_pheno_70,newt_mean_pheno_70,snake_mean_pheno_70,newt_sd_pheno_70,snake_sd_pheno_70,newt_min_pheno_70,snake_min_pheno_70,newt_num_ind_71,snake_num_ind_71,newt_max_pheno_71,snake_max_pheno_71,newt_mean_pheno_71,snake_mean_pheno_71,newt_sd_pheno_71,snake_sd_pheno_71,newt_min_pheno_71,snake_min_pheno_71,newt_num_ind_72,snake_num_ind_72,newt_max_pheno_72,snake_max_pheno_72,newt_mean_pheno_72,snake_mean_pheno_72,newt_sd_pheno_72,snake_sd_pheno_72,newt_min_pheno_72,snake_min_pheno_72,newt_num_ind_73,snake_num_ind_73,newt_max_pheno_73,snake_max_pheno_73,newt_mean_pheno_73,snake_mean_pheno_73,newt_sd_pheno_73,snake_sd_pheno_73,newt_min_pheno_73,snake_min_pheno_73,newt_num_ind_74,snake_num_ind_74,newt_max_pheno_74,snake_max_pheno_74,newt_mean_pheno_74,snake_mean_pheno_74,newt_sd_pheno_74,snake_sd_pheno_74,newt_min_pheno_74,snake_min_pheno_74,newt_num_ind_75,snake_num_ind_75,newt_max_pheno_75,snake_max_pheno_75,newt_mean_pheno_75,snake_mean_pheno_75,newt_sd_pheno_75,snake_sd_pheno_75,newt_min_pheno_75,snake_min_pheno_75,newt_num_ind_76,snake_num_ind_76,newt_max_pheno_76,snake_max_pheno_76,newt_mean_pheno_76,snake_mean_pheno_76,newt_sd_pheno_76,snake_sd_pheno_76,newt_min_pheno_76,snake_min_pheno_76,newt_num_ind_77,snake_num_ind_77,newt_max_pheno_77,snake_max_pheno_77,newt_mean_pheno_77,snake_mean_pheno_77,newt_sd_pheno_77,snake_sd_pheno_77,newt_min_pheno_77,snake_min_pheno_77,newt_num_ind_78,snake_num_ind_78,newt_max_pheno_78,snake_max_pheno_78,newt_mean_pheno_78,snake_mean_pheno_78,newt_sd_pheno_78,snake_sd_pheno_78,newt_min_pheno_78,snake_min_pheno_78,newt_num_ind_79,snake_num_ind_79,newt_max_pheno_79,snake_max_pheno_79,newt_mean_pheno_79,snake_mean_pheno_79,newt_sd_pheno_79,snake_sd_pheno_79,newt_min_pheno_79,snake_min_pheno_79,newt_num_ind_80,snake_num_ind_80,newt_max_pheno_80,snake_max_pheno_80,newt_mean_pheno_80,snake_mean_pheno_80,newt_sd_pheno_80,snake_sd_pheno_80,newt_min_pheno_80,snake_min_pheno_80,newt_num_ind_81,snake_num_ind_81,newt_max_pheno_81,snake_max_pheno_81,newt_mean_pheno_81,snake_mean_pheno_81,newt_sd_pheno_81,snake_sd_pheno_81,newt_min_pheno_81,snake_min_pheno_81,newt_num_ind_82,snake_num_ind_82,newt_max_pheno_82,snake_max_pheno_82,newt_mean_pheno_82,snake_mean_pheno_82,newt_sd_pheno_82,snake_sd_pheno_82,newt_min_pheno_82,snake_min_pheno_82,newt_num_ind_83,snake_num_ind_83,newt_max_pheno_83,snake_max_pheno_83,newt_mean_pheno_83,snake_mean_pheno_83,newt_sd_pheno_83,snake_sd_pheno_83,newt_min_pheno_83,snake_min_pheno_83,newt_num_ind_84,snake_num_ind_84,newt_max_pheno_84,snake_max_pheno_84,newt_mean_pheno_84,snake_mean_pheno_84,newt_sd_pheno_84,snake_sd_pheno_84,newt_min_pheno_84,snake_min_pheno_84,newt_num_ind_85,snake_num_ind_85,newt_max_pheno_85,snake_max_pheno_85,newt_mean_pheno_85,snake_mean_pheno_85,newt_sd_pheno_85,snake_sd_pheno_85,newt_min_pheno_85,snake_min_pheno_85,newt_num_ind_86,snake_num_ind_86,newt_max_pheno_86,snake_max_pheno_86,newt_mean_pheno_86,snake_mean_pheno_86,newt_sd_pheno_86,snake_sd_pheno_86,newt_min_pheno_86,snake_min_pheno_86,newt_num_ind_87,snake_num_ind_87,newt_max_pheno_87,snake_max_pheno_87,newt_mean_pheno_87,snake_mean_pheno_87,newt_sd_pheno_87,snake_sd_pheno_87,newt_min_pheno_87,snake_min_pheno_87,newt_num_ind_88,snake_num_ind_88,newt_max_pheno_88,snake_max_pheno_88,newt_mean_pheno_88,snake_mean_pheno_88,newt_sd_pheno_88,snake_sd_pheno_88,newt_min_pheno_88,snake_min_pheno_88,newt_num_ind_89,snake_num_ind_89,newt_max_pheno_89,snake_max_pheno_89,newt_mean_pheno_89,snake_mean_pheno_89,newt_sd_pheno_89,snake_sd_pheno_89,newt_min_pheno_89,snake_min_pheno_89,newt_num_ind_90,snake_num_ind_90,newt_max_pheno_90,snake_max_pheno_90,newt_mean_pheno_90,snake_mean_pheno_90,newt_sd_pheno_90,snake_sd_pheno_90,newt_min_pheno_90,snake_min_pheno_90,newt_num_ind_91,snake_num_ind_91,newt_max_pheno_91,snake_max_pheno_91,newt_mean_pheno_91,snake_mean_pheno_91,newt_sd_pheno_91,snake_sd_pheno_91,newt_min_pheno_91,snake_min_pheno_91,newt_num_ind_92,snake_num_ind_92,newt_max_pheno_92,snake_max_pheno_92,newt_mean_pheno_92,snake_mean_pheno_92,newt_sd_pheno_92,snake_sd_pheno_92,newt_min_pheno_92,snake_min_pheno_92,newt_num_ind_93,snake_num_ind_93,newt_max_pheno_93,snake_max_pheno_93,newt_mean_pheno_93,snake_mean_pheno_93,newt_sd_pheno_93,snake_sd_pheno_93,newt_min_pheno_93,snake_min_pheno_93,newt_num_ind_94,snake_num_ind_94,newt_max_pheno_94,snake_max_pheno_94,newt_mean_pheno_94,snake_mean_pheno_94,newt_sd_pheno_94,snake_sd_pheno_94,newt_min_pheno_94,snake_min_pheno_94,newt_num_ind_95,snake_num_ind_95,newt_max_pheno_95,snake_max_pheno_95,newt_mean_pheno_95,snake_mean_pheno_95,newt_sd_pheno_95,snake_sd_pheno_95,newt_min_pheno_95,snake_min_pheno_95,newt_num_ind_96,snake_num_ind_96,newt_max_pheno_96,snake_max_pheno_96,newt_mean_pheno_96,snake_mean_pheno_96,newt_sd_pheno_96,snake_sd_pheno_96,newt_min_pheno_96,snake_min_pheno_96,newt_num_ind_97,snake_num_ind_97,newt_max_pheno_97,snake_max_pheno_97,newt_mean_pheno_97,snake_mean_pheno_97,newt_sd_pheno_97,snake_sd_pheno_97,newt_min_pheno_97,snake_min_pheno_97,newt_num_ind_98,snake_num_ind_98,newt_max_pheno_98,snake_max_pheno_98,newt_mean_pheno_98,snake_mean_pheno_98,newt_sd_pheno_98,snake_sd_pheno_98,newt_min_pheno_98,snake_min_pheno_98,newt_num_ind_99,snake_num_ind_99,newt_max_pheno_99,snake_max_pheno_99,newt_mean_pheno_99,snake_mean_pheno_99,newt_sd_pheno_99,snake_sd_pheno_99,newt_min_pheno_99,snake_min_pheno_99,rep,snake_mu_rate,snake_mu_effect_sd,newt_mu_rate,newt_mu_effect_sd' > /Users/victoria/Desktop/bash_test/all_grid.txt
echo 'generation,mean_newt_pheno_By_mean_snake_pheno,num_newts_By_num_snakes,sum_newt_pheno_By_num_snake,sum_snake_pheno_By_num_newt,sum_newt_pheno_By_num_newt,sum_snake_pheno_By_snake_newt,rep,snake_mu_rate,snake_mu_effect_sd,newt_mu_rate,newt_mu_effect_sd' > /Users/victoria/Desktop/bash_test/all_cor.txt

for filename in $thefolder*.text;
  do 
#getting the variables 
my_type=$(echo ${filename} |sed 's/.*GA205_//; s/_.*//')
my_other_type=$(echo ${filename} |sed 's/.*GA520_//; s/_.*//')
snake_mu_rate=$(echo ${filename} |sed 's/.*snake_mu_rate_//; s/_.*//')
snake_mu_effect_sd=$(echo ${filename} |sed 's/.*snake_mu_effect_sd_//; s/_.*//')
newt_mu_rate=$(echo ${filename} |sed 's/.*newt_mu_rate_//; s/_.*//')
newt_mu_effect_sd=$(echo ${filename} |sed 's/.*newt_mu_effect_sd_//; s/_.*//')
rep=$(echo ${filename} | sed "s/.*rep_//; s/_.*//")
#echo ${newt_mu_rate}	
# echo $my_type
# echo $my_other_type
# these new columns adding them to the data
sed -i '' -e 's/$/,'${rep}'/' $filename
sed -i '' -e 's/$/,'${snake_mu_rate}'/' $filename
sed -i '' -e 's/$/,'${snake_mu_effect_sd}'/' $filename
sed -i '' -e 's/$/,'${newt_mu_rate}'/' $filename
sed -i '' -e 's/$/,'${newt_mu_effect_sd}'/' $filename
#infile >outfile
if [[ $my_type == "lit" ]]
then
    tail -n +2 -q $filename >> /Users/victoria/Desktop/bash_test/all_lit.txt
fi

if [[ $my_type == "grid" ]]
then
    tail -n +2 -q $filename >> /Users/victoria/Desktop/bash_test/all_grid.txt
fi

if [[ $my_other_type == "cor" ]]
then
    tail -n +2 -q $filename >> /Users/victoria/Desktop/bash_test/all_cor.txt
fi

done

```



```{r, data gathering}

snewt <- read.csv("~/Desktop/snake_newt_real_data.csv", header = TRUE)

GA3_tall_tall_file<- read.csv("~/Desktop/bash_test/all_lit.txt" , header = TRUE)

GA3_tall_tall_file$group_rep <- paste0(GA3_tall_tall_file$snake_mu_rate, "_", GA3_tall_tall_file$snake_mu_effect_sd,"_",GA3_tall_tall_file$newt_mu_rate, "_", GA3_tall_tall_file$newt_mu_effect_sd, "_", GA3_tall_tall_file$rep)

GA3_tall_tall_file$group <- paste0(GA3_tall_tall_file$snake_mu_rate, "_", GA3_tall_tall_file$snake_mu_effect_sd,"_",GA3_tall_tall_file$newt_mu_rate, "_", GA3_tall_tall_file$newt_mu_effect_sd)

GA3_tall_tall_file$sim=LETTERS[factor(GA3_tall_tall_file$group)]
GA3_tall_tall_file$dif <- GA3_tall_tall_file$Snake_mean_Pheno-GA3_tall_tall_file$Newt_mean_Pheno



GA3_cor_tall_file<- read.csv("~/Desktop/bash_test/all_cor.txt" , header = TRUE)
GA3_cor_tall_file$group_rep <- paste0(GA3_cor_tall_file$snake_mu_rate, "_", GA3_cor_tall_file$snake_mu_effect_sd,"_",GA3_cor_tall_file$newt_mu_rate, "_", GA3_cor_tall_file$newt_mu_effect_sd, "_", GA3_cor_tall_file$rep)
GA3_cor_tall_file$group <- paste0(GA3_cor_tall_file$snake_mu_rate, "_", GA3_cor_tall_file$snake_mu_effect_sd,"_",GA3_cor_tall_file$newt_mu_rate, "_", GA3_cor_tall_file$newt_mu_effect_sd)
GA3_cor_tall_file$sim=LETTERS[factor(GA3_cor_tall_file$group)]

GA3_GA3_grid_tall_file<-read.csv("~/Desktop/bash_test/all_grid.txt" , header = TRUE)
GA3_GA3_grid_tall_file$group <- paste0(GA3_GA3_grid_tall_file$snake_mu_rate, "_", GA3_GA3_grid_tall_file$snake_mu_effect_sd,"_",GA3_GA3_grid_tall_file$newt_mu_rate, "_", GA3_GA3_grid_tall_file$newt_mu_effect_sd)
GA3_GA3_grid_tall_file$group_rep <- paste0(GA3_GA3_grid_tall_file$snake_mu_rate, "_", GA3_GA3_grid_tall_file$snake_mu_effect_sd,"_",GA3_GA3_grid_tall_file$newt_mu_rate, "_", GA3_GA3_grid_tall_file$newt_mu_effect_sd, "_", GA3_GA3_grid_tall_file$rep)

GA3_GA3_grid_tall_file$sim=LETTERS[factor(GA3_GA3_grid_tall_file$group)]
GA3_GA3_grid_tall_file$snake_newt_rep <- paste0("Snake_",GA3_GA3_grid_tall_file$snake_mu_rate, "_", GA3_GA3_grid_tall_file$snake_mu_effect_sd, "_Newt_",GA3_GA3_grid_tall_file$newt_mu_rate, "_", GA3_GA3_grid_tall_file$newt_mu_effect_sd, "_", GA3_GA3_grid_tall_file$rep)

```


```{r, cor box set up}

boxplot_cors_by_gen <- function(file, title, subt, x_label, y_label, min_gen, max_gen){
 snewt$mean_res = snewt$mean_toxin+snewt$dif
  real_snewt_cor = cor(snewt$mean_toxin, snewt$mean_res)
  file$snake_newt <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  unique(file$sim)
  plot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen),]) +
  ylim(-1.1, 1.1)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_boxplot(aes(x=factor(rep), y=as.numeric(mean_newt_pheno_By_mean_snake_pheno), color = "CA"))+
  geom_hline(yintercept=real_snewt_cor, linetype="dashed")+
    geom_hline(yintercept=0, linetype="solid")+
  #geom_boxplot(aes(x=factor("CB"), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  #geom_boxplot(aes(x=factor("CC"), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  #geom_boxplot(aes(x=factor("CD"), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  theme(plot.title = element_text(size=5)) +
  facet_wrap(~snake_newt)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())


  return(plot)
}

hist_cors_by_gen_col_rep <- function(file, title, subt, x_label, y_label, min_gen, max_gen){
 snewt$mean_res = snewt$mean_toxin+snewt$dif
  real_snewt_cor = cor(snewt$mean_toxin, snewt$mean_res)
   file$snake_newt <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  #unique(file$sim)
  plot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen),]) +
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=as.numeric(mean_newt_pheno_By_mean_snake_pheno),fill=factor(rep)))+
  geom_vline(xintercept=real_snewt_cor, linetype="dashed")+
  geom_vline(xintercept=0, linetype="solid")+
  #geom_boxplot(aes(x=factor("CB"), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  #geom_boxplot(aes(x=factor("CC"), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  #geom_boxplot(aes(x=factor("CD"), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  theme(plot.title = element_text(size=5)) +
  xlim(-1.1, 1.1)+
  facet_wrap(~snake_newt)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())


  return(plot)
}

hist_cors_by_gen_col_rep_nofill <- function(file, title, subt, x_label, y_label, min_gen, max_gen){
 snewt$mean_res = snewt$mean_toxin+snewt$dif
  real_snewt_cor = cor(snewt$mean_toxin, snewt$mean_res)
  file$snake_newt <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  unique(file$sim)
  plot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen),]) +
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=as.numeric(mean_newt_pheno_By_mean_snake_pheno)))+
  geom_vline(xintercept=real_snewt_cor, linetype="dashed")+
  geom_vline(xintercept=0, linetype="solid")+
  #geom_boxplot(aes(x=factor("CB"), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  #geom_boxplot(aes(x=factor("CC"), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  #geom_boxplot(aes(x=factor("CD"), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  theme(plot.title = element_text(size=5)) +
  #stat_bin(bins=30)+
  facet_wrap(~snake_newt)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())

suppressMessages(print(plot))

  return(plot)
}


var_cor <- function(file, cfile, title, subt, x_label, y_label, min_gen, max_gen){
  real_snewt_cor = cor(snewt$mean_toxin, snewt$mean_res)
  real_snewt_var = var(snewt$dif)
  var_cor_table=data.frame()

  
  for(i in 1:length(unique(file$snake_newt_rep))){
    pattern<-unique(file$snake_newt_rep)[i]
    temp_file<-file[which(file$gen>=min_gen & file$gen<=max_gen & file$snake_newt_rep==pattern),]
    temp_cor_file<-cfile[which(cfile$gen>=min_gen & cfile$gen<=max_gen & cfile$snake_newt_rep==pattern),]
    
    var_cor_table_temp<- data.frame("pattern"=pattern, "var"= var(temp_file$dif),"cor" = cor(temp_file$newt_toxin, temp_file$snake_res), "mean_corr" = mean(temp_cor_file$mean_newt_pheno_By_mean_snake_pheno))
    var_cor_table <- rbind(var_cor_table, var_cor_table_temp)
  }
 
  var_cor_table_temp<- data.frame("pattern"="real", "var"= real_snewt_var, "cor" = real_snewt_cor, "mean_corr" = real_snewt_cor)
  var_cor_table <- rbind(var_cor_table, var_cor_table_temp)
  
  plot <- ggplot(var_cor_table) +
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_point(aes(x=as.numeric(var), y=as.numeric(cor), color = pattern), shape=17, size=3)+
  geom_point(aes(x=as.numeric(var), y=as.numeric(mean_corr), color = pattern), size=3)+
  theme(plot.title = element_text(size=5)) +
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8))


  return(plot)
}



cor_trends_by_gen <- function(file, cfile, title, subt, x_label, x_label_cor, y_label, min_gen, max_gen, pattern){
#file=GA3_tall_tall_file
#cfile=GA3_cor_tall_file 
 # pattern="1.0e-10_0.05_1.0e-08_0.005_3"
 file$snake_newt_rep <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd,"_", file$rep)
  cfile$snake_newt_rep <- paste0(cfile$snake_mu_rate, "_", cfile$snake_mu_effect_sd, "_", cfile$newt_mu_rate, "_", cfile$newt_mu_effect_sd, "_", cfile$rep)
  plot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen & file$snake_newt_rep==pattern),]) +
    #geom_line(aes(generation, dif, group=rep, col="dif"))+
      ggtitle(title, subtitle = paste0(subt," pattern ", pattern, " From ", min_gen, " gen to ", max_gen, " gen"))+
    geom_line(aes(generation, Snake_mean_Pheno, group=rep, color="Snake_mean_Pheno"),)+
    geom_line(aes(generation, Newt_mean_Pheno, group=rep, color="Newt_mean_Pheno"))+
    #ylim(0,10)+
    #xlab(x_label) + ylab(y_label)+
    scale_color_manual(name = "Type",
values = c( "Snake_mean_Pheno" = "steelblue", "Newt_mean_Pheno" = "darkred"),
labels = c("Snake", "Newt"))+
    theme_bw() +theme(legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank(), axis.ticks.x = element_blank(), axis.text.x = element_blank(),
                      plot.margin=unit(c(1,1,+0.3,1), "cm"))
  
  cor_plot <- ggplot(cfile[which(cfile$gen>=min_gen & cfile$gen<=max_gen & cfile$snake_newt_rep==pattern),]) +
    geom_line(aes(generation, mean_newt_pheno_By_mean_snake_pheno, col="CA"))+
    #ggtitle(title, subtitle = subt) +
    ylim(-1.1, 1.1)+
    #xlab(x_label_cor) + ylab(y_label)+
    theme_bw() +theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank(),
                      plot.margin=unit(c(-0.5,1,1,1), "cm"))
  
  file<-file[which(file$gen>=min_gen & file$gen<=max_gen & file$snake_newt_rep==pattern),]
  cfile<-cfile[which(cfile$gen>=min_gen & cfile$gen<=max_gen & cfile$snake_newt_rep==pattern),]
  
  if(nrow(cfile)>nrow(file)){
    toDelete <- seq(0, nrow(cfile), 2)
    cfile_short <-  cfile[-toDelete, ]
  }else{
    cfile_short <-  cfile
  }
  
  if(nrow(cfile_short)>nrow(file)){
      toDelete <- seq(0, nrow(cfile_short), 2)
      cfile_short <-  cfile_short[-toDelete, ]
    }
  figure <- ggarrange(plot, cor_plot + font("x.text", size = 10),heights = c(2, 1.5),ncol = 1, nrow = 2, align = "v")
    print(paste0("pattern ", pattern))
  print(paste0("Cor between average snake pheno and local cor ", cor(file$Snake_mean_Pheno, cfile_short$mean_newt_pheno_By_mean_snake_pheno)))
  print(paste0("Cor between average newt pheno and local cor ", cor(file$Newt_mean_Pheno, cfile_short$mean_newt_pheno_By_mean_snake_pheno)))
  print(paste0("Cor between average dif pheno and local cor ", cor(file$dif, cfile_short$mean_newt_pheno_By_mean_snake_pheno)))
  print(paste0("Cor between newt pheno and snake ", cor(file$Newt_mean_Pheno, file$Snake_mean_Pheno)))
  return(figure)
}


four_types_boxplot_cors_by_gen <- function(file,title, subt, x_label, y_label, min_gen, max_gen){
  file$snake_newt <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  plot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen),]) +
  ylim(-1.1, 1.1)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_boxplot(aes(x=factor("CA"), y=as.numeric(mean_newt_pheno_By_mean_snake_pheno), color = "CA"))+
  geom_boxplot(aes(x=factor("CB"), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  geom_boxplot(aes(x=factor("CC"), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  geom_boxplot(aes(x=factor("CD"), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  geom_hline(yintercept=0, linetype="solid")+
  theme(plot.title = element_text(size=5)) +
  facet_wrap(~snake_newt)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())


  return(plot)
}

```


```{r, general file and graph making}

#the functions to make the params file and the summary and heatmap figures 

create_parm_file <- function(file, min_gen, max_gen){
params <- data_frame()

for(i in 1:length(unique(file$snake_newt_rep))){

  pattern=unique(file$snake_newt_rep)[i]
  sumitup <- file[which(file$gen>=min_gen & file$gen<=max_gen & file$snake_newt_rep ==pattern),]
 
  params_temp<- data_frame(Newt_mean_Pheno=mean(sumitup$Newt_mean_Pheno),
                           Snake_mean_Pheno=mean(sumitup$Snake_mean_Pheno), 
                           Newt_mean_Pheno_sd=sd(sumitup$Newt_mean_Pheno),
                           Snake_mean_Pheno_sd=sd(sumitup$Snake_mean_Pheno),
                           Newt_pop_size=mean(sumitup$Newt_pop_size),
                           Snake_pop_size=mean(sumitup$Snake_pop_size),
                           dif=mean(sumitup$dif),
                           snake_mu_rate=sumitup$snake_mu_rate[1],
                           newt_mu_rate=sumitup$newt_mu_rate[1],
                           snake_mu_effect_sd=sumitup$snake_mu_effect_sd[1],
                           newt_mu_effect_sd=sumitup$newt_mu_effect_sd[1],
                           rep=sumitup$rep[1])
  
  
  params <- rbind(params, params_temp)
}

params$snake <- paste0(params$snake_mu_rate, "_",params$snake_mu_effect_sd)
params$newt <- paste0(params$newt_mu_rate, "_",params$newt_mu_effect_sd)
params$snake_newt <- paste0(params$snake, "_", params$newt)
return(params)
}

GA_summary <- function(file, min_gen, max_gen, x_line, y_line, title, subt, y_label, x_label){

file$snake_newt_rep <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd, "_", file$rep)

params<-create_parm_file(file, min_gen, max_gen)

my_plot <- ggplot(params) +
  #xlim(0, 1000)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_point(aes(x=as.numeric(get(x_line)), y=as.numeric(get(y_line)), color = factor(snake), shape=factor(newt)),size=3)+
#  geom_point(aes(x=as.numeric(Newt_pop_size_20), y=as.numeric(Snake_pop_size_20), color = factor(snake), shape=factor(newt)))+
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  #facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text( hjust=1, size = 8))

return(my_plot)
}

build_heatmap <- function(file, min_gen, max_gen, fill_line, fill_line_text, title, subt, y_label, x_label, red_blue=F){
  file$snake_newt_rep <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd, "_", file$rep)
  params<-create_parm_file(file, min_gen, max_gen)
  
 my_plot <- ggplot(params, aes(newt, paste0(snake, "_", rep))) +    # Create heatmap with ggplot2
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_tile(aes(fill = get(fill_line)))+theme(axis.text.x = element_text(angle = 45, hjust=1, size = 10), axis.text.y = element_text(size = 10))
 
 if(red_blue==FALSE){
  my_plot<- my_plot + scale_fill_viridis_c(name = fill_line_text) + theme(legend.text=element_text(angle = 45, hjust=1, size=10))
  }
 if(red_blue==TRUE){
  my_plot<- my_plot + scale_fill_gradient2(low = "red",mid = "beige", high = "blue", name = fill_line_text) + theme(legend.text=element_text(size=5))
 }
 
  return(my_plot)
}

trends_by_gen <- function(file, title, subt, x_label, y_label, min_gen, max_gen){
 
  plot <- ggplot(file[ which(file$generation>=min_gen & file$generation<=max_gen),]) +
    facet_wrap(~sim)+
    geom_line(aes(generation, dif, group=rep, col="dif"))+
    ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
    geom_line(aes(generation, Snake_mean_Pheno, group=rep, color="Snake_mean_Pheno"),)+
    geom_line(aes(generation, Newt_mean_Pheno, group=rep, color="Newt_mean_Pheno"))+
    geom_hline(yintercept=0, linetype="dashed", color="gray54")+
    ylim(-1.,2.5)+
    xlab(x_label) + ylab(y_label)+
    scale_color_manual(name = "Type",
values = c( "Snake_mean_Pheno" = "steelblue", "Newt_mean_Pheno" = "darkred", "dif" = "black"),
labels = c("Snake", "Newt", "Dif"))+
    theme_bw() + theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())
  return(plot)
}

whale_gen <- function(file, title, subt, x_label, y_label,min_gen, max_gen, rep){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
dif <- ggplot(file[ which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep),]) +
  #xlim(0, 1000)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen, rep ",rep)) +
  xlab(x_label) + ylab(y_label)+
  geom_point(aes(x=as.numeric(Newt_pop_size), y=as.numeric(Snake_pop_size), color = dif))+
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}


pop_size_hist <- function(file, title, subt, x_label, y_label,min_gen, max_gen, rep){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  file<-file[ which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep),]
  themin <- min(file$Snake_pop_size-file$Newt_pop_size) 
  themax <- max(file$Snake_pop_size-file$Newt_pop_size)
  true_max <- max(abs(themin), abs(themax))
dif <- ggplot(file) +
  #xlim(0, 1000)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(Snake_pop_size-Newt_pop_size), fill="darkolivegreen4")+
  xlim((-1*themax)-5, themax+5)+
  theme(plot.title = element_text(size=5)) +
  facet_wrap(~sim)+
  geom_vline(xintercept = 0)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)
}

pheno_dif_hist <- function(file, title, subt, x_label, y_label,min_gen, max_gen, rep){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  file<-file[ which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep),]
  
  themin <- min(file$dif) 
  themax <- max(file$dif)
  true_max <- max(abs(themin), abs(themax))
dif <- ggplot(file) +
  #xlim(0, 1000)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen, rep ",rep)) +
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(dif), fill="aquamarine4")+
  xlim((-1*true_max)-1, true_max+1)+

  # y=as.numeric(Snake_pop_size-Newt_pop_size), color = snake_GA, shape = factor(newt_GA)
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  geom_vline(xintercept = 0)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}




two_hist <- function(file, title, subt, x_label, y_label,min_gen, max_gen, rep){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  
  file<-file[ which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep),]
  
  thepopmin <- min(file$Snake_pop_size-file$Newt_pop_size)/100 
  thepopmax <- max(file$Snake_pop_size-file$Newt_pop_size)/100
  thedifmin <- min(file$dif) 
  thedifmax <- max(file$dif)
  true_max <- max(abs(thepopmin), abs(thepopmax),abs(thedifmin), abs(thedifmax))

  data_points <- nrow(file[which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep &  file$snake_GA==file$snake_GA[1] &  file$newt_GA==file$newt_GA[1]),])
dif <- ggplot(file) +
  
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen, rep ",rep)) +
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=dif, y=..count../data_points), fill="#8B008B",  alpha = 0.65)+
  geom_histogram(aes(x=(Snake_pop_size-Newt_pop_size)/100, y=..count../data_points), fill="#008B00",  alpha = 0.65)+
  scale_y_continuous(labels = scales::percent)+
  xlim((-1*true_max)-1, true_max+1)+
  # y=as.numeric(Snake_pop_size-Newt_pop_size), color = snake_GA, shape = factor(newt_GA)
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  geom_vline(xintercept = 0)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}

two_hist_all_rep <- function(file, title, subt, x_label, y_label,min_gen, max_gen){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  
  file<-file[ which(file$generation>=min_gen & file$generation<=max_gen),]
  
  thepopmin <- min(file$Snake_pop_size-file$Newt_pop_size)/100 
  thepopmax <- max(file$Snake_pop_size-file$Newt_pop_size)/100
  thedifmin <- min(file$dif) 
  thedifmax <- max(file$dif)
  true_max <- max(abs(thepopmin), abs(thepopmax),abs(thedifmin), abs(thedifmax))

  data_points <- nrow(file[which(file$generation>=min_gen & file$generation<=max_gen  &  file$snake_GA==file$snake_GA[1] &  file$newt_GA==file$newt_GA[1]),])
  
dif <- ggplot(file) +
  
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=dif, y=..count../data_points), fill="#8B008B",  alpha = 0.65, bins = 20)+ #purple
  geom_histogram(aes(x=(Snake_pop_size-Newt_pop_size)/100, y=..count../data_points), fill="#008B00",  alpha = 0.65, bins = 20)+ #green
  scale_y_continuous(labels = scales::percent)+
  xlim((-1*true_max)-1, true_max+1)+
  # y=as.numeric(Snake_pop_size-Newt_pop_size), color = snake_GA, shape = factor(newt_GA)
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  geom_vline(xintercept = 0)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      #strip.background = element_blank(), 
                      strip.text.x = element_blank(), 
                      #panel.grid.major = element_blank(), 
                      #panel.grid.minor = element_blank(),
                      #panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}

two_hist_death_all_rep <- function(file, title, subt, x_label, y_label,min_gen, max_gen){
  #file=GA3_tall_tall_file
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  
  file<-file[ which(file$generation>=min_gen & file$generation<=max_gen),]
  
  thepopmin <- min(file$newt_deaths)
  thepopmax <- max(file$newt_deaths)
  thedifmin <- min(file$snake_deaths) 
  thedifmax <- max(file$snake_deaths)
  true_max <- max(abs(thepopmin), abs(thepopmax),abs(thedifmin), abs(thedifmax))

  data_points <- nrow(file[which(file$generation>=min_gen & file$generation<=max_gen  &  file$snake_GA==file$snake_GA[1] &  file$newt_GA==file$newt_GA[1]),])
  
dif <- ggplot(file) +
  
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=newt_deaths), fill="red",  alpha = 0.65, bins = 20)+
  geom_histogram(aes(x=snake_deaths), fill="blue",  alpha = 0.65, bins = 20)+
  #scale_y_continuous(labels = scales::percent)+
  #xlim((-1*true_max)-1, true_max+1)+
  # y=as.numeric(Snake_pop_size-Newt_pop_size), color = snake_GA, shape = factor(newt_GA)
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  #geom_vline(xintercept = 0)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      #strip.background = element_blank(), 
                      strip.text.x = element_blank(), 
                      #panel.grid.major = element_blank(), 
                      #panel.grid.minor = element_blank(),
                      #panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}

#two_hist_death_all_rep(GA3_tall_tall_file, title="Snake-Newt Winning Hist", subt="Gen 16sims", y_label="Count", x_label="Snake-Newt Phenotype (purple) & Snake-Newt Popsize/100 (green)",  min_gen=20000, max_gen=25000)

```

## Mean Phenotype Whole Simulation



```{r, graphing by gen}
trends_by_gen(GA3_tall_tall_file, title="Space Tall: Newt VS Snake Population Size GA3", subt="Gen 16sims", y_label="Mean Phenotype", x_label="Generations", 100, 50000)


aggregate(GA3_tall_tall_file[which(GA3_tall_tall_file$generation>=100 & GA3_tall_tall_file$generation<=50000),]$dif, list(GA3_tall_tall_file[which(GA3_tall_tall_file$generation>=100 & GA3_tall_tall_file$generation<=50000),]$group), FUN=mean) 

#aggregate(GA3_tall_tall_file[which(GA3_tall_tall_file$generation>=100 & GA3_tall_tall_file$generation<=50000),]$dif, list(GA3_tall_tall_file[which(GA3_tall_tall_file$generation>=100 & GA3_tall_tall_file$generation<=50000),]$group_rep), FUN=mean) 

```


#### Connection between higher phenotype and population


```{r, whale}
min_gen=5000
max_gen=10000
rep=0

whale_gen(GA3_tall_tall_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake-Newt Popsize", x_label="Snake-Newt Phenotype", min_gen=min_gen, max_gen=max_gen, rep=rep )

suppressMessages(print(two_hist(GA3_tall_tall_file, title="Snake-Newt Winning Hist", subt="Gen 16sims", y_label="Count", x_label="Snake-Newt Popsize/100 (green) & Snake-Newt Phenotype (purple)",  min_gen=min_gen, max_gen=max_gen, rep=rep )))

suppressMessages(print(two_hist_all_rep(GA3_tall_tall_file, title="Snake-Newt Winning Hist", subt="Gen 16sims", y_label="Count", x_label="Snake-Newt Popsize/100 (green) & Snake-Newt Phenotype (purple)",  min_gen=min_gen, max_gen=max_gen)))


```



## Correlation

Legend:

- "CA" = mean_newt_pheno_By_mean_snake_pheno (Pink)
- "CB" = num_newts_By_num_snakes (Green)
- "CC" = sum_newt_pheno_By_num_snake (Blue)
- "CD" = sum_snake_pheno_By_num_newt (Purple)


```{r, combo myplots}
#files
#GA3_tall_tall_file
#GA2_long_file 
#GA3_cor_tall_file
#GA2_cor_file

ginmin = 10000
ginmax = 15000

boxplot_cors_by_gen(GA3_cor_tall_file, "Simulation Correlation Comparied to Real Correlation Trials", "GA3", "newt/snake GAs&rep", "Cor", ginmin, ginmax)


four_types_boxplot_cors_by_gen(GA3_cor_tall_file, "Simulation four Correlation", "GA3", "newt/snake GAs&rep", "Cor", ginmin, ginmax)



suppressMessages(print(hist_cors_by_gen_col_rep(GA3_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA3", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))



```




```{r, GA3 cor by dif windows}

ginmin = 0
ginmax = 5000
suppressMessages(print(hist_cors_by_gen_col_rep(GA3_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA3", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 5000
ginmax = 10000
suppressMessages(print(hist_cors_by_gen_col_rep(GA3_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA3", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 10000
ginmax = 15000
suppressMessages(print(hist_cors_by_gen_col_rep(GA3_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA3", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 15000
ginmax = 20000
suppressMessages(print(hist_cors_by_gen_col_rep(GA3_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA3", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 20000
ginmax = 25000
suppressMessages(print(hist_cors_by_gen_col_rep(GA3_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA3", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 25000
ginmax = 30000
suppressMessages(print(hist_cors_by_gen_col_rep(GA3_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA3", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 30000
ginmax = 35000
suppressMessages(print(hist_cors_by_gen_col_rep(GA3_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA3", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 35000
ginmax = 40000
suppressMessages(print(hist_cors_by_gen_col_rep(GA3_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA3", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 40000
ginmax = 45000
suppressMessages(print(hist_cors_by_gen_col_rep(GA3_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA3", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 45000
ginmax = 50000
suppressMessages(print(hist_cors_by_gen_col_rep(GA3_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA3", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

```


## Correlation across time


```{r, GA3 cor and pheno, results="hide"}
GA3_pattern <- unique(paste0(GA3_tall_tall_file$snake_mu_rate, "_", GA3_tall_tall_file$snake_mu_effect_sd,"_",GA3_tall_tall_file$newt_mu_rate, "_", GA3_tall_tall_file$newt_mu_effect_sd, "_", GA3_tall_tall_file$rep))


for(i in 1:length(GA3_pattern)){
  myine<-cor_trends_by_gen(GA3_tall_tall_file, GA3_cor_tall_file, "test", "GA3", "newt/snake GAs&rep","other", "Cor", min_gen=100, max_gen=50000, pattern=GA3_pattern[i])
  plot(myine)
}

```


## What happens over time (looking at the beginning. middle, and late part of my simulations)


```{r, early plots}


min_gen=100
max_gen=5000


for(i in 1:length(unique(GA3_tall_tall_file$rep))){
  myine<-whale_gen(GA3_tall_tall_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA3_tall_tall_file$rep)[i])
  plot(myine)
  myine<-two_hist(GA3_tall_tall_file, title="Snake-Newt Winning Hist", subt="Gen 16sims", y_label="Count", x_label="Snake-Newt Phenotype (purple) & Snake-Newt Popsize/100 (green)",  min_gen=min_gen, max_gen=max_gen, rep=unique(GA3_tall_tall_file$rep)[i] )
  suppressMessages(plot(myine))
}

```




#### Summary

```{r, early plots summary}

min_gen=100
max_gen=5000

# summary
GA_summary(GA3_tall_tall_file, min_gen=min_gen, max_gen=max_gen, x_line="Newt_pop_size", y_line="Snake_pop_size", title="Space: Newt VS Snake Population Size", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize")

min_gen=10000
max_gen=15000

# summary
GA_summary(GA3_tall_tall_file, min_gen=min_gen, max_gen=max_gen, x_line="Newt_pop_size", y_line="Snake_pop_size", title="Space: Newt VS Snake Population Size", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize")

min_gen=45000
max_gen=50000

# summary
GA_summary(GA3_tall_tall_file, min_gen=min_gen, max_gen=max_gen, x_line="Newt_pop_size", y_line="Snake_pop_size", title="Space: Newt VS Snake Population Size", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize")

min_gen=100
max_gen=5000

GA_summary(GA3_tall_tall_file, min_gen=min_gen, max_gen=max_gen, x_line="dif", y_line="Snake_pop_size", title="Space: Dif VS Snake Population Size", subt="Gen 16sims", y_label="Snake Popsize", x_label="Dif")

min_gen=10000
max_gen=15000


GA_summary(GA3_tall_tall_file, min_gen=min_gen, max_gen=max_gen, x_line="dif", y_line="Snake_pop_size", title="Space: Dif VS Snake Population Size", subt="Gen 16sims", y_label="Snake Popsize", x_label="Dif")

min_gen=45000
max_gen=50000

GA_summary(GA3_tall_tall_file, min_gen=min_gen, max_gen=max_gen, x_line="dif", y_line="Snake_pop_size", title="Space: Dif VS Snake Population Size", subt="Gen 16sims", y_label="Snake Popsize", x_label="Dif")


```


```{r, early plots Heatmap}

min_gen=100
max_gen=5000
#heatmap
build_heatmap(GA3_tall_tall_file, min_gen=min_gen, max_gen=max_gen, fill_line="Snake_pop_size", fill_line_text="Snake Population Size", title="Newt GA by Snake GA", subt="16 Sim Heatmap", y_label="Snake GA", x_label="Newt GA", red_blue=F)

min_gen=10000
max_gen=15000
#heatmap
build_heatmap(GA3_tall_tall_file, min_gen=min_gen, max_gen=max_gen, fill_line="Snake_pop_size", fill_line_text="Snake Population Size", title="Newt GA by Snake GA", subt="16 Sim Heatmap", y_label="Snake GA", x_label="Newt GA", red_blue=F)


min_gen=45000
max_gen=50000
#heatmap
build_heatmap(GA3_tall_tall_file, min_gen=min_gen, max_gen=max_gen, fill_line="Snake_pop_size", fill_line_text="Snake Population Size", title="Newt GA by Snake GA", subt="16 Sim Heatmap", y_label="Snake GA", x_label="Newt GA", red_blue=F)

min_gen=100
max_gen=5000
build_heatmap(GA3_tall_tall_file, min_gen=min_gen, max_gen=max_gen, fill_line="dif", fill_line_text="Snake-Newt", title="Newt GA by Snake GA", subt="16 Sim Heatmap", y_label="Snake GA", x_label="Newt GA",red_blue=T)


min_gen=10000
max_gen=15000
#heatmap

build_heatmap(GA3_tall_tall_file, min_gen=min_gen, max_gen=max_gen, fill_line="dif", fill_line_text="Snake-Newt", title="Newt GA by Snake GA", subt="16 Sim Heatmap", y_label="Snake GA", x_label="Newt GA",red_blue=T)

min_gen=45000
max_gen=50000
#heatmap

build_heatmap(GA3_tall_tall_file, min_gen=min_gen, max_gen=max_gen, fill_line="dif", fill_line_text="Snake-Newt", title="Newt GA by Snake GA", subt="16 Sim Heatmap", y_label="Snake GA", x_label="Newt GA",red_blue=T)

```


## What is up with the correlations


### file


```{r, cor grid by location 1}

#GA3_grid_tall_file


file_name= "Snake_1e-11_0.158_Newt_1e-10_0.05_0"

#Snake_1.0e-08_0.005_Newt_1.0e-11_0.158_0

spegen=20001
#unique(GA3_grid_tall_file$snake_newt_rep)
GA3<-GA3_GA3_grid_tall_file[which(GA3_GA3_grid_tall_file$snake_newt_rep==file_name & GA3_GA3_grid_tall_file$generation==spegen),]

GA3_mean = GA3[,grepl("generation|mean", names(GA3)) ]

GA3_data_long_mean <- gather(GA3_mean, condition, measurement, newt_mean_pheno_0:snake_mean_pheno_99, factor_key=TRUE)

GA3_data_long_mean[,c("species","type", "type2","location")]<- str_split_fixed(GA3_data_long_mean$condition, "_", 4)

GA3_data_long_mean_short<-GA3_data_long_mean

GA3_data_long_mean_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
GA3_data_long_mean_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))


main_plot<-ggplot(GA3_data_long_mean_short)+
  labs(title = "Mean Phenotype of Locations",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Toxicity/Resistance")+
  geom_point(data = GA3_data_long_mean_short[which(GA3_data_long_mean_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = GA3_data_long_mean_short[which(GA3_data_long_mean_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c()+
  theme_bw()+
  theme(legend.justification = "top")

snake<-GA3_data_long_mean_short[which(GA3_data_long_mean_short$species=="snake"),]
newt_GA3<-GA3_data_long_mean_short[which(GA3_data_long_mean_short$species=="newt"),]
newt_GA3$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt_GA3$measurement), use="complete.obs")



newt_GA3$info[newt_GA3$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt_GA3$info[newt_GA3$location %in% list(0, 19, 80, 99)] <- "corner"
newt_GA3$info[is.na(newt_GA3$info)]<- "middle"

extra_plot <- ggplot(newt_GA3)+
  ggtitle("Mean Phenotype") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)

    
```

### file


```{r, cor grid by location 2}

#GA3_grid_tall_file


file_name= "Snake_1e-08_0.005_Newt_1e-11_0.158_0"
#Snake_1.0e-08_0.005_Newt_1.0e-11_0.158_0

spegen=30001
#unique(GA3_grid_tall_file$snake_newt_rep)
GA3<-GA3_GA3_grid_tall_file[which(GA3_GA3_grid_tall_file$snake_newt_rep==file_name & GA3_GA3_grid_tall_file$generation==spegen),]
GA3<-GA3[1,]
GA3_mean = GA3[,grepl("generation|mean", names(GA3)) ]

GA3_data_long_mean <- gather(GA3_mean, condition, measurement, newt_mean_pheno_0:snake_mean_pheno_99, factor_key=TRUE)

GA3_data_long_mean[,c("species","type", "type2","location")]<- str_split_fixed(GA3_data_long_mean$condition, "_", 4)

GA3_data_long_mean_short<-GA3_data_long_mean

GA3_data_long_mean_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
GA3_data_long_mean_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))


main_plot<-ggplot(GA3_data_long_mean_short)+
  labs(title = "Mean Phenotype of Locations",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Toxicity/Resistance")+
  geom_point(data = GA3_data_long_mean_short[which(GA3_data_long_mean_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = GA3_data_long_mean_short[which(GA3_data_long_mean_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c()+
  theme_bw()+
  theme(legend.justification = "top")

snake<-GA3_data_long_mean_short[which(GA3_data_long_mean_short$species=="snake"),]
newt_GA3<-GA3_data_long_mean_short[which(GA3_data_long_mean_short$species=="newt"),]
newt_GA3$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt_GA3$measurement), use="complete.obs")



newt_GA3$info[newt_GA3$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt_GA3$info[newt_GA3$location %in% list(0, 19, 80, 99)] <- "corner"
newt_GA3$info[is.na(newt_GA3$info)]<- "middle"

extra_plot <- ggplot(newt_GA3)+
  ggtitle("Mean Phenotype") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)

    
```



```{r, cor grid by location 3}

#GA3_grid_tall_file


file_name= "Snake_1e-10_0.05_Newt_1e-11_0.158_3"
#Snake_1.0e-08_0.005_Newt_1.0e-11_0.158_0

spegen=14001
#unique(GA3_grid_tall_file$snake_newt_rep)
GA3<-GA3_GA3_grid_tall_file[which(GA3_GA3_grid_tall_file$snake_newt_rep==file_name & GA3_GA3_grid_tall_file$generation==spegen),]

GA3_mean = GA3[,grepl("generation|mean", names(GA3)) ]

GA3_data_long_mean <- gather(GA3_mean, condition, measurement, newt_mean_pheno_0:snake_mean_pheno_99, factor_key=TRUE)

GA3_data_long_mean[,c("species","type", "type2","location")]<- str_split_fixed(GA3_data_long_mean$condition, "_", 4)

GA3_data_long_mean_short<-GA3_data_long_mean

GA3_data_long_mean_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
GA3_data_long_mean_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))


main_plot<-ggplot(GA3_data_long_mean_short)+
  labs(title = "Mean Phenotype of Locations",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Toxicity/Resistance")+
  geom_point(data = GA3_data_long_mean_short[which(GA3_data_long_mean_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = GA3_data_long_mean_short[which(GA3_data_long_mean_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c()+
  theme_bw()+
  theme(legend.justification = "top")

snake<-GA3_data_long_mean_short[which(GA3_data_long_mean_short$species=="snake"),]
newt_GA3<-GA3_data_long_mean_short[which(GA3_data_long_mean_short$species=="newt"),]
newt_GA3$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt_GA3$measurement), use="complete.obs")



newt_GA3$info[newt_GA3$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt_GA3$info[newt_GA3$location %in% list(0, 19, 80, 99)] <- "corner"
newt_GA3$info[is.na(newt_GA3$info)]<- "middle"

extra_plot <- ggplot(newt_GA3)+
  ggtitle("Mean Phenotype") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)

    
```



```{r, cor grid by location 4}

#GA3_grid_tall_file
file_name= "Snake_1e-08_0.005_Newt_1e-08_0.005_0"
#Snake_1.0e-08_0.005_Newt_1.0e-11_0.158_0

spegen=15001
#unique(GA3_grid_tall_file$snake_newt_rep)
GA3<-GA3_GA3_grid_tall_file[which(GA3_GA3_grid_tall_file$snake_newt_rep==file_name & GA3_GA3_grid_tall_file$generation==spegen),]
GA3<-GA3[1,]
GA3_mean = GA3[,grepl("generation|mean", names(GA3)) ]

GA3_data_long_mean <- gather(GA3_mean, condition, measurement, newt_mean_pheno_0:snake_mean_pheno_99, factor_key=TRUE)

GA3_data_long_mean[,c("species","type", "type2","location")]<- str_split_fixed(GA3_data_long_mean$condition, "_", 4)

GA3_data_long_mean_short<-GA3_data_long_mean

GA3_data_long_mean_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
GA3_data_long_mean_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))


main_plot<-ggplot(GA3_data_long_mean_short)+
  labs(title = "Mean Phenotype of Locations",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Toxicity/Resistance")+
  geom_point(data = GA3_data_long_mean_short[which(GA3_data_long_mean_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = GA3_data_long_mean_short[which(GA3_data_long_mean_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c()+
  theme_bw()+
  theme(legend.justification = "top")

snake<-GA3_data_long_mean_short[which(GA3_data_long_mean_short$species=="snake"),]
newt_GA3<-GA3_data_long_mean_short[which(GA3_data_long_mean_short$species=="newt"),]
newt_GA3$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt_GA3$measurement), use="complete.obs")



newt_GA3$info[newt_GA3$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt_GA3$info[newt_GA3$location %in% list(0, 19, 80, 99)] <- "corner"
newt_GA3$info[is.na(newt_GA3$info)]<- "middle"

extra_plot <- ggplot(newt_GA3)+
  ggtitle("Mean Phenotype") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)


#spegen=30001
#unique(GA3_grid_tall_file$snake_newt_rep)
GA3<-GA3_GA3_grid_tall_file[which(GA3_GA3_grid_tall_file$snake_newt_rep==file_name & GA3_GA3_grid_tall_file$generation==spegen),]
GA3<-GA3[1,]
GA3_ind = GA3[,grepl("generation|num_ind", names(GA3)) ]

GA3_data_long_ind <- gather(GA3_ind, condition, measurement, newt_num_ind_0:snake_num_ind_99, factor_key=TRUE)

GA3_data_long_ind[,c("species","type", "type2","location")]<- str_split_fixed(GA3_data_long_ind$condition, "_", 4)

GA3_data_long_ind_short<-GA3_data_long_ind

GA3_data_long_ind_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
GA3_data_long_ind_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))

GA3_data_long_ind_short$measurement[GA3_data_long_ind_short$measurement == 0]  <- NA

main_plot<-ggplot(GA3_data_long_ind_short)+
  labs(title = "Locations of Ind",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Number of Individuals")+
  geom_point(data = GA3_data_long_ind_short[which(GA3_data_long_ind_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = GA3_data_long_ind_short[which(GA3_data_long_ind_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c(option = "plasma")+
  theme_bw()+
  theme(legend.justification = "top")

snake<-GA3_data_long_ind_short[which(GA3_data_long_ind_short$species=="snake"),]
newt_GA3<-GA3_data_long_ind_short[which(GA3_data_long_ind_short$species=="newt"),]
newt_GA3$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt_GA3$measurement), use="complete.obs")



newt_GA3$info[newt_GA3$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt_GA3$info[newt_GA3$location %in% list(0, 19, 80, 99)] <- "corner"
newt_GA3$info[is.na(newt_GA3$info)]<- "middle"

extra_plot <- ggplot(newt_GA3)+
  ggtitle("Num of Ind") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)

    
```


```{r, cor grid by location 5}

#GA3_grid_tall_file


file_name= "Snake_1e-10_0.05_Newt_1e-09_0.0158_1"

#Snake_1.0e-08_0.005_Newt_1.0e-11_0.158_0

#Snake_1.0e-08_0.005_Newt_1.0e-11_0.158_0

spegen=49991
#spegen=30001
#unique(GA3_grid_tall_file$snake_newt_rep)
GA3<-GA3_GA3_grid_tall_file[which(GA3_GA3_grid_tall_file$snake_newt_rep==file_name & GA3_GA3_grid_tall_file$generation==spegen),]

GA3_ind = GA3[,grepl("generation|num_ind", names(GA3)) ]

GA3_data_long_ind <- gather(GA3_ind, condition, measurement, newt_num_ind_0:snake_num_ind_99, factor_key=TRUE)

GA3_data_long_ind[,c("species","type", "type2","location")]<- str_split_fixed(GA3_data_long_ind$condition, "_", 4)

GA3_data_long_ind_short<-GA3_data_long_ind

GA3_data_long_ind_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
GA3_data_long_ind_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))

GA3_data_long_ind_short$measurement[GA3_data_long_ind_short$measurement == 0]  <- NA

main_plot<-ggplot(GA3_data_long_ind_short)+
  labs(title = "Locations of Ind",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Number of Individuals")+
  geom_point(data = GA3_data_long_ind_short[which(GA3_data_long_ind_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = GA3_data_long_ind_short[which(GA3_data_long_ind_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c(option = "plasma")+
  theme_bw()+
  theme(legend.justification = "top")

snake<-GA3_data_long_ind_short[which(GA3_data_long_ind_short$species=="snake"),]
newt_GA3<-GA3_data_long_ind_short[which(GA3_data_long_ind_short$species=="newt"),]
newt_GA3$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt_GA3$measurement), use="complete.obs")



newt_GA3$info[newt_GA3$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt_GA3$info[newt_GA3$location %in% list(0, 19, 80, 99)] <- "corner"
newt_GA3$info[is.na(newt_GA3$info)]<- "middle"

extra_plot <- ggplot(newt_GA3)+
  ggtitle("Num of Ind") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)

    
```