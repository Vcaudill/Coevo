---
title: "Different Interaction Rates"
output: html_document
date: '2022-10-17'
---

```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE,echo = FALSE) 

library(ggplot2)
library(viridis)
library(colorspace)
library(gridExtra)
library(tidyverse)
require(reshape2)
library(plyr)
library(gridGraphics)
library(grid)
library(knitr)
library(kableExtra)
library("reshape")
library(ggplot2)
library(ggpubr)
theme_set(theme_pubr())
library(stringr)
library(patchwork)
```

## Goal:

Think, explore, & write about what the co-evolutionary interaction between newts & snakes with different genetic architectures (GAs, combination of mutation rate & mutation effect size). This markdown is investigating what happens to the newt and snake population when I increase the interaction rate.

### Questions:
How does changing the interaction rate affect the survival of the newt or snake population? Is there a change in the spatial phenotype correlation? Does the interaction rate lead to different phenotype outcome (typical interaction rate is 0.05)? What does changing the interaction rate mean in order of how many snakes encounter a newt in their lifetime?

## Experiment

I created a simulation study to observe the co-evolutionary outcome of the newt-snake interaction with different genetic architectures (GAs) in a spatial setting. I hypothesized that we would see an interaction (co-evolutionary arms race) between newt and snake phenotype under some GA combinations when newts and snakes were evolving over geographical space. Each GA is paired with another GA creating 16 combinations.

GA1 experiment values:

- 1e-8*(0.005)^2 = 2.5e-13
- 1e-9*(0.05)^2 = 2.5e-12
- 1e-10*(0.5)^2 = 2.5e-11
- 1e-11*(5.0)^2 = 2.5e-10

Landscape: A tall map!: 35*4 H, 35 W 

I tested different interaction rates:

  - 0.01 lowest amount of interaction
  - 0.025
  - 0.05
  - 0.075
  - 0.10
  - 0.125
  - 0.15
  - 0.20
  - 0.25
  - 0.30
  - 0.35 highest amount of interaction
  
Each GA combination, trial, and interaction rate has its own msprime simulation.

Sometimes a higher interaction rate will lead to a species extinction, so ending values are approximate 



```{bash, data file gathering}
#!/usr/bin/env bash

# Run these commands while in The the folder that contains the file you would like to condence
# Goal is to condense all the text files into one file 
# Requirements: need to have the same name and need to add additional columns
thepath=/Users/victoria/Desktop/
foldername=interaction_rate
thefolder=${thepath}${foldername}/*

add_in_column=",rep,snake_mu_rate,snake_mu_effect_sd,newt_mu_rate,newt_mu_effect_sd,interrate"

lit_head_file=$(find ${thepath}${foldername} -name "*_lit_*" | head -n 1)
lit_head=$(head -n 1 "${lit_head_file}")

cor_head_file=$(find ${thepath}${foldername} -name "*_cor_*" | head -n 1)
cor_head=$(head -n 1 "${cor_head_file}")

grid_head_file=$(find ${thepath}${foldername} -name "*_grid_*" | head -n 1)
grid_head=$(head -n 1 "${grid_head_file}")

if [[ -f ${thepath}${foldername}/all_lit.txt ]] && [[ -f ${thepath}${foldername}/all_grid.txt ]] && [[ -f ${thepath}${foldername}/all_cor.txt ]]
then
  echo "All cor, lit, and grid files exist!"
  echo "This program will now end!"
  exit 0
fi

#creating the files
echo ${lit_head}${add_in_column} > ${thepath}${foldername}/all_lit.txt
echo ${interrate_head}${add_in_column} > ${thepath}${foldername}/all_grid.txt
echo ${cor_head}${add_in_column} > ${thepath}${foldername}/all_cor.txt


for filename in $thefolder*.text;
  do 
#getting the variables 

my_type=$(echo ${filename} |sed 's/.*GA205_//; s/_.*//')
snake_mu_rate=$(echo ${filename} |sed 's/.*snake_mu_rate_//; s/_.*//')
snake_mu_effect_sd=$(echo ${filename} |sed 's/.*snake_mu_effect_sd_//; s/_.*//')
newt_mu_rate=$(echo ${filename} |sed 's/.*newt_mu_rate_//; s/_.*//')
newt_mu_effect_sd=$(echo ${filename} |sed 's/.*newt_mu_effect_sd_//; s/_.*//')
interrate=$(echo ${filename} |sed 's/.*_interaction_rate_//; s/_.*//')
rep=$(echo ${filename} | sed "s/.*rep_//; s/_.*//")
#echo ${newt_mu_rate}	
# echo $my_type
# echo $my_other_type
# these new columns adding them to the data
sed -i '' -e 's/$/,'${rep}'/' $filename
sed -i '' -e 's/$/,'${snake_mu_rate}'/' $filename
sed -i '' -e 's/$/,'${snake_mu_effect_sd}'/' $filename
sed -i '' -e 's/$/,'${newt_mu_rate}'/' $filename
sed -i '' -e 's/$/,'${newt_mu_effect_sd}'/' $filename
sed -i '' -e 's/$/,'${interrate}'/' $filename
#infile >outfile
if [[ $my_type == "lit" ]]
then
    tail -n +2 -q $filename >> ${thepath}${foldername}/all_lit.txt
fi

if [[ $my_type == "grid" ]]
then
    tail -n +2 -q $filename >> ${thepath}${foldername}/all_grid.txt
fi

if [[ $my_type == "cor" ]]
then
    tail -n +2 -q $filename >> ${thepath}${foldername}/all_cor.txt
fi

done

```


```{r, read in the files}
snewt <- read.csv("~/Desktop/snake_newt_real_data.csv", header = TRUE)

GA1_lit_interrate_file<- read.csv("~/Desktop/interaction_rate/all_lit.txt" , header = TRUE)
GA1_lit_interrate_file$group_rep <- paste0(GA1_lit_interrate_file$snake_mu_rate, "_", GA1_lit_interrate_file$snake_mu_effect_sd,"_",GA1_lit_interrate_file$newt_mu_rate, "_", GA1_lit_interrate_file$newt_mu_effect_sd, "_", GA1_lit_interrate_file$rep)
GA1_lit_interrate_file$group <- paste0(GA1_lit_interrate_file$snake_mu_rate, "_", GA1_lit_interrate_file$snake_mu_effect_sd,"_",GA1_lit_interrate_file$newt_mu_rate, "_", GA1_lit_interrate_file$newt_mu_effect_sd)
GA1_lit_interrate_file$sim=LETTERS[factor(GA1_lit_interrate_file$group)]
GA1_lit_interrate_file$dif=as.numeric(GA1_lit_interrate_file$Snake_mean_Pheno)-as.numeric(GA1_lit_interrate_file$Newt_mean_Pheno)

GA1_lit_interrate_file$Snake_mean_Pheno<-as.numeric(GA1_lit_interrate_file$Snake_mean_Pheno)
GA1_lit_interrate_file$generation<-as.numeric(GA1_lit_interrate_file$generation)
GA1_lit_interrate_file$Newt_mean_Pheno<-as.numeric(GA1_lit_interrate_file$Newt_mean_Pheno)

GA1_cor_interrate_file<- read.csv("~/Desktop/interaction_rate/all_cor.txt" , header = TRUE)
GA1_cor_interrate_file$group_rep <- paste0(GA1_cor_interrate_file$snake_mu_rate, "_", GA1_cor_interrate_file$snake_mu_effect_sd,"_",GA1_cor_interrate_file$newt_mu_rate, "_", GA1_cor_interrate_file$newt_mu_effect_sd, "_", GA1_cor_interrate_file$rep)
GA1_cor_interrate_file$group <- paste0(GA1_cor_interrate_file$snake_mu_rate, "_", GA1_cor_interrate_file$snake_mu_effect_sd,"_",GA1_cor_interrate_file$newt_mu_rate, "_", GA1_cor_interrate_file$newt_mu_effect_sd)
GA1_cor_interrate_file$sim=LETTERS[factor(GA1_cor_interrate_file$group)]

#had an odd thing happen on the cluster that was adding reps to my data (I  ignore these other values)
#unique(GA1_lit_interrate_file$rep)

GA1_lit_interrate_file <- GA1_lit_interrate_file[which(GA1_lit_interrate_file$rep==0),]
GA1_cor_interrate_file <- GA1_cor_interrate_file[which(GA1_cor_interrate_file$rep==0),]

```

```{r, cor box set up}

boxplot_cors_by_gen <- function(file, title, subt, x_label, y_label, min_gen, max_gen){
 snewt$mean_res = snewt$mean_toxin+snewt$dif
  real_snewt_cor = cor(snewt$mean_toxin, snewt$mean_res)
  file$snake_newt <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  #unique(file$sim)
  plot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen),]) +
  ylim(-1.1, 1.1)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_boxplot(aes(x=factor(interrate), y=as.numeric(mean_newt_pheno_By_mean_snake_pheno), color = factor(interrate)))+
  geom_hline(yintercept=real_snewt_cor, linetype="dashed")+
    geom_hline(yintercept=0, linetype="solid")+
  #geom_boxplot(aes(x=factor("CB"), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  #geom_boxplot(aes(x=factor("CC"), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  #geom_boxplot(aes(x=factor("CD"), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  theme(plot.title = element_text(size=5)) +
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())


  return(plot)
}

boxplot_cor_grid_by_gen <- function(file, title, subt, x_label, y_label, min_gen, max_gen){
 snewt$mean_res = snewt$mean_toxin+snewt$dif
  real_snewt_cor = cor(snewt$mean_toxin, snewt$mean_res)
  file$snake_newt <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  unique(file$sim)
  plot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen),]) +
  ylim(-1.1, 1.1)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_boxplot(aes(x=factor(grid_num), y=as.numeric(mean_newt_pheno_By_mean_snake_pheno), color = factor(grid_num)))+
  geom_hline(yintercept=real_snewt_cor, linetype="dashed")+
    geom_hline(yintercept=0, linetype="solid")+
  #geom_boxplot(aes(x=factor("CB"), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  #geom_boxplot(aes(x=factor("CC"), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  #geom_boxplot(aes(x=factor("CD"), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  theme(plot.title = element_text(size=5)) +
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())


  return(plot)
}


hist_cors_by_gen_col_rep <- function(file, title, subt, x_label, y_label, min_gen, max_gen){
 snewt$mean_res = snewt$mean_toxin+snewt$dif
  real_snewt_cor = cor(snewt$mean_toxin, snewt$mean_res)
   file$snake_newt <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  #unique(file$sim)
  plot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen),]) +
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=as.numeric(mean_newt_pheno_By_mean_snake_pheno),fill=factor(rep)))+
  geom_vline(xintercept=real_snewt_cor, linetype="dashed")+
  geom_vline(xintercept=0, linetype="solid")+
  #geom_boxplot(aes(x=factor("CB"), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  #geom_boxplot(aes(x=factor("CC"), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  #geom_boxplot(aes(x=factor("CD"), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  theme(plot.title = element_text(size=5)) +
  xlim(-1.1, 1.1)+
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())


  return(plot)
}

hist_cors_by_gen_col_rep_nofill <- function(file, title, subt, x_label, y_label, min_gen, max_gen){
 snewt$mean_res = snewt$mean_toxin+snewt$dif
  real_snewt_cor = cor(snewt$mean_toxin, snewt$mean_res)
  file$snake_newt <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  unique(file$sim)
  plot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen),]) +
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=as.numeric(mean_newt_pheno_By_mean_snake_pheno)))+
  geom_vline(xintercept=real_snewt_cor, linetype="dashed")+
  geom_vline(xintercept=0, linetype="solid")+
  #geom_boxplot(aes(x=factor("CB"), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  #geom_boxplot(aes(x=factor("CC"), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  #geom_boxplot(aes(x=factor("CD"), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  theme(plot.title = element_text(size=5)) +
  #stat_bin(bins=30)+
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())

suppressMessages(print(plot))

  return(plot)
}


var_cor <- function(file, cfile, title, subt, x_label, y_label, min_gen, max_gen){
  real_snewt_cor = cor(snewt$mean_toxin, snewt$mean_res)
  real_snewt_var = var(snewt$dif)
  var_cor_table=data.frame()

  
  for(i in 1:length(unique(file$snake_newt_rep))){
    pattern<-unique(file$snake_newt_rep)[i]
    temp_file<-file[which(file$gen>=min_gen & file$gen<=max_gen & file$snake_newt_rep==pattern),]
    temp_cor_file<-cfile[which(cfile$gen>=min_gen & cfile$gen<=max_gen & cfile$snake_newt_rep==pattern),]
    
    var_cor_table_temp<- data.frame("pattern"=pattern, "var"= var(temp_file$dif),"cor" = cor(temp_file$newt_toxin, temp_file$snake_res), "mean_corr" = mean(temp_cor_file$mean_newt_pheno_By_mean_snake_pheno))
    var_cor_table <- rbind(var_cor_table, var_cor_table_temp)
  }
 
  var_cor_table_temp<- data.frame("pattern"="real", "var"= real_snewt_var, "cor" = real_snewt_cor, "mean_corr" = real_snewt_cor)
  var_cor_table <- rbind(var_cor_table, var_cor_table_temp)
  
  plot <- ggplot(var_cor_table) +
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_point(aes(x=as.numeric(var), y=as.numeric(cor), color = pattern), shape=17, size=3)+
  geom_point(aes(x=as.numeric(var), y=as.numeric(mean_corr), color = pattern), size=3)+
  theme(plot.title = element_text(size=5)) +
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8))


  return(plot)
}



cor_trends_by_gen <- function(file, cfile, title, subt, x_label, x_label_cor, y_label, min_gen, max_gen, pattern,interrate_cap){
#file=GA1_lit_interrate_file
#cfile=GA1_cor_interrate_file 
 # pattern="1e-11_5_1e-11_5_0"
 # pattern="1e-11_5_1e-11_5_0"  
 file$snake_newt_rep <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd,"_", file$rep)
  cfile$snake_newt_rep <- paste0(cfile$snake_mu_rate, "_", cfile$snake_mu_effect_sd, "_", cfile$newt_mu_rate, "_", cfile$newt_mu_effect_sd, "_", cfile$rep)
  last_point <- file %>% group_by(group_rate) %>% slice_max(generation, with_ties = FALSE)
  lp_trial = last_point[which(last_point$snake_newt_rep==pattern &last_point$interrate<=interrate_cap),]
  
  plot_1 <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen & file$snake_newt_rep==pattern & file$interrate<=interrate_cap),]) +
    
    #geom_line(aes(generation, dif, group=rep, col="dif"))+
    ggtitle(title, subtitle = paste0(subt," pattern ", pattern, " From ", min_gen, " gen to ", max_gen, " gen"))+
    geom_line(aes(generation, Snake_mean_Pheno, group=interrate, color="Snake_mean_Pheno"),)+
    geom_line(aes(generation, Newt_mean_Pheno, group=interrate, color="Newt_mean_Pheno"))+
    geom_point(data=lp_trial, aes(generation, Snake_mean_Pheno, color="Snake_mean_Pheno", shape=factor(interrate)),size = 3)+ 

    geom_point(data=lp_trial, aes(generation, Newt_mean_Pheno, color="Newt_mean_Pheno", shape=factor(interrate)),size = 3)+ 
    #ylim(0,10)+
    #xlab(x_label) + ylab(y_label)+
    scale_color_manual(name = "Type",
values = c( "Snake_mean_Pheno" = "steelblue", "Newt_mean_Pheno" = "darkred"),
labels = c("Snake", "Newt"))+
    theme_bw() +theme(strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank(), axis.ticks.x = element_blank(), axis.text.x = element_blank(),
                      plot.margin=unit(c(1,1,+0.3,1), "cm"))
cor_plot <- ggplot(cfile[which(cfile$gen>=min_gen & cfile$gen<=max_gen & cfile$snake_newt_rep==pattern & file$interrate<=interrate_cap),]) +
    geom_line(aes(generation, mean_newt_pheno_By_mean_snake_pheno, col=factor(interrate)))+
    #ggtitle(title, subtitle = subt) +
    ylim(-1.1, 1.1)+
    #xlab(x_label_cor) + ylab(y_label)+
    theme_bw() +theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank(),
                      plot.margin=unit(c(-0.5,1,1,1), "cm"))
  
  figure <- ggarrange(plot_1, cor_plot + font("x.text", size = 10),heights = c(2, 1.5),ncol = 1, nrow = 2, align = "v")

  return(figure)
}


pop_size_trends_by_gen <- function(file, cfile, title, subt, x_label, x_label_cor, y_label, min_gen, max_gen, pattern, interrate_cap){
#file=GA1_lit_interrate_file
#cfile=GA1_cor_interrate_file 
 # pattern="1e-11_5_1e-11_5_0"
 # pattern="1e-11_5_1e-11_5_0"  
 file$snake_newt_rep <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd,"_", file$rep)
  cfile$snake_newt_rep <- paste0(cfile$snake_mu_rate, "_", cfile$snake_mu_effect_sd, "_", cfile$newt_mu_rate, "_", cfile$newt_mu_effect_sd, "_", cfile$rep)
  
  last_point <- file %>% group_by(group_rate) %>% slice_max(generation, with_ties = FALSE)
  lp_trial = last_point[which(last_point$snake_newt_rep==pattern &last_point$interrate<=interrate_cap),]
  
  
  plot_1 <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen & file$snake_newt_rep==pattern & file$interrate<=interrate_cap),]) +
    #geom_line(aes(generation, dif, group=rep, col="dif"))+
    ggtitle(title, subtitle = paste0(subt," pattern ", pattern, " From ", min_gen, " gen to ", max_gen, " gen"))+
    geom_line(aes(generation, Snake_pop_size, group=interrate, color="Snake"),)+
    geom_line(aes(generation, Newt_pop_size, group=interrate, color="Newt"))+
    
    geom_point(data=lp_trial, aes(generation, Snake_pop_size, color="Snake", shape=factor(interrate)),size = 3)+ 

    geom_point(data=lp_trial, aes(generation, Newt_pop_size, color="Newt", shape=factor(interrate)),size = 3)+ 
    #ylim(0,10)+
    #xlab(x_label) + ylab(y_label)+
    scale_color_manual(name = "Type",
values = c( "Snake" = "steelblue", "Newt" = "darkred"),
labels = c("Snake", "Newt"))+
    theme_bw() +theme(strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank(), axis.ticks.x = element_blank(), axis.text.x = element_blank(),
                      plot.margin=unit(c(1,1,+0.3,1), "cm"))
cor_plot <- ggplot(cfile[which(cfile$gen>=min_gen & cfile$gen<=max_gen & cfile$snake_newt_rep==pattern & file$interrate<=interrate_cap),]) +
    geom_line(aes(generation, num_newts_By_num_snakes, col=factor(interrate)))+
    #ggtitle(title, subtitle = subt) +
    ylim(-1.1, 1.1)+
    #xlab(x_label_cor) + ylab(y_label)+
    theme_bw() +theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8),
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank(),
                      plot.margin=unit(c(-0.5,1,1,1), "cm"))
  
  figure <- ggarrange(plot_1, cor_plot + font("x.text", size = 10),heights = c(2, 1.5),ncol = 1, nrow = 2, align = "v")

  return(figure)
}



```

```{r, general file and graph making}

#the functions to make the params file and the summary and heatmap figures 

create_parm_file <- function(file, min_gen, max_gen, interrate){
params <- data_frame()

for(i in 1:length(unique(file$snake_newt_rep))){

  pattern=unique(file$snake_newt_rep)[i]
  sumitup <- file[which(file$gen>=min_gen & file$gen<=max_gen & file$snake_newt_rep ==pattern & file$interrate==interrate),]
 
  params_temp<- data_frame(Newt_mean_Pheno=mean(sumitup$Newt_mean_Pheno),
                           Snake_mean_Pheno=mean(sumitup$Snake_mean_Pheno), 
                           Newt_mean_Pheno_sd=sd(sumitup$Newt_mean_Pheno),
                           Snake_mean_Pheno_sd=sd(sumitup$Snake_mean_Pheno),
                           Newt_pop_size=mean(sumitup$Newt_pop_size),
                           Snake_pop_size=mean(sumitup$Snake_pop_size),
                           dif=mean(sumitup$dif),
                           snake_mu_rate=sumitup$snake_mu_rate[1],
                           newt_mu_rate=sumitup$newt_mu_rate[1],
                           snake_mu_effect_sd=sumitup$snake_mu_effect_sd[1],
                           newt_mu_effect_sd=sumitup$newt_mu_effect_sd[1],
                           rep=sumitup$rep[1])
  
  
  params <- rbind(params, params_temp)
}

params$snake <- paste0(params$snake_mu_rate, "_",params$snake_mu_effect_sd)
params$newt <- paste0(params$newt_mu_rate, "_",params$newt_mu_effect_sd)
params$snake_newt <- paste0(params$snake, "_", params$newt)
return(params)
}


 create_parm_file_nc <- function(file, min_gen, max_gen){
   
   file$test_factor <- paste0(file$interrate, "_", file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd, "_", file$rep)
   
params <- data_frame()

for(i in 1:length(unique(file$test_factor))){

  pattern=unique(file$test_factor)[i]
  
  sumitup <- file[which(file$gen>=min_gen & file$gen<=max_gen & file$test_factor ==pattern),]

  params_temp<- data_frame(Newt_mean_Pheno=mean(sumitup$Newt_mean_Pheno),
                           Snake_mean_Pheno=mean(sumitup$Snake_mean_Pheno), 
                           Newt_mean_Pheno_sd=sd(sumitup$Newt_mean_Pheno),
                           Snake_mean_Pheno_sd=sd(sumitup$Snake_mean_Pheno),
                           Newt_pop_size=mean(sumitup$Newt_pop_size),
                           Snake_pop_size=mean(sumitup$Snake_pop_size),
                           dif=mean(sumitup$dif),
                           snake_mu_rate=unlist(strsplit(pattern, "_"))[2],
                           newt_mu_rate=unlist(strsplit(pattern, "_"))[4],
                           snake_mu_effect_sd=unlist(strsplit(pattern, "_"))[3],
                           newt_mu_effect_sd=unlist(strsplit(pattern, "_"))[5],
                           rep=unlist(strsplit(pattern, "_"))[6],
                           interrate=unlist(strsplit(pattern, "_"))[1],
                           test_factor=pattern)
  
  
  params <- rbind(params, params_temp)
}

params$snake <- paste0(params$snake_mu_rate, "_",params$snake_mu_effect_sd)
params$newt <- paste0(params$newt_mu_rate, "_",params$newt_mu_effect_sd)
params$snake_newt <- paste0(params$snake, "_", params$newt)
return(params)
}


GA_summary <- function(file, min_gen, max_gen, x_line, y_line, title, subt, y_label, x_label, interrate){

file$snake_newt_rep <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd, "_", file$rep)

params<-create_parm_file(file, min_gen, max_gen, interrate)

my_plot <- ggplot(params) +
  #xlim(0, 1000)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_point(aes(x=as.numeric(get(x_line)), y=as.numeric(get(y_line)), color = factor(snake), shape=factor(newt)),size=3)+
#  geom_point(aes(x=as.numeric(Newt_pop_size_20), y=as.numeric(Snake_pop_size_20), color = factor(snake), shape=factor(newt)))+
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  #facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text( hjust=1, size = 8))

return(my_plot)
}

build_heatmap <- function(file, min_gen, max_gen, fill_line, fill_line_text, title, subt, y_label, x_label, red_blue=F){

    params<-create_parm_file_nc(file, min_gen, max_gen)
  
  
 my_plot <- ggplot(params, aes(newt, paste0(snake, "_", interrate))) +    # Create heatmap with ggplot2
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_tile(aes(fill = get(fill_line)))+theme(axis.text.x = element_text(angle = 45, hjust=1, size = 10), axis.text.y = element_text(size = 10))
 
 if(red_blue==FALSE){
  my_plot<- my_plot + scale_fill_viridis_c(name = fill_line_text) + theme(legend.text=element_text(angle = 45, hjust=1, size=10))
  }
 if(red_blue==TRUE){
  my_plot<- my_plot + scale_fill_gradient2(low = "red",mid = "beige", high = "blue", name = fill_line_text) + theme(legend.text=element_text(size=5))
 }
 
  return(my_plot)
}

trends_by_gen <- function(file, title, subt, x_label, y_label, min_gen, max_gen, rep){
 file$generation<-as.numeric(file$generation)
 file$Snake_mean_Pheno<-as.numeric(file$Snake_mean_Pheno)
 file$Newt_mean_Pheno<-as.numeric(file$Newt_mean_Pheno)
 file$group_rate<- paste0(file$group, "_", file$interrate)
 
 last_point <- file %>% group_by(group_rate) %>% slice_max(generation, with_ties = FALSE)
 
 
  plot <- ggplot(file[ which(file$generation>=min_gen & file$generation<=max_gen),]) +
    facet_wrap(~sim)+
    geom_line(aes(generation, as.numeric(dif), group=interrate, col="dif"))+
    #ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
    geom_line(aes(generation, Snake_mean_Pheno, group=interrate, color="Snake_mean_Pheno"),)+
    geom_line(aes(generation, Newt_mean_Pheno, group=interrate, color="Newt_mean_Pheno"))+
    geom_point(data=last_point, aes(generation, Snake_mean_Pheno, color="Snake_mean_Pheno", shape=factor(interrate)))+ #, shape=cost, col="dif"
    geom_point(data=last_point, aes(generation, Newt_mean_Pheno, color="Newt_mean_Pheno", shape=factor(interrate)))+
    geom_hline(yintercept=0, linetype="dashed", color="gray54")+
    #ylim(-1.,2.5)+
    xlab(x_label) + ylab(y_label)+
    scale_color_manual(name = "Type",
values = c( "Snake_mean_Pheno" = "steelblue", "Newt_mean_Pheno" = "darkred", "dif" = "black"),
labels = c("Snake", "Newt", "Dif"))+
       theme_bw() + theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="right",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())
  return(plot)
}


whale_gen <- function(file, title, subt, x_label, y_label,min_gen, max_gen, rep, interrate_cap){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
dif <- ggplot(file[ which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep & file$interrate<=interrate_cap),]) +
  #xlim(0, 1000)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen, rep ",rep)) +
  xlab(x_label) + ylab(y_label)+
  geom_point(aes(x=as.numeric(Newt_pop_size), y=as.numeric(Snake_pop_size), color = dif, shape=factor(interrate)))+
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}

whale_gen_by_interrate <- function(file, title, subt, x_label, y_label,min_gen, max_gen, rep, interrate){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
dif <- ggplot(file[ which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep & file$interrate==interrate),]) +
  #xlim(0, 1000)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen, rep ",rep, " interrate ", interrate)) +
  xlab(x_label) + ylab(y_label)+
  geom_point(aes(x=as.numeric(Newt_pop_size), y=as.numeric(Snake_pop_size), color = dif))+
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}

pop_size_hist <- function(file, title, subt, x_label, y_label,min_gen, max_gen, rep){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  file<-file[ which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep),]
  themin <- min(file$Snake_pop_size-file$Newt_pop_size) 
  themax <- max(file$Snake_pop_size-file$Newt_pop_size)
  true_max <- max(abs(themin), abs(themax))
dif <- ggplot(file) +
  #xlim(0, 1000)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(Snake_pop_size-Newt_pop_size), fill="darkolivegreen4")+
  xlim((-1*themax)-5, themax+5)+
  theme(plot.title = element_text(size=5)) +
  facet_wrap(~sim)+
  geom_vline(xintercept = 0)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)
}

pheno_dif_hist <- function(file, title, subt, x_label, y_label,min_gen, max_gen, rep){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  file<-file[ which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep),]
  
  themin <- min(file$dif) 
  themax <- max(file$dif)
  true_max <- max(abs(themin), abs(themax))
dif <- ggplot(file) +
  #xlim(0, 1000)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen, rep ",rep)) +
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(dif), fill="aquamarine4")+
  xlim((-1*true_max)-1, true_max+1)+

  # y=as.numeric(Snake_pop_size-Newt_pop_size), color = snake_GA, shape = factor(newt_GA)
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  geom_vline(xintercept = 0)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}




two_hist <- function(file, title, subt, x_label, y_label,min_gen, max_gen, rep){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  
  file<-file[ which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep),]
  
  thepopmin <- min(file$Snake_pop_size-file$Newt_pop_size)/100 
  thepopmax <- max(file$Snake_pop_size-file$Newt_pop_size)/100
  thedifmin <- min(file$dif) 
  thedifmax <- max(file$dif)
  true_max <- max(abs(thepopmin), abs(thepopmax),abs(thedifmin), abs(thedifmax))

  data_points <- nrow(file[which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep &  file$snake_GA==file$snake_GA[1] &  file$newt_GA==file$newt_GA[1]),])
dif <- ggplot(file) +
  
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen, rep ",rep)) +
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=dif, y=..count../data_points), fill="#8B008B",  alpha = 0.65)+
  geom_histogram(aes(x=(Snake_pop_size-Newt_pop_size)/100, y=..count../data_points), fill="#008B00",  alpha = 0.65)+
  scale_y_continuous(labels = scales::percent)+
  xlim((-1*true_max)-1, true_max+1)+
  # y=as.numeric(Snake_pop_size-Newt_pop_size), color = snake_GA, shape = factor(newt_GA)
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  geom_vline(xintercept = 0)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}

two_hist_all_rep <- function(file, title, subt, x_label, y_label,min_gen, max_gen){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  
  file<-file[ which(file$generation>=min_gen & file$generation<=max_gen),]
  
  thepopmin <- min(file$Snake_pop_size-file$Newt_pop_size)/100 
  thepopmax <- max(file$Snake_pop_size-file$Newt_pop_size)/100
  thedifmin <- min(file$dif) 
  thedifmax <- max(file$dif)
  true_max <- max(abs(thepopmin), abs(thepopmax),abs(thedifmin), abs(thedifmax))

  data_points <- nrow(file[which(file$generation>=min_gen & file$generation<=max_gen  &  file$snake_GA==file$snake_GA[1] &  file$newt_GA==file$newt_GA[1]),])
  
dif <- ggplot(file) +
  
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=dif, y=..count../data_points), fill="#8B008B",  alpha = 0.65, bins = 20)+ #purple
  geom_histogram(aes(x=(Snake_pop_size-Newt_pop_size)/100, y=..count../data_points), fill="#008B00",  alpha = 0.65, bins = 20)+ #green
  scale_y_continuous(labels = scales::percent)+
  xlim((-1*true_max)-1, true_max+1)+
  # y=as.numeric(Snake_pop_size-Newt_pop_size), color = snake_GA, shape = factor(newt_GA)
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  geom_vline(xintercept = 0)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      #strip.background = element_blank(), 
                      strip.text.x = element_blank(), 
                      #panel.grid.major = element_blank(), 
                      #panel.grid.minor = element_blank(),
                      #panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}

two_hist_death_all_rep <- function(file, title, subt, x_label, y_label,min_gen, max_gen){
  #file=GA1_lit_interrate_file
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  
  file<-file[ which(file$generation>=min_gen & file$generation<=max_gen),]
  
  thepopmin <- min(file$newt_deaths)
  thepopmax <- max(file$newt_deaths)
  thedifmin <- min(file$snake_deaths) 
  thedifmax <- max(file$snake_deaths)
  true_max <- max(abs(thepopmin), abs(thepopmax),abs(thedifmin), abs(thedifmax))

  data_points <- nrow(file[which(file$generation>=min_gen & file$generation<=max_gen  &  file$snake_GA==file$snake_GA[1] &  file$newt_GA==file$newt_GA[1]),])
  
dif <- ggplot(file) +
  
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=newt_deaths), fill="red",  alpha = 0.65, bins = 20)+
  geom_histogram(aes(x=snake_deaths), fill="blue",  alpha = 0.65, bins = 20)+
  #scale_y_continuous(labels = scales::percent)+
  #xlim((-1*true_max)-1, true_max+1)+
  # y=as.numeric(Snake_pop_size-Newt_pop_size), color = snake_GA, shape = factor(newt_GA)
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  #geom_vline(xintercept = 0)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      #strip.background = element_blank(), 
                      strip.text.x = element_blank(), 
                      #panel.grid.major = element_blank(), 
                      #panel.grid.minor = element_blank(),
                      #panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}

grid_plot<- function(file_name, spegen, file, type, row_num, col_num, interrate){

file$snake_newt_rep <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd,"_",file$newt_mu_rate, "_", file$newt_mu_effect_sd, "_", file$rep)

GA1<-file[which(file$snake_newt_rep==file_name & file$generation==spegen & file$interrate==interrate),]
GA1_type = paste0("generation|", type)  

GA1_type = GA1[,grepl(GA1_type, names(GA1)) ]
GA1_type <- GA1_type[-1]

data_long_type_comp <- gather(GA1_type, condition, measurement, factor_key=TRUE)
data_long_type_comp[,c("species","type", "type2","location")]<- str_split_fixed(data_long_type_comp$condition, "_", 4)

data_long_type_comp$y_loc<- rep(sort(c(rep.int(row_num:1, 2)), decreasing = TRUE),col_num)

data_long_type_comp$x_loc<- sort(rep.int(1:col_num, row_num*2))
  
main_plot<-ggplot(data_long_type_comp)+
  
  geom_point(data = data_long_type_comp[which(data_long_type_comp$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = data_long_type_comp[which(data_long_type_comp$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c()+
  #ylim(0, row_num)+
  #xlim(0, col_num)+
  theme_bw()+
  theme(legend.justification = "top")

if(type != "num_ind"){
main_plot<- main_plot + labs(title = paste0(str_to_title(type)," Phenotype of Locations"),
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Toxicity/Resistance")+
 scale_fill_viridis_c()
}
if(type == "num_ind"){
main_plot<- main_plot + labs(title = paste0("Number of Individuals at Locations ", str_to_title(type)),
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Newt/Snake PopSize")+
scale_fill_viridis_c(option = "plasma")
} 
  

snake<-data_long_type_comp[which(data_long_type_comp$species=="snake"),]
newt<-data_long_type_comp[which(data_long_type_comp$species=="newt"),]
newt$snake_value <- snake$measurement
print(cor(as.numeric(snake$measurement), as.numeric(newt$measurement), use="complete.obs"))

newt$info <- "middle"

#need to look into, coloring problem
newt$info[newt$location %in% c(0, row_num-1, col_num*row_num-row_num, col_num*row_num-1)] <- "corner"

newt$info[newt$location %in% c(c(1:(row_num-2)), seq(row_num, (col_num*row_num-row_num-2), row_num), seq((row_num-1+row_num), (col_num*row_num-1-row_num), row_num),  c((col_num*row_num-row_num+1):(col_num*row_num-2)))]   <- "edge"


extra_plot <- ggplot(newt)+
  ggtitle("Mean Phenotype") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))



final_plot <- main_plot +  inset_element(extra_plot, left = 1., bottom = -0.10, right = 1.35, top = 0.5)
return(final_plot)}


```

## How Often do Newts and Snakes Interact {.tabset}
First, I wanted to do some data exploration! So I examined how manipulating the interaction rate would effect some population dynamics. I wanted to pin-point how often snakes could potentially and actuality interact with newts (one is looping through snakes with newts near by and one is counting the amount of times a snake encountered a newt, respectively). These are presented as histograms colored by the interaction rate (look closely at title). I also wanted to explore how interaction rate could impact the population size and mean phenotype of snakes and newts. These are also shown as histograms where color indicates the interaction rate. I also looked for an interaction between interaction rate, the population size of newts and snakes, and the number of interactions that occurred within a generation.

### Potential Interaction
```{r, how oftern do they interact Potential Interaction}
ggplot(GA1_lit_interrate_file)+
  ggtitle("Potential Interaction") +
  xlab("Snake can Potentially Find a Newt, Param: snake_found_newt") +
  ylab("Count") +
  geom_histogram(aes(x = as.numeric(snake_found_newt), fill=factor(interrate)),  alpha = 0.65, position="identity")+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      axis.line = element_line(colour = "black")) 
```


### True Number of Interactions
```{r, True Number of Interactions}
ggplot(GA1_lit_interrate_file)+
  ggtitle("Number of Interactions") +
  xlab("Snake found a Newt, Param: newt_found") +
  ylab("Count") +
  geom_histogram(aes(x = as.numeric(newt_found), fill=factor(interrate)), alpha = 0.65, position="identity") +
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      axis.line = element_line(colour = "black")) 
```


### Newt and Snake Population Size
```{r, newt and snake pop size by interaction rate}
newtfig <- ggplot(GA1_lit_interrate_file)+
  ggtitle("Newt Population Size") +
  xlab("Newt_pop_size") +
  geom_histogram(aes(x = as.numeric(Newt_pop_size), fill=factor(interrate)), alpha = 0.65, position="identity") +
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      legend.position='none',
                      axis.line = element_line(colour = "black")) 

snakefig <- ggplot(GA1_lit_interrate_file)+
  ggtitle("Snake Population Size") +
  xlab("Snake_pop_size") +
  geom_histogram(aes(x = as.numeric(Snake_pop_size), fill=factor(interrate)), alpha = 0.65, position="identity") +
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(),
                      legend.position='none',
                      axis.line = element_line(colour = "black")) 

grid.arrange(newtfig, snakefig, ncol = 2)
```

### Newt and Snake Mean Phenotype
```{r, newt and snake meanphenotype by interaction rate}
newtfig <- ggplot(GA1_lit_interrate_file)+
  ggtitle("Newt Mean Phenotype") +
  xlab("Average Newt Phenotype") +
  geom_histogram(aes(x = as.numeric(Newt_mean_Pheno), fill=factor(interrate)), alpha = 0.65, position="identity") + xlim(0, 12)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      legend.position='none',
                      axis.line = element_line(colour = "black")) 

snakefig <- ggplot(GA1_lit_interrate_file)+
  ggtitle("Snake Mean Phenotype") +
  xlab("Average Snake Phenotype") +
  geom_histogram(aes(x = as.numeric(Snake_mean_Pheno), fill=factor(interrate)), alpha = 0.65, position="identity") + xlim(0, 12)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(),
                      legend.position='none',
                      axis.line = element_line(colour = "black")) 

grid.arrange(newtfig, snakefig, ncol = 2)
```

### How Interaction rate changes the population size
```{r, tale of the interaction rate and pop size}
ggplot(GA1_lit_interrate_file)+
  ggtitle("Number of Interactions by Newt and Snake Population Size") +
  xlab("Newt Population Size") + ylab("Snake Population Size")+
  facet_wrap(~interrate)+
  geom_point(aes(x = as.numeric(Newt_pop_size), y = as.numeric(Snake_pop_size), color=newt_found), size = 1 )+
  scale_color_viridis_c(name = "newt_found")+
  theme_bw() + theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="right")
GA1_lit_interrate_file$group_rate<- paste0(GA1_lit_interrate_file$group, "_", GA1_lit_interrate_file$interrate)
last_point <- GA1_lit_interrate_file %>% group_by(group_rate) %>% slice_max(generation, with_ties = FALSE)
```

## {-}


Changing the interaction rate has major consequences for my simulation. If the interaction rate is too low there is not enough selection to increase the mean phenotype of newts and snakes. If the interaction rate is too large there is too much competition between newts and snakes leading to an extinction of one of the species. In my simulation the potential interaction is noted if there is a newt near a snake. This measurement is a combination of the snakes population size and how close the species are to each other. The true number of interactions is based on a mathematical formula that increases the probably of interaction with increasing the interaction rate, but also decreases the probability of interaction with an increase in distance to a newt. This explains why low interaction rates have less interactions, while also explaining why higher interaction rates also have less interactions. Interaction rate has consequences for newt and snake population size and phenotype. At lower interaction rates newts and snakes have a higher population size, but lower mean phenotype. At slightly larger interaction rates newts and snakes have a lower population size, but a higher mean phenotype. At the largest interaction rates the newt and snake populations reach extreme population sizes and high mean phenotypes as one of the species goes extinct. For fun, I explored how each  interaction rate changed the population sizes of newts and snakes and the number of interaction that occurred. I found that an interaction rate that is too low or too high ends up having less interactions overall. There is small area of parameter space where interaction rate can be set to (0.025 to 0.075).      

surs = 0.5
mPoint = c(ind_snake.x,ind_snake.y);
newtNeighbors = i1.nearestNeighborsOfPoint(p1, mPoint, count=1000000);// could make count smaller (limit the number of newts nearby)
distance = i1.distanceToPoint(newtNeighbors, mPoint);// vector of distances 
probablity = interaction_rate * exp(-(distance^2)/(2*(surs^2)))
newt_meet_snake = newtNeighbors[runif(length(newtNeighbors)) < probablity]
distance might go up and down based on how close newts and snakes

```{r, extra plots that deminstrate that it is consistance across the GA combos}
# ggplot(GA1_lit_interrate_file)+
#   ggtitle("snake_found_newt") +
#   xlab("Generations") + ylab("snake_found_newt")+
#   geom_point(aes(x = as.numeric(generation), y = as.numeric(snake_found_newt), color=factor(interrate)), size = 1 )+
#   theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
#                       # strip.background = element_blank(), 
#                       # strip.text.x = element_blank(), 
#                       # panel.grid.major = element_blank(), 
#                       # panel.grid.minor = element_blank(),
#                       # panel.background = element_blank(), 
#                       axis.line = element_line(colour = "black")) 
# 
# ggplot(GA1_lit_interrate_file)+
#   ggtitle("snake_found_newt") +
#   xlab("Generations") + ylab("snake_found_newt")+
#   facet_wrap(~group)+
#   geom_point(aes(x = as.numeric(generation), y = as.numeric(snake_found_newt), color=factor(interrate)), size = 1 )+
#   theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
#                       # strip.background = element_blank(), 
#                       # strip.text.x = element_blank(), 
#                       # panel.grid.major = element_blank(), 
#                       # panel.grid.minor = element_blank(),
#                       # panel.background = element_blank(), 
#                       axis.line = element_line(colour = "black")) 
# 
# ggplot(GA1_lit_interrate_file)+
#   ggtitle("newt_found") +
#   xlab("Generations") + ylab("newt_found")+
#   facet_wrap(~group)+
#   geom_point(aes(x = as.numeric(generation), y = as.numeric(newt_found), color=factor(interrate)), size = 1 )+
#   theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
#                       # strip.background = element_blank(), 
#                       # strip.text.x = element_blank(), 
#                       # panel.grid.major = element_blank(), 
#                       # panel.grid.minor = element_blank(),
#                       # panel.background = element_blank(), 
#                       axis.line = element_line(colour = "black")) 
# 
# ggplot(GA1_lit_interrate_file)+
#   ggtitle("newt_found") +
#   xlab("Generations") + ylab("newt_found")+
#   geom_point(aes(x = as.numeric(generation), y = as.numeric(newt_found), color=factor(interrate)), size = 1 )+
#   theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
#                       # strip.background = element_blank(), 
#                       # strip.text.x = element_blank(), 
#                       # panel.grid.major = element_blank(), 
#                       # panel.grid.minor = element_blank(),
#                       # panel.background = element_blank(), 
#                       axis.line = element_line(colour = "black")) 
# 
# 
# ggplot(GA1_lit_interrate_file)+
#   ggtitle("Snake can potentially find a newt") +
#   xlab("snake_found_newt") +
#   geom_histogram(aes(x = as.numeric(snake_found_newt), fill=factor(interrate)),  alpha = 0.65, position="identity")+
#   theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
#                       # strip.background = element_blank(), 
#                       # strip.text.x = element_blank(), 
#                       # panel.grid.major = element_blank(), 
#                       # panel.grid.minor = element_blank(),
#                       # panel.background = element_blank(), 
#                       axis.line = element_line(colour = "black")) 
# 
# ggplot(GA1_lit_interrate_file)+
#   ggtitle("Snake can potentially find a newt") +
#   xlab("snake_found_newt") +
#   geom_histogram(aes(x = as.numeric(snake_found_newt), fill=factor(interrate)),  alpha = 0.65, position="identity")+
#   facet_wrap(~group)+
#   theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
#                       # strip.background = element_blank(), 
#                       # strip.text.x = element_blank(), 
#                       # panel.grid.major = element_blank(), 
#                       # panel.grid.minor = element_blank(),
#                       # panel.background = element_blank(), 
#                       axis.line = element_line(colour = "black")) 
# 
# ggplot(GA1_lit_interrate_file)+
#   ggtitle("Snake found a Newt") +
#   xlab("newt_found") +
#   geom_histogram(aes(x = as.numeric(newt_found), fill=factor(interrate)), alpha = 0.65, position="identity") +
#   theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
#                       # strip.background = element_blank(), 
#                       # strip.text.x = element_blank(), 
#                       # panel.grid.major = element_blank(), 
#                       # panel.grid.minor = element_blank(),
#                       # panel.background = element_blank(), 
#                       axis.line = element_line(colour = "black")) 
# 
# 
# ggplot(GA1_lit_interrate_file)+
#   ggtitle("Snake age") +
#   xlab("Snake_age") +
#   geom_histogram(aes(x = as.numeric(Snake_age), fill=factor(interrate)), alpha = 0.65, position="identity") +
#   xlim(0, 10)+
#   theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
#                       # strip.background = element_blank(), 
#                       # strip.text.x = element_blank(), 
#                       # panel.grid.major = element_blank(), 
#                       # panel.grid.minor = element_blank(),
#                       # panel.background = element_blank(), 
#                       axis.line = element_line(colour = "black")) 
# 
# ggplot(GA1_lit_interrate_file)+
#   ggtitle("Newt age") +
#   xlab("Newt_age") +
#   geom_histogram(aes(x = as.numeric(Newt_age), fill=factor(interrate)), alpha = 0.65, position="identity") +
#   xlim(0, 10)+
#   theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
#                       # strip.background = element_blank(), 
#                       # strip.text.x = element_blank(), 
#                       # panel.grid.major = element_blank(), 
#                       # panel.grid.minor = element_blank(),
#                       # panel.background = element_blank(), 
#                       axis.line = element_line(colour = "black")) 
# 
# ggplot(GA1_lit_interrate_file)+
#   ggtitle("Snake found a Newt") +
#   xlab("newt_found") +
#   geom_histogram(aes(x = as.numeric(newt_found), fill=factor(interrate)), alpha = 0.65, position="identity") +
#   facet_wrap(~group)+
#   theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
#                       # strip.background = element_blank(), 
#                       # strip.text.x = element_blank(), 
#                       # panel.grid.major = element_blank(), 
#                       # panel.grid.minor = element_blank(),
#                       # panel.background = element_blank(), 
#                       axis.line = element_line(colour = "black")) 
# 
# 
# ggplot(GA1_lit_interrate_file)+
#   ggtitle("Newt_pop_size") +
#   xlab("Newt_pop_size") +
#   geom_histogram(aes(x = as.numeric(Newt_pop_size), fill=factor(interrate)), alpha = 0.65, position="identity") +
#   theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
#                       # strip.background = element_blank(), 
#                       # strip.text.x = element_blank(), 
#                       # panel.grid.major = element_blank(), 
#                       # panel.grid.minor = element_blank(),
#                       # panel.background = element_blank(), 
#                       axis.line = element_line(colour = "black")) 
# 
# ggplot(GA1_lit_interrate_file)+
#   ggtitle("Snake_pop_size") +
#   xlab("Snake_pop_size") +
#   geom_histogram(aes(x = as.numeric(Snake_pop_size), fill=factor(interrate)), alpha = 0.65, position="identity") +
#   theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
#                       # strip.background = element_blank(), 
#                       # strip.text.x = element_blank(), 
#                       # panel.grid.major = element_blank(), 
#                       # panel.grid.minor = element_blank(),
#                       # panel.background = element_blank(), 
#                       axis.line = element_line(colour = "black")) 
# 
# ggplot(GA1_lit_interrate_file)+
#   ggtitle("Newt_mean_Pheno") +
#   xlab("Newt_mean_Pheno") +
#   geom_histogram(aes(x = as.numeric(Newt_mean_Pheno), fill=factor(interrate)), alpha = 0.65, position="identity") +
#   xlim(0, 12)+
#   theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
#                       # strip.background = element_blank(), 
#                       # strip.text.x = element_blank(), 
#                       # panel.grid.major = element_blank(), 
#                       # panel.grid.minor = element_blank(),
#                       # panel.background = element_blank(), 
#                       axis.line = element_line(colour = "black")) 
# 
# ggplot(GA1_lit_interrate_file)+
#   ggtitle("Snake_mean_Pheno") +
#   xlab("Snake_mean_Pheno") +
#   geom_histogram(aes(x = as.numeric(Snake_mean_Pheno), fill=factor(interrate)), alpha = 0.65, position="identity") +
#   xlim(0, 12)+
#   theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
#                       # strip.background = element_blank(), 
#                       # strip.text.x = element_blank(), 
#                       # panel.grid.major = element_blank(), 
#                       # panel.grid.minor = element_blank(),
#                       # panel.background = element_blank(), 
#                       axis.line = element_line(colour = "black")) 
# 
# ggplot(GA1_lit_interrate_file)+
#   ggtitle("Interactions by population size") +
#   xlab("newt pop size") + ylab("snake popsize")+
#   facet_wrap(~interrate)+
#   geom_point(aes(x = as.numeric(Newt_pop_size), y = as.numeric(Snake_pop_size), color=newt_found), size = 1 )+
#   scale_color_viridis_c(name = "newt_found")+
#   theme_bw() + theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="right")
# GA1_lit_interrate_file$group_rate<- paste0(GA1_lit_interrate_file$group, "_", GA1_lit_interrate_file$interrate)
# last_point <- GA1_lit_interrate_file %>% group_by(group_rate) %>% slice_max(generation, with_ties = FALSE)
# 
# 
# ggplot(last_point)+
#   ggtitle("How long did the sim last") +
#   xlab("newt popsize") + ylab("snake popsize")+
#   facet_wrap(~interrate)+
#   geom_point(aes(x = as.numeric(Newt_pop_size), y = as.numeric(Snake_pop_size), color=generation), size = 1 )+
#   scale_color_viridis_c(name = "generation")+
#   theme_bw() + theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="right")

```

## Mean Phenotype Whole Simulation & The Interaction With Population size  {.tabset}

Next, I will look at a plot of how the mean phenotype of the entire population of newts and snakes changes overtime. Each of these plots has three colored lines, red for the mean newt phenotype, blue for the mean snake phenotype, and black for the difference between mean snake and mean newt phenotype. There are 11 lines per color with a shape at the last data point collected that represent the different interaction rates. Note this is a mean for the entire population. Mutational variance increases for the snakes as you go down the figure (top to bottom) and increases for the newts as you go across (left to right). 

In previous experiments, I saw a connection between newt/snake phenotype and population size. Typically, when a species had a higher phenotype they also had a larger population size. This relation between phenotype and population size had specific outcomes that depended on the GA of newts and snakes. In this plot I look at how interaction rate might change this observation. Here some of the interaction rates are shown as shapes (I choose to limit the number of interaction rayes I was looking at).

### Mean Phenotype As Time Increases
```{r, graphing by gen}


trends_by_gen(GA1_lit_interrate_file, title="Space Tall: Newt VS Snake Population Size GA1", subt="Gen 16sims", y_label="Mean Phenotype", x_label="Generations", 100, 50000, rep=0)

```

### Relationship Between Popsize and Phenotype
```{r, whale}
min_gen=5000
max_gen=10000
rep=0


whale_gen(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=rep, interrate_cap=0.125)
```

## {-}

As I have mentioned before, higher interaction rates lead to a populations extinction (for many of them the extinction happens very early > 5,000 generations). However, it does seem that higher interaction rates can lead to a higher mean phenotype. Higher interaction rates seem to run in simulation where both newts and snakes have a larger amount of mutational variance. 

The relationship between newt and snake population sizes and the difference between mean phenotype is affected by a change in the interaction rate. A lower interaction rate has higher population sizes and lower mean phenotype differences. I found that as the interaction rate increases the larger the range in population sizes became. I also noticed that larger interaction rates tended to have a larger difference between mean phenotypes and that newts seemed to have larger phenotypes.


```{r, combo myplots}


# ginmin = 0
# ginmax = 50000
# #thecolors=c("#F8766D", "#B79F00", "#00BA38", "#00BFC4", "#619CFF", "#F564E3")
# 
# boxplot_cors_by_gen(GA1_cor_interrate_file, "interrate: Simulation Correlation By Grid Number Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)

```


## Correlation Across Time  {.tabset}

In order to understand how spatial correlations where changing with time I took 5,000 generation time slices to look at all correlation values for each of the different interaction rate. Each color is a different interaction rate. Each plot is one GA combination. Mutational variance increases for the snakes as you go down the figure (top to bottom) and increases for the newts as you go across (left to right). 

### Plot 1
```{r, GA1 cor by dif windows1}
ginmin = 0
ginmax = 5000
boxplot_cors_by_gen(GA1_cor_interrate_file, "interrate: Simulation Correlation By Grid Number Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)
```

### Plot 2

```{r, GA1 cor by dif windows 2}
ginmin = 5000
ginmax = 10000
boxplot_cors_by_gen(GA1_cor_interrate_file, "interrate: Simulation Correlation By Grid Number Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)
```

### Plot 3
```{r, GA1 cor by dif windows 3}
ginmin = 10000
ginmax = 15000
boxplot_cors_by_gen(GA1_cor_interrate_file, "interrate: Simulation Correlation By Grid Number Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)
```

### Plot 4
```{r, GA1 cor by dif windows 4}
ginmin = 15000
ginmax = 20000
boxplot_cors_by_gen(GA1_cor_interrate_file, "interrate: Simulation Correlation By Grid Number Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)
```

### Plot 5
```{r, GA1 cor by dif windows 5}
ginmin = 20000
ginmax = 25000
boxplot_cors_by_gen(GA1_cor_interrate_file, "interrate: Simulation Correlation By Grid Number Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)
```

### Plot 6
```{r, GA1 cor by dif windows 6}
ginmin = 25000
ginmax = 30000
boxplot_cors_by_gen(GA1_cor_interrate_file, "interrate: Simulation Correlation By Grid Number Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)
```

### Plot 7
```{r, GA1 cor by dif windows 7}
ginmin = 30000
ginmax = 35000
boxplot_cors_by_gen(GA1_cor_interrate_file, "interrate: Simulation Correlation By Grid Number Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)
```

### Plot 8
```{r, GA1 cor by dif windows 8}
ginmin = 35000
ginmax = 40000
boxplot_cors_by_gen(GA1_cor_interrate_file, "interrate: Simulation Correlation By Grid Number Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)
```

### Plot 9
```{r, GA1 cor by dif windows 9}
ginmin = 40000
ginmax = 45000
boxplot_cors_by_gen(GA1_cor_interrate_file, "interrate: Simulation Correlation By Grid Number Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)
```

### Plot 10
```{r, GA1 cor by dif windows 10}
ginmin = 45000
ginmax = 50000
boxplot_cors_by_gen(GA1_cor_interrate_file, "interrate: Simulation Correlation By Grid Number Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)
```

## {-}

The range of colors in these plots is so pretty! There was no interaction rate that lead to my simulated newts and snakes having a high correlated phenotype similar to the real newt and snake (dashed line) correlation. As the interaction rate increased there was more variation in spatial phenotype correlation. I think this might be due to major decreases in a species population size that occurred when interaction rates were large. Simulations that had one or more species with a higher level of mutational variance were able to persist larger interaction rates.

## Phenotype Correlation across time {.tabset}

Next, we will examine three randomly chosen plots from this experiment. Time (in generations) in on the x-axis and both mean phenotype and phenotype spatial correlation in on the y-axis. Newt whole population mean phenotype is red, while snake mean phenotype is blue. The multi-colored line line is the phenotype spatial correlation at different interaction rates.  


### Random 1 
```{r, GA1 cor and pheno}
GA1_pattern <- unique(paste0(GA1_lit_interrate_file$snake_mu_rate, "_", GA1_lit_interrate_file$snake_mu_effect_sd,"_",GA1_lit_interrate_file$newt_mu_rate, "_", GA1_lit_interrate_file$newt_mu_effect_sd, "_", GA1_lit_interrate_file$rep))

myrandomlist=sample.int(length(GA1_pattern), 3)


cor_trends_by_gen(GA1_lit_interrate_file, GA1_cor_interrate_file, "test", "GA1", "newt/snake GAs&rep","other", "Cor", min_gen=100, max_gen=50000, pattern=GA1_pattern[myrandomlist[1]], interrate_cap= 0.125)

```

### Random 2 
```{r, random cor-pheno plot 2}

cor_trends_by_gen(GA1_lit_interrate_file, GA1_cor_interrate_file, "test", "GA1", "newt/snake GAs&rep","other", "Cor", min_gen=100, max_gen=50000, pattern=GA1_pattern[myrandomlist[2]], interrate_cap= 0.125)
```

### Random 3 
```{r, random cor-pheno plot 3}

cor_trends_by_gen(GA1_lit_interrate_file, GA1_cor_interrate_file, "test", "GA1", "newt/snake GAs&rep","other", "Cor", min_gen=100, max_gen=50000, pattern=GA1_pattern[myrandomlist[3]], interrate_cap= 0.125)
```

## {-}

There is no relationship between mean phenotype and phenotype spatial correlations. The mean phenotype of newts and snakes goes up over time, but the spatial correlation seems to randomly go up and down. Simulations with a high interaction rate typically end up with higher phenotypes, but when the interaction rate is too high a species will die out. The higher the interaction rate the more variable the spatial correlation may get.  

## Population Size Correlation across time {.tabset}

Now, we will examine the population size of the three randomly chosen plots from this experiment. Time (in generations) in on the x-axis and both population size and population size spatial correlation in on the y-axis. Newt population size is red, while snake population size is blue. The multi-colored line line is the population spatial correlation at different interaction rates.

### Random 1 
```{r, GA1 pop size 1}
pop_size_trends_by_gen(GA1_lit_interrate_file, GA1_cor_interrate_file, "test", "GA1", "newt/snake GAs&rep","other", "Cor", min_gen=100, max_gen=50000, pattern=GA1_pattern[myrandomlist[1]], interrate_cap= 0.125)

```

### Random 2 
```{r, random pop size plot 2}

pop_size_trends_by_gen(GA1_lit_interrate_file, GA1_cor_interrate_file, "test", "GA1", "newt/snake GAs&rep","other", "Cor", min_gen=100, max_gen=50000, pattern=GA1_pattern[myrandomlist[2]],interrate_cap= 0.125)
```

### Random 3 
```{r, random pop size plot 3}

pop_size_trends_by_gen(GA1_lit_interrate_file, GA1_cor_interrate_file, "test", "GA1", "newt/snake GAs&rep","other", "Cor", min_gen=100, max_gen=50000, pattern=GA1_pattern[myrandomlist[3]],interrate_cap= 0.125)
```

## {-}

There is a connection between population size and interaction rate. The interaction rate has an effect on the population size, but it is difficult to tell because the how different the population sizes are at the smaller sized edges and corners. If all of the measured areas were the same size I predict that there would be more negative correlation. 

## What happens over time (looking at the beginning and late part of my simulations) {.tabset}

This section explores how changing the interaction rate affects the first and last 5,000 generations of my co-evolution simulation. Newt and snake population size are on the x and y axis and the point color is the difference between snake and newt mean phenotype. Each plot contains many time points from one simulation with a set GA combination. Mutational variance increases for the snakes as you go down the figure (top to bottom) and increases for the newts as you go across (left to right).   


### Pheno Beginning 0.01

```{r, early 0.01 plots}


min_gen=100
max_gen=5000
interrate=0.01

whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```

### Pheno Beginning 0.025

```{r, early 0.025 plots}


min_gen=100
max_gen=5000
interrate=0.025

whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```



### Pheno Beginning 0.05

```{r, early 0.05 plots}


min_gen=100
max_gen=5000
interrate=0.05

whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```

### Pheno Beginning 0.075

```{r, early 0.075 plots}


min_gen=100
max_gen=5000
interrate=0.075

whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```


### Pheno Beginning 0.10

```{r, early 0.10 plots}


min_gen=100
max_gen=5000
interrate=0.10

whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```

### Pheno Beginning 0.125

```{r, early 0.125 plots}


min_gen=100
max_gen=5000
interrate=0.125

whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```


### Pheno Beginning 0.15

```{r, early 0.15 plots}


min_gen=100
max_gen=5000
interrate=0.15

whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```

### Pheno Beginning 0.20

```{r, early 0.20 plots}


min_gen=100
max_gen=5000
interrate=0.20

whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```


### Pheno Beginning 0.25

```{r, early 0.25 plots}


min_gen=100
max_gen=5000
interrate=0.25

whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```

### Pheno Beginning 0.30

```{r, early 0.30 plots}


min_gen=100
max_gen=5000
interrate=0.30

whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```

### Pheno Beginning 0.35

```{r, early 0.35 plots}


min_gen=100
max_gen=5000
interrate=0.35

whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```


### Pheno End 0.01

```{r, late 0.01 plots}


min_gen=45000
max_gen=50000
interrate=0.01

whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```

### Pheno End 0.025

```{r, late 0.025 plots}


min_gen=45000
max_gen=50000
interrate=0.025

whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```

### Pheno End 0.05

```{r, late 0.05 plots}


min_gen=45000
max_gen=50000
interrate=0.05

whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```

### Pheno End 0.075

```{r, late 0.075 plots}


min_gen=45000
max_gen=50000
interrate=0.075

whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```

### Pheno End 0.10

```{r, late 0.10 plots}


min_gen=45000
max_gen=50000
interrate=0.10

whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```

### Pheno End 0.125

```{r, late 0.125 plots}


min_gen=45000
max_gen=50000
interrate=0.125

whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```

### Pheno End 0.15

```{r, late 0.15 plots}


min_gen=45000
max_gen=50000
interrate=0.15

whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```

### Pheno End 0.20

```{r, late 0.20 plots}


min_gen=45000
max_gen=50000
interrate=0.20

#whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```

### Pheno End 0.25

```{r, late 0.25 plots}


min_gen=45000
max_gen=50000
interrate=0.25

whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```

### Pheno End 0.30

```{r, late 0.30 plots}


min_gen=45000
max_gen=50000
interrate=0.30

#whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```


### Pheno End 0.35

```{r, late 0.35 plots}


min_gen=45000
max_gen=50000
interrate=0.35

whale_gen_by_interrate(GA1_lit_interrate_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(GA1_lit_interrate_file$rep)[1], interrate)
```

## {-}

In the early part of my simulation I noticed that as the interaction rate because larger the population size drastically turns in one species favor. A higher interaction rate led to a larger difference between mean phenotype. In the last part of my simulation there are less and less simulations that reach the last 5,000 generations. There is also more difference between GA combinations as the interaction rate increases. For example, each of the the GA combinations ending up having very different population sizes (when compared to lower interaction rates). Some intermediate interaction rates ended up having the largest phenotype differences (potentially due to having more interactions do to the immersion of both species).

## Heatmap {.tabset}

This section explores the heatmap plots where the GA of the newt is on the x-axins and the GA of the snake along with the interaction rate for the simulation is on the y-axis. There are two types of heatmap plots shown below. One shows the average snake population size for a time chunk with darker colors indicating a smaller snake population and lighter colors indicating a larger snake population. The other heatmap shows the average difference between snake and newt mean phenotype (red=newts had a higher phenotype, blue=snakes had a higher phenotype). The simulation result is the color in that section. 

### interrate: Population Size (Early)  
```{r, interrate earlyplots Heatmap1, fig.height=6}
min_gen=100
max_gen=5000

build_heatmap(GA1_lit_interrate_file, min_gen=min_gen, max_gen=max_gen, fill_line="Snake_pop_size", fill_line_text="Snake Population Size", title="Newt GA by Snake GA", subt="16 Sim Heatmap", y_label="Snake GA", x_label="Newt GA", red_blue=F)

```


### interrate: Population Size (Mid)  
```{r, interrate midplots Heatmap6, fig.height=4}
min_gen=25000
max_gen=30000

build_heatmap(GA1_lit_interrate_file, min_gen=min_gen, max_gen=max_gen, fill_line="Snake_pop_size", fill_line_text="Snake Population Size", title="Newt GA by Snake GA", subt="16 Sim Heatmap", y_label="Snake GA", x_label="Newt GA", red_blue=F)

```


### interrate: Population Size (Late)  
```{r, interrate plots Heatmap10, fig.height=4}
min_gen=45000
max_gen=50000

build_heatmap(GA1_lit_interrate_file, min_gen=min_gen, max_gen=max_gen, fill_line="Snake_pop_size", fill_line_text="Snake Population Size", title="Newt GA by Snake GA", subt="16 Sim Heatmap", y_label="Snake GA", x_label="Newt GA", red_blue=F)

```


### interrate: Phenotype (Early) 
```{r, interrate earlyplots Heatmap1 pheno, fig.height=4}

min_gen=100
max_gen=5000

build_heatmap(GA1_lit_interrate_file, min_gen=min_gen, max_gen=max_gen, fill_line="dif", fill_line_text="Snake-Newt", title="Newt GA by Snake GA", subt="16 Sim Heatmap", y_label="Snake GA", x_label="Newt GA",red_blue=T)
```


### interrate: Phenotype (Mid) 
```{r, interrate earlyplots Heatmap6 pheno, fig.height=4}

min_gen=25000
max_gen=30000

build_heatmap(GA1_lit_interrate_file, min_gen=min_gen, max_gen=max_gen, fill_line="dif", fill_line_text="Snake-Newt", title="Newt GA by Snake GA", subt="16 Sim Heatmap", y_label="Snake GA", x_label="Newt GA",red_blue=T)
```


### interrate: Phenotype (Late) 
```{r, interrate plots Heatmap10 pheno, fig.height=4}

min_gen=45000
max_gen=50000

build_heatmap(GA1_lit_interrate_file, min_gen=min_gen, max_gen=max_gen, fill_line="dif", fill_line_text="Snake-Newt", title="Newt GA by Snake GA", subt="16 Sim Heatmap", y_label="Snake GA", x_label="Newt GA",red_blue=T)
```

## {-}

It seems like higher interaction rates can lead to more differences in snake population size and a larger mean phenotype differences. These results depend on the GA of both the newt and snake, with more variable results appearing when the GA have intermediate phenotype variance (medium mu rate and effect size). It is difficult to tell what is occurring overtime due to the simulations ending early.    



```{r, red in grid files}
require(readr)
GA1_grid_interrate_file<- read.csv("~/Desktop/interaction_rate/all_grid.txt" , header = TRUE) %>%  filter(between(generation, 10000, 15000))
GA1_grid_interrate_file$group_rep <- paste0(GA1_grid_interrate_file$snake_mu_rate, "_", GA1_grid_interrate_file$snake_mu_effect_sd,"_",GA1_grid_interrate_file$newt_mu_rate, "_", GA1_grid_interrate_file$newt_mu_effect_sd, "_", GA1_grid_interrate_file$rep)
GA1_grid_interrate_file$group <- paste0(GA1_grid_interrate_file$snake_mu_rate, "_", GA1_grid_interrate_file$snake_mu_effect_sd,"_",GA1_grid_interrate_file$newt_mu_rate, "_", GA1_grid_interrate_file$newt_mu_effect_sd)
GA1_grid_interrate_file$sim=LETTERS[factor(GA1_grid_interrate_file$group)]
GA1_grid_interrate_file$grid_num = 5

GA1_grid_interrate_file$snake_newt_rep <- paste0(GA1_grid_interrate_file$snake_mu_rate, "_", GA1_grid_interrate_file$snake_mu_effect_sd,"_",GA1_grid_interrate_file$newt_mu_rate, "_", GA1_grid_interrate_file$newt_mu_effect_sd, "_", GA1_grid_interrate_file$rep)


```


## Grid Figs {.tabset}

This last section will explore how large a snake/newt phenotype or population size is at a certain local region. The squares represent local snakes population values, while the circles represent local newt values. The sub-plots show how the values play out over the samples being located on an edge, corner, or middle of the map. In my true simulation there is no space all of these should be touching.

### 0.01
```{r, cor 0.01 high cor mean}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.01

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),])
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}

type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.025
```{r, cor 0.025 high cor mean}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.025

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),])
if(value!=0){
 grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.05
```{r, cor 0.05 high cor mean}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.05

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.075
```{r, cor 0.075 high cor mean}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.075

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.10
```{r, cor 0.10 high cor mean1}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.10

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),])
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.125
```{r, cor 0.125 high cor mean 1}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.125

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ 
  grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}

type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```


### 0.15
```{r, cor 0.15 high cor mean 1}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.15

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }

type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.20
```{r, cor 0.20 high cor mean 1}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.20

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }

type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.25
```{r, cor 0.25 high cor mean 1}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.25

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }

type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.30
```{r, cor 0.30 high cor mean 1}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.30

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }

type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.35
```{r, cor 0.35 high cor mean 1}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.35

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}

```

## {-}

## Grid Figs 2 {.tabset}


### 0.01
```{r, cor 0.01 high cor mean2}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[2]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.01

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.025
```{r, cor 0.025 high cor mean2}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[2]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.025

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.05
```{r, cor 0.05 high cor mea2}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[2]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.05

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.075
```{r, cor 0.075 high cor mean2}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[2]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.075

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.10
```{r, cor 0.10 high cor mean2}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[2]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.10

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.125
```{r, cor 0.125 high cor mean2}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[2]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.125

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```


### 0.15
```{r, cor 0.15 high cor mean2}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[2]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.15

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.20
```{r, cor 0.20 high cor mean2}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[2]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.20

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 

if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.25
```{r, cor 0.25 high cor mean2}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[2]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.25

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.30
```{r, cor 0.30 high cor mean2}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[2]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.30

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.35
```{r, cor 0.35 high cor mean2}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[2]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.35

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

## {-}

## Grid Figs 3 {.tabset}


### 0.01
```{r, cor 0.01 high cor mean3}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[3]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.01

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.025
```{r, cor 0.025 high cor mean3}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[3]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.025

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.05
```{r, cor 0.05 high cor mean3}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[3]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.05

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.075
```{r, cor 0.075 high cor mean3}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[3]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.075

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.10
```{r, cor 0.10 high cor mean3}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[3]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.10

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.125
```{r, cor 0.125 high cor mean3}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[3]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.125

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```


### 0.15
```{r, cor 0.15 high cor mean3}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[3]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.15

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.20
```{r, cor 0.20 high cor mean3}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[3]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.20

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.25
```{r, cor 0.25 high cor mean3}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[3]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.25

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.30
```{r, cor 0.30 high cor mean3}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[3]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.30

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),])
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

### 0.35
```{r, cor 0.35 high cor mean3}

file=GA1_grid_interrate_file
file_name=GA1_pattern[myrandomlist[3]]
spegen=14981
type="mean"
col_num=5
row_num=col_num*4
interrate=0.35

value<-nrow(GA1_grid_interrate_file[which(GA1_grid_interrate_file$snake_newt_rep==file_name & GA1_grid_interrate_file$generation==spegen & GA1_grid_interrate_file$interrate==interrate),]) 
if(value!=0){ grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) }
type="num_ind"
if(value!=0){
grid_plot(file_name, spegen, file, type, row_num, col_num, interrate) 
}
```

## {-}

