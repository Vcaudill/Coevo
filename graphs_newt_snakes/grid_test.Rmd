---
title: "Grid Test"
output: html_document
date: '2022-09-27'
---

```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE,echo = FALSE) 

library(ggplot2)
library(viridis)
library(colorspace)
library(gridExtra)
library(tidyverse)
require(reshape2)
library(plyr)
library(gridGraphics)
library(grid)
library(knitr)
library(kableExtra)
library("reshape")
library(ggplot2)
library(ggpubr)
theme_set(theme_pubr())
library(stringr)
library(patchwork)
```

## Goal:

Think, explore, & write about what the co-evolutionary interaction between newts & snakes with different genetic architectures (GAs, combination of mutation rate & mutation effect size) can lead to. This markdown is investigation what is up with the different levels of correlation between rectangles and squares (in connection with GA1 tall). After fixing the row vs column error I looked at the correlation data and found that there was less correlation. So I decided to investigate why that might be and run a few more experiments. I am running an experiment to test how changing the square size might impact the calculations. I also plan on changing the interaction rate (but want to look at the math/ feasibility of it). This file contains results discussed in Tall_GA1!

### Questions:

How does grid size impact the spatial correlation of newt and snake phenotypes?

## Background

 

## Experiment

I created a simulation study to observe the co-evolutionary outcome of the newt-snake interaction with different genetic architectures (GAs) in a spatial setting. I hypothesized that we would see an interaction (co-evolutionary arms race) between newt and snake phenotype under some GA combinations when newts and snakes were evolving over geographical space. Each GA is paired with another GA creating 16 combinations.

GA1 experiment values:

- 1e-8*(0.005)^2 = 2.5e-13
- 1e-9*(0.05)^2 = 2.5e-12
- 1e-10*(0.5)^2 = 2.5e-11
- 1e-11*(5.0)^2 = 2.5e-10

Landscape: A tall map!: 35*4 H, 35 W 

I tested grid sizes for my tall landscape:

- grid 2X8, area 306.25 (approx)
- grid 3X12, area 136.11 (approx)
- grid 4X16, area 76.56 (approx)
- grid 5X20, area 49 (approx)
- grid 6X24, area 34.02 (approx)
- grid 7X28, area 25 (approx)

Each GA combination and trial has its own msprime simulation, but the msprime file is shared between the 5 section and 7 section slim runs.

### The data


## Preping the data by making singular files

```{bash, data file gathering}
#!/usr/bin/env bash

# Run these comands while in The the folder that contains the file you would like to condence
# Goal is to condence all the text files into one file 
# Requirements: need to have the same name and need to add additional columns
thepath=/Users/victoria/Desktop/
foldername=GA1_dif_grids
thefolder=${thepath}${foldername}/*

add_in_column=",rep,snake_mu_rate,snake_mu_effect_sd,newt_mu_rate,newt_mu_effect_sd"

lit_head_file=$(find ${thepath}${foldername} -name "*_GA1234567_lit_*" | head -n 1)
lit_head=$(head -n 1 "${lit_head_file}")

cor_head_file_2=$(find ${thepath}${foldername} -name "*_GA2_cor_*" | head -n 1)
cor_head=$(head -n 1 "${cor_head_file}")

cor_head_file_3=$(find ${thepath}${foldername} -name "*_GA3_cor_*" | head -n 1)
cor_head=$(head -n 1 "${cor_head_file}")

cor_head_file_4=$(find ${thepath}${foldername} -name "*_GA4_cor_*" | head -n 1)
cor_head=$(head -n 1 "${cor_head_file}")

cor_head_file_5=$(find ${thepath}${foldername} -name "*_GA5_cor_*" | head -n 1)
cor_head=$(head -n 1 "${cor_head_file}")

cor_head_file_6=$(find ${thepath}${foldername} -name "*_GA6_cor_*" | head -n 1)
cor_head=$(head -n 1 "${cor_head_file}")

cor_head_file_7=$(find ${thepath}${foldername} -name "*_GA7_cor_*" | head -n 1)
cor_head=$(head -n 1 "${cor_head_file}")

grid_head_file_2=$(find ${thepath}${foldername} -name "*_GA2_grid_*" | head -n 1)
grid_head=$(head -n 1 "${grid_head_file}")

grid_head_file_3=$(find ${thepath}${foldername} -name "*_GA3_grid_*" | head -n 1)
grid_head=$(head -n 1 "${grid_head_file}")

grid_head_file_4=$(find ${thepath}${foldername} -name "*_GA4_grid_*" | head -n 1)
grid_head=$(head -n 1 "${grid_head_file}")

grid_head_file_5=$(find ${thepath}${foldername} -name "*_GA5_grid_*" | head -n 1)
grid_head=$(head -n 1 "${grid_head_file}")

grid_head_file_6=$(find ${thepath}${foldername} -name "*_GA6_grid_*" | head -n 1)
grid_head=$(head -n 1 "${grid_head_file}")

grid_head_file_7=$(find ${thepath}${foldername} -name "*_GA7_grid_*" | head -n 1)
grid_head=$(head -n 1 "${grid_head_file}")



if [[ -f ${thepath}${foldername}/all_lit.txt ]] && [[ -f ${thepath}${foldername}/all_grid_2.txt ]] && [[ -f ${thepath}${foldername}/all_cor_2.txt ]]
then
  echo "All cor, lit, and grid files exist!"
  echo "This program will now end!"
  exit 0
fi

#creating the files
echo ${lit_head}${add_in_column} > ${thepath}${foldername}/all_lit.txt
echo ${grid_head}${add_in_column} > ${thepath}${foldername}/all_grid_2.txt
echo ${grid_head}${add_in_column} > ${thepath}${foldername}/all_grid_3.txt
echo ${grid_head}${add_in_column} > ${thepath}${foldername}/all_grid_4.txt
echo ${grid_head}${add_in_column} > ${thepath}${foldername}/all_grid_5.txt
echo ${grid_head}${add_in_column} > ${thepath}${foldername}/all_grid_6.txt
echo ${grid_head}${add_in_column} > ${thepath}${foldername}/all_grid_7.txt
echo ${cor_head}${add_in_column} > ${thepath}${foldername}/all_cor_2.txt
echo ${cor_head}${add_in_column} > ${thepath}${foldername}/all_cor_3.txt
echo ${cor_head}${add_in_column} > ${thepath}${foldername}/all_cor_4.txt
echo ${cor_head}${add_in_column} > ${thepath}${foldername}/all_cor_5.txt
echo ${cor_head}${add_in_column} > ${thepath}${foldername}/all_cor_6.txt
echo ${cor_head}${add_in_column} > ${thepath}${foldername}/all_cor_7.txt



for filename in $thefolder*.text;
  do 
#getting the variables 

my_type=$(echo ${filename} |sed 's/.*GA1234567_//; s/_.*//')
my_type_2=$(echo ${filename} |sed 's/.*GA2_//; s/_.*//')
my_type_3=$(echo ${filename} |sed 's/.*GA3_//; s/_.*//')
my_type_4=$(echo ${filename} |sed 's/.*GA4_//; s/_.*//')
my_type_5=$(echo ${filename} |sed 's/.*GA5_//; s/_.*//')
my_type_6=$(echo ${filename} |sed 's/.*GA6_//; s/_.*//')
my_type_7=$(echo ${filename} |sed 's/.*GA7_//; s/_.*//')

snake_mu_rate=$(echo ${filename} |sed 's/.*snake_mu_rate_//; s/_.*//')
snake_mu_effect_sd=$(echo ${filename} |sed 's/.*snake_mu_effect_sd_//; s/_.*//')
newt_mu_rate=$(echo ${filename} |sed 's/.*newt_mu_rate_//; s/_.*//')
newt_mu_effect_sd=$(echo ${filename} |sed 's/.*newt_mu_effect_sd_//; s/_.*//')
rep=$(echo ${filename} | sed "s/.*rep_//; s/_.*//")
#echo ${newt_mu_rate}	
# echo $my_type
# echo $my_other_type
# these new columns adding them to the data
sed -i '' -e 's/$/,'${rep}'/' $filename
sed -i '' -e 's/$/,'${snake_mu_rate}'/' $filename
sed -i '' -e 's/$/,'${snake_mu_effect_sd}'/' $filename
sed -i '' -e 's/$/,'${newt_mu_rate}'/' $filename
sed -i '' -e 's/$/,'${newt_mu_effect_sd}'/' $filename
#infile >outfile
if [[ $my_type == "lit" ]]
then
    tail -n +2 -q $filename >> ${thepath}${foldername}/all_lit.txt
fi

if [[ $my_type_2 == "grid" ]]
then
    tail -n +2 -q $filename >> ${thepath}${foldername}/all_grid_2.txt
fi

if [[ $my_type_2 == "cor" ]]
then
    tail -n +2 -q $filename >> ${thepath}${foldername}/all_cor_2.txt
fi

if [[ $my_type_3 == "grid" ]]
then
    tail -n +2 -q $filename >> ${thepath}${foldername}/all_grid_3.txt
fi

if [[ $my_type_3 == "cor" ]]
then
    tail -n +2 -q $filename >> ${thepath}${foldername}/all_cor_3.txt
fi

if [[ $my_type_4 == "grid" ]]
then
    tail -n +2 -q $filename >> ${thepath}${foldername}/all_grid_4.txt
fi

if [[ $my_type_4 == "cor" ]]
then
    tail -n +2 -q $filename >> ${thepath}${foldername}/all_cor_4.txt
fi

if [[ $my_type_5 == "grid" ]]
then
    tail -n +2 -q $filename >> ${thepath}${foldername}/all_grid_5.txt
fi

if [[ $my_type_5 == "cor" ]]
then
    tail -n +2 -q $filename >> ${thepath}${foldername}/all_cor_5.txt
fi

if [[ $my_type_6 == "grid" ]]
then
    tail -n +2 -q $filename >> ${thepath}${foldername}/all_grid_6.txt
fi

if [[ $my_type_6 == "cor" ]]
then
    tail -n +2 -q $filename >> ${thepath}${foldername}/all_cor_6.txt
fi

if [[ $my_type_7 == "grid" ]]
then
    tail -n +2 -q $filename >> ${thepath}${foldername}/all_grid_7.txt
fi

if [[ $my_type_7 == "cor" ]]
then
    tail -n +2 -q $filename >> ${thepath}${foldername}/all_cor_7.txt
fi

done

```



## Loading in/ Combining the files to compare different grid sizes

```{r, loading in the data}

snewt <- read.csv("~/Desktop/snake_newt_real_data.csv", header = TRUE)

GA1_lit_grid_file<- read.csv("~/Desktop/GA1_dif_grids/all_lit.txt" , header = TRUE)
GA1_lit_grid_file$group_rep <- paste0(GA1_lit_grid_file$snake_mu_rate, "_", GA1_lit_grid_file$snake_mu_effect_sd,"_",GA1_lit_grid_file$newt_mu_rate, "_", GA1_lit_grid_file$newt_mu_effect_sd, "_", GA1_lit_grid_file$rep)
GA1_lit_grid_file$group <- paste0(GA1_lit_grid_file$snake_mu_rate, "_", GA1_lit_grid_file$snake_mu_effect_sd,"_",GA1_lit_grid_file$newt_mu_rate, "_", GA1_lit_grid_file$newt_mu_effect_sd)
GA1_lit_grid_file$sim=LETTERS[factor(GA1_lit_grid_file$group)]
GA1_lit_grid_file$dif=GA1_lit_grid_file$Snake_mean_Pheno-GA1_lit_grid_file$Newt_mean_Pheno


GA1_cor_grid_2_file<- read.csv("~/Desktop/GA1_dif_grids/all_cor_2.txt" , header = TRUE)
GA1_cor_grid_2_file$group_rep <- paste0(GA1_cor_grid_2_file$snake_mu_rate, "_", GA1_cor_grid_2_file$snake_mu_effect_sd,"_",GA1_cor_grid_2_file$newt_mu_rate, "_", GA1_cor_grid_2_file$newt_mu_effect_sd, "_", GA1_cor_grid_2_file$rep)
GA1_cor_grid_2_file$group <- paste0(GA1_cor_grid_2_file$snake_mu_rate, "_", GA1_cor_grid_2_file$snake_mu_effect_sd,"_",GA1_cor_grid_2_file$newt_mu_rate, "_", GA1_cor_grid_2_file$newt_mu_effect_sd)
GA1_cor_grid_2_file$sim=LETTERS[factor(GA1_cor_grid_2_file$group)]
GA1_cor_grid_2_file$grid_num = 2


GA1_cor_grid_3_file<- read.csv("~/Desktop/GA1_dif_grids/all_cor_3.txt" , header = TRUE)
GA1_cor_grid_3_file$group_rep <- paste0(GA1_cor_grid_3_file$snake_mu_rate, "_", GA1_cor_grid_3_file$snake_mu_effect_sd,"_",GA1_cor_grid_3_file$newt_mu_rate, "_", GA1_cor_grid_3_file$newt_mu_effect_sd, "_", GA1_cor_grid_3_file$rep)
GA1_cor_grid_3_file$group <- paste0(GA1_cor_grid_3_file$snake_mu_rate, "_", GA1_cor_grid_3_file$snake_mu_effect_sd,"_",GA1_cor_grid_3_file$newt_mu_rate, "_", GA1_cor_grid_3_file$newt_mu_effect_sd)
GA1_cor_grid_3_file$sim=LETTERS[factor(GA1_cor_grid_3_file$group)]
GA1_cor_grid_3_file$grid_num = 3

GA1_cor_grid_4_file<- read.csv("~/Desktop/GA1_dif_grids/all_cor_4.txt" , header = TRUE)
GA1_cor_grid_4_file$group_rep <- paste0(GA1_cor_grid_4_file$snake_mu_rate, "_", GA1_cor_grid_4_file$snake_mu_effect_sd,"_",GA1_cor_grid_4_file$newt_mu_rate, "_", GA1_cor_grid_4_file$newt_mu_effect_sd, "_", GA1_cor_grid_4_file$rep)
GA1_cor_grid_4_file$group <- paste0(GA1_cor_grid_4_file$snake_mu_rate, "_", GA1_cor_grid_4_file$snake_mu_effect_sd,"_",GA1_cor_grid_4_file$newt_mu_rate, "_", GA1_cor_grid_4_file$newt_mu_effect_sd)
GA1_cor_grid_4_file$sim=LETTERS[factor(GA1_cor_grid_4_file$group)]
GA1_cor_grid_4_file$grid_num = 4

GA1_cor_grid_5_file<- read.csv("~/Desktop/GA1_dif_grids/all_cor_5.txt" , header = TRUE)
GA1_cor_grid_5_file$group_rep <- paste0(GA1_cor_grid_5_file$snake_mu_rate, "_", GA1_cor_grid_5_file$snake_mu_effect_sd,"_",GA1_cor_grid_5_file$newt_mu_rate, "_", GA1_cor_grid_5_file$newt_mu_effect_sd, "_", GA1_cor_grid_5_file$rep)
GA1_cor_grid_5_file$group <- paste0(GA1_cor_grid_5_file$snake_mu_rate, "_", GA1_cor_grid_5_file$snake_mu_effect_sd,"_",GA1_cor_grid_5_file$newt_mu_rate, "_", GA1_cor_grid_5_file$newt_mu_effect_sd)
GA1_cor_grid_5_file$sim=LETTERS[factor(GA1_cor_grid_5_file$group)]
GA1_cor_grid_5_file$grid_num = 5

GA1_cor_grid_6_file<- read.csv("~/Desktop/GA1_dif_grids/all_cor_6.txt" , header = TRUE)
GA1_cor_grid_6_file$group_rep <- paste0(GA1_cor_grid_6_file$snake_mu_rate, "_", GA1_cor_grid_6_file$snake_mu_effect_sd,"_",GA1_cor_grid_6_file$newt_mu_rate, "_", GA1_cor_grid_6_file$newt_mu_effect_sd, "_", GA1_cor_grid_6_file$rep)
GA1_cor_grid_6_file$group <- paste0(GA1_cor_grid_6_file$snake_mu_rate, "_", GA1_cor_grid_6_file$snake_mu_effect_sd,"_",GA1_cor_grid_6_file$newt_mu_rate, "_", GA1_cor_grid_6_file$newt_mu_effect_sd)
GA1_cor_grid_6_file$sim=LETTERS[factor(GA1_cor_grid_6_file$group)]
GA1_cor_grid_6_file$grid_num = 6

GA1_cor_grid_7_file<- read.csv("~/Desktop/GA1_dif_grids/all_cor_7.txt" , header = TRUE)
GA1_cor_grid_7_file$group_rep <- paste0(GA1_cor_grid_7_file$snake_mu_rate, "_", GA1_cor_grid_7_file$snake_mu_effect_sd,"_",GA1_cor_grid_7_file$newt_mu_rate, "_", GA1_cor_grid_7_file$newt_mu_effect_sd, "_", GA1_cor_grid_7_file$rep)
GA1_cor_grid_7_file$group <- paste0(GA1_cor_grid_7_file$snake_mu_rate, "_", GA1_cor_grid_7_file$snake_mu_effect_sd,"_",GA1_cor_grid_7_file$newt_mu_rate, "_", GA1_cor_grid_7_file$newt_mu_effect_sd)
GA1_cor_grid_7_file$sim=LETTERS[factor(GA1_cor_grid_7_file$group)]
GA1_cor_grid_7_file$grid_num = 7

# GA1_grid_grid_2_file<- read.csv("~/Desktop/GA1_dif_grids/all_grid_2.txt" , header = TRUE)
# GA1_grid_grid_2_file$group_rep <- paste0(GA1_grid_grid_2_file$snake_mu_rate, "_", GA1_grid_grid_2_file$snake_mu_effect_sd,"_",GA1_grid_grid_2_file$newt_mu_rate, "_", GA1_grid_grid_2_file$newt_mu_effect_sd, "_", GA1_grid_grid_2_file$rep)
# GA1_grid_grid_2_file$group <- paste0(GA1_grid_grid_2_file$snake_mu_rate, "_", GA1_grid_grid_2_file$snake_mu_effect_sd,"_",GA1_grid_grid_2_file$newt_mu_rate, "_", GA1_grid_grid_2_file$newt_mu_effect_sd)
# GA1_grid_grid_2_file$sim=LETTERS[factor(GA1_grid_grid_2_file$group)]
# GA1_grid_grid_2_file$grid_num = 2
# 
# 
# GA1_grid_grid_3_file<- read.csv("~/Desktop/GA1_dif_grids/all_grid_3.txt" , header = TRUE)
# GA1_grid_grid_3_file$group_rep <- paste0(GA1_grid_grid_3_file$snake_mu_rate, "_", GA1_grid_grid_3_file$snake_mu_effect_sd,"_",GA1_grid_grid_3_file$newt_mu_rate, "_", GA1_grid_grid_3_file$newt_mu_effect_sd, "_", GA1_grid_grid_3_file$rep)
# GA1_grid_grid_3_file$group <- paste0(GA1_grid_grid_3_file$snake_mu_rate, "_", GA1_grid_grid_3_file$snake_mu_effect_sd,"_",GA1_grid_grid_3_file$newt_mu_rate, "_", GA1_grid_grid_3_file$newt_mu_effect_sd)
# GA1_grid_grid_3_file$sim=LETTERS[factor(GA1_grid_grid_3_file$group)]
# GA1_grid_grid_3_file$grid_num = 3
# 
# GA1_grid_grid_4_file<- read.csv("~/Desktop/GA1_dif_grids/all_grid_4.txt" , header = TRUE)
# GA1_grid_grid_4_file$group_rep <- paste0(GA1_grid_grid_4_file$snake_mu_rate, "_", GA1_grid_grid_4_file$snake_mu_effect_sd,"_",GA1_grid_grid_4_file$newt_mu_rate, "_", GA1_grid_grid_4_file$newt_mu_effect_sd, "_", GA1_grid_grid_4_file$rep)
# GA1_grid_grid_4_file$group <- paste0(GA1_grid_grid_4_file$snake_mu_rate, "_", GA1_grid_grid_4_file$snake_mu_effect_sd,"_",GA1_grid_grid_4_file$newt_mu_rate, "_", GA1_grid_grid_4_file$newt_mu_effect_sd)
# GA1_grid_grid_4_file$sim=LETTERS[factor(GA1_grid_grid_4_file$group)]
# GA1_grid_grid_4_file$grid_num = 4
# 
# GA1_grid_grid_5_file<- read.csv("~/Desktop/GA1_dif_grids/all_grid_5.txt" , header = TRUE)
# GA1_grid_grid_5_file$group_rep <- paste0(GA1_grid_grid_5_file$snake_mu_rate, "_", GA1_grid_grid_5_file$snake_mu_effect_sd,"_",GA1_grid_grid_5_file$newt_mu_rate, "_", GA1_grid_grid_5_file$newt_mu_effect_sd, "_", GA1_grid_grid_5_file$rep)
# GA1_grid_grid_5_file$group <- paste0(GA1_grid_grid_5_file$snake_mu_rate, "_", GA1_grid_grid_5_file$snake_mu_effect_sd,"_",GA1_grid_grid_5_file$newt_mu_rate, "_", GA1_grid_grid_5_file$newt_mu_effect_sd)
# GA1_grid_grid_5_file$sim=LETTERS[factor(GA1_grid_grid_5_file$group)]
# GA1_grid_grid_5_file$grid_num = 5
# 
# GA1_grid_grid_6_file<- read.csv("~/Desktop/GA1_dif_grids/all_grid_6.txt" , header = TRUE)
# GA1_grid_grid_6_file$group_rep <- paste0(GA1_grid_grid_6_file$snake_mu_rate, "_", GA1_grid_grid_6_file$snake_mu_effect_sd,"_",GA1_grid_grid_6_file$newt_mu_rate, "_", GA1_grid_grid_6_file$newt_mu_effect_sd, "_", GA1_grid_grid_6_file$rep)
# GA1_grid_grid_6_file$group <- paste0(GA1_grid_grid_6_file$snake_mu_rate, "_", GA1_grid_grid_6_file$snake_mu_effect_sd,"_",GA1_grid_grid_6_file$newt_mu_rate, "_", GA1_grid_grid_6_file$newt_mu_effect_sd)
# GA1_grid_grid_6_file$sim=LETTERS[factor(GA1_grid_grid_6_file$group)]
# GA1_grid_grid_6_file$grid_num = 6
# 
# GA1_grid_grid_7_file<- read.csv("~/Desktop/GA1_dif_grids/all_grid_7.txt" , header = TRUE)
# GA1_grid_grid_7_file$group_rep <- paste0(GA1_grid_grid_7_file$snake_mu_rate, "_", GA1_grid_grid_7_file$snake_mu_effect_sd,"_",GA1_grid_grid_7_file$newt_mu_rate, "_", GA1_grid_grid_7_file$newt_mu_effect_sd, "_", GA1_grid_grid_7_file$rep)
# GA1_grid_grid_7_file$group <- paste0(GA1_grid_grid_7_file$snake_mu_rate, "_", GA1_grid_grid_7_file$snake_mu_effect_sd,"_",GA1_grid_grid_7_file$newt_mu_rate, "_", GA1_grid_grid_7_file$newt_mu_effect_sd)
# GA1_grid_grid_7_file$sim=LETTERS[factor(GA1_grid_grid_7_file$group)]
# GA1_grid_grid_7_file$grid_num = 7

all_cor_grid = rbind(GA1_cor_grid_2_file, GA1_cor_grid_3_file, GA1_cor_grid_4_file,  GA1_cor_grid_5_file,  GA1_cor_grid_6_file,  GA1_cor_grid_7_file)


all_cor_grid$group_exp=paste0(all_cor_grid$group, "_", all_cor_grid$experiment)
all_cor_grid$exp_group=paste0(all_cor_grid$experiment, "_", all_cor_grid$group)




```


```{r, cor box set up}

boxplot_cors_by_gen <- function(file, title, subt, x_label, y_label, min_gen, max_gen){
 snewt$mean_res = snewt$mean_toxin+snewt$dif
  real_snewt_cor = cor(snewt$mean_toxin, snewt$mean_res)
  file$snake_newt <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  unique(file$sim)
  plot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen),]) +
  ylim(-1.1, 1.1)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_boxplot(aes(x=factor(rep), y=as.numeric(mean_newt_pheno_By_mean_snake_pheno), color = "CA"))+
  geom_hline(yintercept=real_snewt_cor, linetype="dashed")+
    geom_hline(yintercept=0, linetype="solid")+
  #geom_boxplot(aes(x=factor("CB"), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  #geom_boxplot(aes(x=factor("CC"), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  #geom_boxplot(aes(x=factor("CD"), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  theme(plot.title = element_text(size=5)) +
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())


  return(plot)
}

boxplot_cor_grid_by_gen <- function(file, title, subt, x_label, y_label, min_gen, max_gen){
 snewt$mean_res = snewt$mean_toxin+snewt$dif
  real_snewt_cor = cor(snewt$mean_toxin, snewt$mean_res)
  file$snake_newt <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  unique(file$sim)
  plot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen),]) +
  ylim(-1.1, 1.1)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_boxplot(aes(x=factor(grid_num), y=as.numeric(mean_newt_pheno_By_mean_snake_pheno), color = factor(grid_num)))+
  geom_hline(yintercept=real_snewt_cor, linetype="dashed")+
    geom_hline(yintercept=0, linetype="solid")+
  #geom_boxplot(aes(x=factor("CB"), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  #geom_boxplot(aes(x=factor("CC"), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  #geom_boxplot(aes(x=factor("CD"), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  theme(plot.title = element_text(size=5)) +
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())


  return(plot)
}


hist_cors_by_gen_col_rep <- function(file, title, subt, x_label, y_label, min_gen, max_gen){
 snewt$mean_res = snewt$mean_toxin+snewt$dif
  real_snewt_cor = cor(snewt$mean_toxin, snewt$mean_res)
   file$snake_newt <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  #unique(file$sim)
  plot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen),]) +
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=as.numeric(mean_newt_pheno_By_mean_snake_pheno),fill=factor(rep)))+
  geom_vline(xintercept=real_snewt_cor, linetype="dashed")+
  geom_vline(xintercept=0, linetype="solid")+
  #geom_boxplot(aes(x=factor("CB"), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  #geom_boxplot(aes(x=factor("CC"), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  #geom_boxplot(aes(x=factor("CD"), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  theme(plot.title = element_text(size=5)) +
  xlim(-1.1, 1.1)+
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())


  return(plot)
}

hist_cors_by_gen_col_rep_nofill <- function(file, title, subt, x_label, y_label, min_gen, max_gen){
 snewt$mean_res = snewt$mean_toxin+snewt$dif
  real_snewt_cor = cor(snewt$mean_toxin, snewt$mean_res)
  file$snake_newt <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  unique(file$sim)
  plot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen),]) +
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=as.numeric(mean_newt_pheno_By_mean_snake_pheno)))+
  geom_vline(xintercept=real_snewt_cor, linetype="dashed")+
  geom_vline(xintercept=0, linetype="solid")+
  #geom_boxplot(aes(x=factor("CB"), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  #geom_boxplot(aes(x=factor("CC"), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  #geom_boxplot(aes(x=factor("CD"), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  theme(plot.title = element_text(size=5)) +
  #stat_bin(bins=30)+
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())

suppressMessages(print(plot))

  return(plot)
}


var_cor <- function(file, cfile, title, subt, x_label, y_label, min_gen, max_gen){
  real_snewt_cor = cor(snewt$mean_toxin, snewt$mean_res)
  real_snewt_var = var(snewt$dif)
  var_cor_table=data.frame()

  
  for(i in 1:length(unique(file$snake_newt_rep))){
    pattern<-unique(file$snake_newt_rep)[i]
    temp_file<-file[which(file$gen>=min_gen & file$gen<=max_gen & file$snake_newt_rep==pattern),]
    temp_cor_file<-cfile[which(cfile$gen>=min_gen & cfile$gen<=max_gen & cfile$snake_newt_rep==pattern),]
    
    var_cor_table_temp<- data.frame("pattern"=pattern, "var"= var(temp_file$dif),"cor" = cor(temp_file$newt_toxin, temp_file$snake_res), "mean_corr" = mean(temp_cor_file$mean_newt_pheno_By_mean_snake_pheno))
    var_cor_table <- rbind(var_cor_table, var_cor_table_temp)
  }
 
  var_cor_table_temp<- data.frame("pattern"="real", "var"= real_snewt_var, "cor" = real_snewt_cor, "mean_corr" = real_snewt_cor)
  var_cor_table <- rbind(var_cor_table, var_cor_table_temp)
  
  plot <- ggplot(var_cor_table) +
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_point(aes(x=as.numeric(var), y=as.numeric(cor), color = pattern), shape=17, size=3)+
  geom_point(aes(x=as.numeric(var), y=as.numeric(mean_corr), color = pattern), size=3)+
  theme(plot.title = element_text(size=5)) +
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8))


  return(plot)
}



cor_trends_by_gen <- function(file, cfile, title, subt, x_label, x_label_cor, y_label, min_gen, max_gen, pattern){
#file=GA1_lit_grid_file
#cfile=all_cor_grid 
 # pattern="1e-11_5_1e-11_5_0"
 # pattern="1e-11_5_1e-11_5_0"  
 file$snake_newt_rep <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd,"_", file$rep)
  cfile$snake_newt_rep <- paste0(cfile$snake_mu_rate, "_", cfile$snake_mu_effect_sd, "_", cfile$newt_mu_rate, "_", cfile$newt_mu_effect_sd, "_", cfile$rep)
  
  plot_1 <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen & file$snake_newt_rep==pattern),]) +
    #geom_line(aes(generation, dif, group=rep, col="dif"))+
    ggtitle(title, subtitle = paste0(subt," pattern ", pattern, " From ", min_gen, " gen to ", max_gen, " gen"))+
    geom_line(aes(generation, Snake_mean_Pheno, group=rep, color="Snake_mean_Pheno"),)+
    geom_line(aes(generation, Newt_mean_Pheno, group=rep, color="Newt_mean_Pheno"))+
    #ylim(0,10)+
    #xlab(x_label) + ylab(y_label)+
    scale_color_manual(name = "Type",
values = c( "Snake_mean_Pheno" = "steelblue", "Newt_mean_Pheno" = "darkred"),
labels = c("Snake", "Newt"))+
    theme_bw() +theme(legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank(), axis.ticks.x = element_blank(), axis.text.x = element_blank(),
                      plot.margin=unit(c(1,1,+0.3,1), "cm"))
cor_plot <- ggplot(cfile[which(cfile$gen>=min_gen & cfile$gen<=max_gen & cfile$snake_newt_rep==pattern),]) +
    geom_line(aes(generation, mean_newt_pheno_By_mean_snake_pheno, col=factor(grid_num)))+
    #ggtitle(title, subtitle = subt) +
    ylim(-1.1, 1.1)+
    #xlab(x_label_cor) + ylab(y_label)+
    theme_bw() +theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank(),
                      plot.margin=unit(c(-0.5,1,1,1), "cm"))
  
  figure <- ggarrange(plot_1, cor_plot + font("x.text", size = 10),heights = c(2, 1.5),ncol = 1, nrow = 2, align = "v")

  return(figure)
}


pop_size_trends_by_gen <- function(file, cfile, title, subt, x_label, x_label_cor, y_label, min_gen, max_gen, pattern){
#file=GA1_lit_grid_file
#cfile=all_cor_grid 
 # pattern="1e-11_5_1e-11_5_0"
 # pattern="1e-11_5_1e-11_5_0"  
 file$snake_newt_rep <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd,"_", file$rep)
  cfile$snake_newt_rep <- paste0(cfile$snake_mu_rate, "_", cfile$snake_mu_effect_sd, "_", cfile$newt_mu_rate, "_", cfile$newt_mu_effect_sd, "_", cfile$rep)
  
  plot_1 <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen & file$snake_newt_rep==pattern),]) +
    #geom_line(aes(generation, dif, group=rep, col="dif"))+
    ggtitle(title, subtitle = paste0(subt," pattern ", pattern, " From ", min_gen, " gen to ", max_gen, " gen"))+
    geom_line(aes(generation, Snake_pop_size, group=rep, color="Snake"),)+
    geom_line(aes(generation, Newt_pop_size, group=rep, color="Newt"))+
    #ylim(0,10)+
    #xlab(x_label) + ylab(y_label)+
    scale_color_manual(name = "Type",
values = c( "Snake" = "steelblue", "Newt" = "darkred"),
labels = c("Snake", "Newt"))+
    theme_bw() +theme(legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank(), axis.ticks.x = element_blank(), axis.text.x = element_blank(),
                      plot.margin=unit(c(1,1,+0.3,1), "cm"))
cor_plot <- ggplot(cfile[which(cfile$gen>=min_gen & cfile$gen<=max_gen & cfile$snake_newt_rep==pattern),]) +
    geom_line(aes(generation, num_newts_By_num_snakes, col=factor(grid_num)))+
    #ggtitle(title, subtitle = subt) +
    ylim(-1.1, 1.1)+
    #xlab(x_label_cor) + ylab(y_label)+
    theme_bw() +theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank(),
                      plot.margin=unit(c(-0.5,1,1,1), "cm"))
  
  figure <- ggarrange(plot_1, cor_plot + font("x.text", size = 10),heights = c(2, 1.5),ncol = 1, nrow = 2, align = "v")

  return(figure)
}


four_types_boxplot_cors_by_gen <- function(file,title, subt, x_label, y_label, min_gen, max_gen){
  file$snake_newt <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  plot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen),]) +
  ylim(-1.1, 1.1)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_boxplot(aes(x=factor("CA"), y=as.numeric(mean_newt_pheno_By_mean_snake_pheno), color = "CA"))+
  geom_boxplot(aes(x=factor("CB"), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  geom_boxplot(aes(x=factor("CC"), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  geom_boxplot(aes(x=factor("CD"), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  geom_hline(yintercept=0, linetype="solid")+
  theme(plot.title = element_text(size=5)) +
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())


  return(plot)
}

```


```{r, general file and graph making}

#the functions to make the params file and the summary and heatmap figures 

create_parm_file <- function(file, min_gen, max_gen){
params <- data_frame()

for(i in 1:length(unique(file$snake_newt_rep))){

  pattern=unique(file$snake_newt_rep)[i]
  sumitup <- file[which(file$gen>=min_gen & file$gen<=max_gen & file$snake_newt_rep ==pattern),]
 
  params_temp<- data_frame(Newt_mean_Pheno=mean(sumitup$Newt_mean_Pheno),
                           Snake_mean_Pheno=mean(sumitup$Snake_mean_Pheno), 
                           Newt_mean_Pheno_sd=sd(sumitup$Newt_mean_Pheno),
                           Snake_mean_Pheno_sd=sd(sumitup$Snake_mean_Pheno),
                           Newt_pop_size=mean(sumitup$Newt_pop_size),
                           Snake_pop_size=mean(sumitup$Snake_pop_size),
                           dif=mean(sumitup$dif),
                           snake_mu_rate=sumitup$snake_mu_rate[1],
                           newt_mu_rate=sumitup$newt_mu_rate[1],
                           snake_mu_effect_sd=sumitup$snake_mu_effect_sd[1],
                           newt_mu_effect_sd=sumitup$newt_mu_effect_sd[1],
                           rep=sumitup$rep[1])
  
  
  params <- rbind(params, params_temp)
}

params$snake <- paste0(params$snake_mu_rate, "_",params$snake_mu_effect_sd)
params$newt <- paste0(params$newt_mu_rate, "_",params$newt_mu_effect_sd)
params$snake_newt <- paste0(params$snake, "_", params$newt)
return(params)
}

GA_summary <- function(file, min_gen, max_gen, x_line, y_line, title, subt, y_label, x_label){

file$snake_newt_rep <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd, "_", file$rep)

params<-create_parm_file(file, min_gen, max_gen)

my_plot <- ggplot(params) +
  #xlim(0, 1000)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_point(aes(x=as.numeric(get(x_line)), y=as.numeric(get(y_line)), color = factor(snake), shape=factor(newt)),size=3)+
#  geom_point(aes(x=as.numeric(Newt_pop_size_20), y=as.numeric(Snake_pop_size_20), color = factor(snake), shape=factor(newt)))+
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  #facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text( hjust=1, size = 8))

return(my_plot)
}
GA_summary_by_species <- function(file, min_gen, max_gen, x_line, y_line, title, subt, y_label, x_label){

file$snake_newt_rep <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd, "_", file$rep)

params<-create_parm_file(file, min_gen, max_gen)

my_plot <- ggplot(params) +
  #xlim(0, 1000)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_point(aes(x=(get(x_line)), y=(get(y_line)), color = factor(snake), shape=factor(newt)),size=3)+
#  geom_point(aes(x=as.numeric(Newt_pop_size_20), y=as.numeric(Snake_pop_size_20), color = factor(snake), shape=factor(newt)))+
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  #facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text( hjust=1, size = 8))

return(my_plot)
}

build_heatmap <- function(file, min_gen, max_gen, fill_line, fill_line_text, title, subt, y_label, x_label, red_blue=F){
  file$snake_newt_rep <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd, "_", file$rep)
  params<-create_parm_file(file, min_gen, max_gen)
  
 my_plot <- ggplot(params, aes(newt, paste0(snake, "_", rep))) +    # Create heatmap with ggplot2
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_tile(aes(fill = get(fill_line)))+theme(axis.text.x = element_text(angle = 45, hjust=1, size = 10), axis.text.y = element_text(size = 10))
 
 if(red_blue==FALSE){
  my_plot<- my_plot + scale_fill_viridis_c(name = fill_line_text) + theme(legend.text=element_text(angle = 45, hjust=1, size=10))
  }
 if(red_blue==TRUE){
  my_plot<- my_plot + scale_fill_gradient2(low = "red",mid = "beige", high = "blue", name = fill_line_text) + theme(legend.text=element_text(size=5))
 }
 
  return(my_plot)
}

trends_by_gen <- function(file, title, subt, x_label, y_label, min_gen, max_gen, rep){
 
  plot <- ggplot(file[ which(file$generation>=min_gen & file$generation<=max_gen),]) +
    facet_wrap(~sim)+
    geom_line(aes(generation, dif, group=rep, col="dif"))+
    ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
    geom_line(aes(generation, Snake_mean_Pheno, group=rep, color="Snake_mean_Pheno"),)+
    geom_line(aes(generation, Newt_mean_Pheno, group=rep, color="Newt_mean_Pheno"))+
    geom_hline(yintercept=0, linetype="dashed", color="gray54")+
    #ylim(-1.,2.5)+
    xlab(x_label) + ylab(y_label)+
    scale_color_manual(name = "Type",
values = c( "Snake_mean_Pheno" = "steelblue", "Newt_mean_Pheno" = "darkred", "dif" = "black"),
labels = c("Snake", "Newt", "Dif"))+
    theme_bw() + theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())
  return(plot)
}

whale_gen <- function(file, title, subt, x_label, y_label,min_gen, max_gen, rep){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
dif <- ggplot(file[ which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep),]) +
  #xlim(0, 1000)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen, rep ",rep)) +
  xlab(x_label) + ylab(y_label)+
  geom_point(aes(x=as.numeric(Newt_pop_size), y=as.numeric(Snake_pop_size), color = dif))+
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}


pop_size_hist <- function(file, title, subt, x_label, y_label,min_gen, max_gen, rep){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  file<-file[ which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep),]
  themin <- min(file$Snake_pop_size-file$Newt_pop_size) 
  themax <- max(file$Snake_pop_size-file$Newt_pop_size)
  true_max <- max(abs(themin), abs(themax))
dif <- ggplot(file) +
  #xlim(0, 1000)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(Snake_pop_size-Newt_pop_size), fill="darkolivegreen4")+
  xlim((-1*themax)-5, themax+5)+
  theme(plot.title = element_text(size=5)) +
  facet_wrap(~sim)+
  geom_vline(xintercept = 0)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)
}

pheno_dif_hist <- function(file, title, subt, x_label, y_label,min_gen, max_gen, rep){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  file<-file[ which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep),]
  
  themin <- min(file$dif) 
  themax <- max(file$dif)
  true_max <- max(abs(themin), abs(themax))
dif <- ggplot(file) +
  #xlim(0, 1000)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen, rep ",rep)) +
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(dif), fill="aquamarine4")+
  xlim((-1*true_max)-1, true_max+1)+

  # y=as.numeric(Snake_pop_size-Newt_pop_size), color = snake_GA, shape = factor(newt_GA)
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  geom_vline(xintercept = 0)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}




two_hist <- function(file, title, subt, x_label, y_label,min_gen, max_gen, rep){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  
  file<-file[ which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep),]
  
  thepopmin <- min(file$Snake_pop_size-file$Newt_pop_size)/100 
  thepopmax <- max(file$Snake_pop_size-file$Newt_pop_size)/100
  thedifmin <- min(file$dif) 
  thedifmax <- max(file$dif)
  true_max <- max(abs(thepopmin), abs(thepopmax),abs(thedifmin), abs(thedifmax))

  data_points <- nrow(file[which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep &  file$snake_GA==file$snake_GA[1] &  file$newt_GA==file$newt_GA[1]),])
dif <- ggplot(file) +
  
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen, rep ",rep)) +
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=dif, y=..count../data_points), fill="#8B008B",  alpha = 0.65)+
  geom_histogram(aes(x=(Snake_pop_size-Newt_pop_size)/100, y=..count../data_points), fill="#008B00",  alpha = 0.65)+
  scale_y_continuous(labels = scales::percent)+
  xlim((-1*true_max)-1, true_max+1)+
  # y=as.numeric(Snake_pop_size-Newt_pop_size), color = snake_GA, shape = factor(newt_GA)
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  geom_vline(xintercept = 0)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}

two_hist_all_rep <- function(file, title, subt, x_label, y_label,min_gen, max_gen){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  
  file<-file[ which(file$generation>=min_gen & file$generation<=max_gen),]
  
  thepopmin <- min(file$Snake_pop_size-file$Newt_pop_size)/100 
  thepopmax <- max(file$Snake_pop_size-file$Newt_pop_size)/100
  thedifmin <- min(file$dif) 
  thedifmax <- max(file$dif)
  true_max <- max(abs(thepopmin), abs(thepopmax),abs(thedifmin), abs(thedifmax))

  data_points <- nrow(file[which(file$generation>=min_gen & file$generation<=max_gen  &  file$snake_GA==file$snake_GA[1] &  file$newt_GA==file$newt_GA[1]),])
  
dif <- ggplot(file) +
  
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=dif, y=..count../data_points), fill="#8B008B",  alpha = 0.65, bins = 20)+ #purple
  geom_histogram(aes(x=(Snake_pop_size-Newt_pop_size)/100, y=..count../data_points), fill="#008B00",  alpha = 0.65, bins = 20)+ #green
  scale_y_continuous(labels = scales::percent)+
  xlim((-1*true_max)-1, true_max+1)+
  # y=as.numeric(Snake_pop_size-Newt_pop_size), color = snake_GA, shape = factor(newt_GA)
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  geom_vline(xintercept = 0)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      #strip.background = element_blank(), 
                      strip.text.x = element_blank(), 
                      #panel.grid.major = element_blank(), 
                      #panel.grid.minor = element_blank(),
                      #panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}

two_hist_death_all_rep <- function(file, title, subt, x_label, y_label,min_gen, max_gen){
  #file=GA1_lit_grid_file
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  
  file<-file[ which(file$generation>=min_gen & file$generation<=max_gen),]
  
  thepopmin <- min(file$newt_deaths)
  thepopmax <- max(file$newt_deaths)
  thedifmin <- min(file$snake_deaths) 
  thedifmax <- max(file$snake_deaths)
  true_max <- max(abs(thepopmin), abs(thepopmax),abs(thedifmin), abs(thedifmax))

  data_points <- nrow(file[which(file$generation>=min_gen & file$generation<=max_gen  &  file$snake_GA==file$snake_GA[1] &  file$newt_GA==file$newt_GA[1]),])
  
dif <- ggplot(file) +
  
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=newt_deaths), fill="red",  alpha = 0.65, bins = 20)+
  geom_histogram(aes(x=snake_deaths), fill="blue",  alpha = 0.65, bins = 20)+
  #scale_y_continuous(labels = scales::percent)+
  #xlim((-1*true_max)-1, true_max+1)+
  # y=as.numeric(Snake_pop_size-Newt_pop_size), color = snake_GA, shape = factor(newt_GA)
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  #geom_vline(xintercept = 0)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      #strip.background = element_blank(), 
                      strip.text.x = element_blank(), 
                      #panel.grid.major = element_blank(), 
                      #panel.grid.minor = element_blank(),
                      #panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}

grid_plot<- function(file_name, spegen, file, type, row_num, col_num){
file$snake_newt_rep <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd,"_",file$newt_mu_rate, "_", file$newt_mu_effect_sd, "_", file$rep)

GA1<-file[which(file$snake_newt_rep==file_name & file$generation==spegen),]
GA1_type = paste0("generation|", type)  

GA1_type = GA1[,grepl(GA1_type, names(GA1)) ]
GA1_type <- GA1_type[-1]

data_long_type_comp <- gather(GA1_type, condition, measurement, factor_key=TRUE)
data_long_type_comp[,c("species","type", "type2","location")]<- str_split_fixed(data_long_type_comp$condition, "_", 4)

data_long_type_comp$y_loc<- rep(sort(c(rep.int(row_num:1, 2)), decreasing = TRUE),col_num)

data_long_type_comp$x_loc<- sort(rep.int(1:col_num, row_num*2))
  
main_plot<-ggplot(data_long_type_comp)+
  
  geom_point(data = data_long_type_comp[which(data_long_type_comp$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = data_long_type_comp[which(data_long_type_comp$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c()+
  #ylim(0, row_num)+
  #xlim(0, col_num)+
  theme_bw()+
  theme(legend.justification = "top")

if(type != "num_ind"){
main_plot<- main_plot + labs(title = paste0(str_to_title(type)," Phenotype of Locations"),
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Toxicity/Resistance")+
 scale_fill_viridis_c()
}
if(type == "num_ind"){
main_plot<- main_plot + labs(title = paste0(str_to_title(type)," Phenotype of Locations"),
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Newt/Snake Phenotype")+
scale_fill_viridis_c(option = "plasma")
} 
  

snake<-data_long_type_comp[which(data_long_type_comp$species=="snake"),]
newt<-data_long_type_comp[which(data_long_type_comp$species=="newt"),]
newt$snake_value <- snake$measurement
print(cor(as.numeric(snake$measurement), as.numeric(newt$measurement), use="complete.obs"))

newt$info <- "middle"
newt$info[newt$location %in% c(0, col_num-1, col_num*row_num-1-col_num, col_num*row_num-1)] <- "corner"

newt$info[newt$location %in% c(c(1:(col_num-2)), seq(col_num, (col_num*row_num-col_num-2), col_num), seq((col_num-1+col_num), (col_num*row_num-1-col_num-col_num), col_num),  c((col_num*row_num-col_num):(col_num*row_num-2)))]   <- "edge"




extra_plot <- ggplot(newt)+
  ggtitle("Mean Phenotype") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))



final_plot <- main_plot +  inset_element(extra_plot, left = 1., bottom = -0.10, right = 1.35, top = 0.5)
return(final_plot)}


```

generations
```{r, graphing by gen}
trends_by_gen(GA1_lit_grid_file, title="Space Tall: Newt VS Snake Population Size GA1", subt="Gen 16sims", y_label="Mean Phenotype", x_label="Generations", 100, 50000, rep=1)


 

```
```{r, whale}
min_gen=5000
max_gen=10000
rep=1

whale_gen(GA1_lit_grid_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Phenotype", min_gen=min_gen, max_gen=max_gen, rep=rep )
```
```{r, combo myplots}


ginmin = 10000
ginmax = 15000

boxplot_cors_by_gen(GA1_cor_grid_2_file, "Simulation Correlation Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)

boxplot_cors_by_gen(GA1_cor_grid_3_file, "Simulation Correlation Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)

boxplot_cors_by_gen(GA1_cor_grid_4_file, "Simulation Correlation Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)

boxplot_cors_by_gen(GA1_cor_grid_5_file, "Simulation Correlation Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)

boxplot_cors_by_gen(GA1_cor_grid_6_file, "Simulation Correlation Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)

boxplot_cors_by_gen(GA1_cor_grid_7_file, "Simulation Correlation Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)

#four_types_boxplot_cors_by_gen(all_cor_grid, "Simulation four Correlation", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)


```


## Correlation Histograms  {.tabset}

In order to understand how spatial correlations where changing with time I took 5,000 generation time slices to look at all four trials correlation values. Each color is a different trial per GA combination. The histogram values are stacked. This section only looks at the 5 sections.

### Plot 1
```{r, GA1 cor by dif windows}
ginmin = 0
ginmax = 5000
boxplot_cor_grid_by_gen(all_cor_grid, "Simulation Correlation Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)
```

### Plot 2

```{r, GA1 cor by dif windows 2}
ginmin = 5000
ginmax = 10000
boxplot_cor_grid_by_gen(all_cor_grid, "Simulation Correlation Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)
```

### Plot 3
```{r, GA1 cor by dif windows 3}
ginmin = 10000
ginmax = 15000
boxplot_cor_grid_by_gen(all_cor_grid, "Simulation Correlation Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)
```

### Plot 4
```{r, GA1 cor by dif windows 4}
ginmin = 15000
ginmax = 20000
boxplot_cor_grid_by_gen(all_cor_grid, "Simulation Correlation Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)
```

### Plot 5
```{r, GA1 cor by dif windows 5}
ginmin = 20000
ginmax = 25000
boxplot_cor_grid_by_gen(all_cor_grid, "Simulation Correlation Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)
```

### Plot 6
```{r, GA1 cor by dif windows 6}
ginmin = 25000
ginmax = 30000
boxplot_cor_grid_by_gen(all_cor_grid, "Simulation Correlation Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)
```

### Plot 7
```{r, GA1 cor by dif windows 7}
ginmin = 30000
ginmax = 35000
boxplot_cor_grid_by_gen(all_cor_grid, "Simulation Correlation Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)
```

### Plot 8
```{r, GA1 cor by dif windows 8}
ginmin = 35000
ginmax = 40000
boxplot_cor_grid_by_gen(all_cor_grid, "Simulation Correlation Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)
```

### Plot 9
```{r, GA1 cor by dif windows 9}
ginmin = 40000
ginmax = 45000
boxplot_cor_grid_by_gen(all_cor_grid, "Simulation Correlation Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)
```

### Plot 10
```{r, GA1 cor by dif windows 10}
ginmin = 45000
ginmax = 50000
boxplot_cor_grid_by_gen(all_cor_grid, "Simulation Correlation Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)
```

## {-}


## Phenotype Correlation across time {.tabset}

Next, we will examine three randomly chosen plots from both the 5 section and 7 section experiment. Time (in generations) in on the x-axis and both mean phenotype and phenotype spatial correlation in on the y-axis. Newt whole population mean phenotype is red, while snake mean phenotype is blue. The pink line is the phenotype spatial correlation.  


### Random 1 (5 sec)
```{r, GA1 cor and pheno}
GA1_pattern <- unique(paste0(GA1_lit_grid_file$snake_mu_rate, "_", GA1_lit_grid_file$snake_mu_effect_sd,"_",GA1_lit_grid_file$newt_mu_rate, "_", GA1_lit_grid_file$newt_mu_effect_sd, "_", GA1_lit_grid_file$rep))

myrandomlist=sample.int(length(GA1_pattern), 3)


cor_trends_by_gen(GA1_lit_grid_file, all_cor_grid, "test", "GA1", "newt/snake GAs&rep","other", "Cor", min_gen=100, max_gen=50000, pattern=GA1_pattern[myrandomlist[1]])

```

### Random 2 (5 sec)
```{r, random cor-pheno plot 2}

cor_trends_by_gen(GA1_lit_grid_file, all_cor_grid, "test", "GA1", "newt/snake GAs&rep","other", "Cor", min_gen=100, max_gen=50000, pattern=GA1_pattern[myrandomlist[2]])
```

### Random 3 (5 sec)
```{r, random cor-pheno plot 3}

cor_trends_by_gen(GA1_lit_grid_file, all_cor_grid, "test", "GA1", "newt/snake GAs&rep","other", "Cor", min_gen=100, max_gen=50000, pattern=GA1_pattern[myrandomlist[3]])
```

## {-}



## Population Size Correlation across time {.tabset}



### Random 1 
```{r, GA1 pop size 1}
pop_size_trends_by_gen(GA1_lit_grid_file, all_cor_grid, "test", "GA1", "newt/snake GAs&rep","other", "Cor", min_gen=100, max_gen=50000, pattern=GA1_pattern[myrandomlist[1]])

```

### Random 2 
```{r, random pop size plot 2}

pop_size_trends_by_gen(GA1_lit_grid_file, all_cor_grid, "test", "GA1", "newt/snake GAs&rep","other", "Cor", min_gen=100, max_gen=50000, pattern=GA1_pattern[myrandomlist[2]])
```

### Random 3 
```{r, random pop size plot 3}

pop_size_trends_by_gen(GA1_lit_grid_file, all_cor_grid, "test", "GA1", "newt/snake GAs&rep","other", "Cor", min_gen=100, max_gen=50000, pattern=GA1_pattern[myrandomlist[3]])
```

## {-}


```{r, red in grid files}
require(readr)
GA1_grid_grid_2_file<- read.csv("~/Desktop/GA1_dif_grids/all_grid_2.txt" , header = TRUE) %>%  filter(between(generation, 9000, 10000))
GA1_grid_grid_2_file$group_rep <- paste0(GA1_grid_grid_2_file$snake_mu_rate, "_", GA1_grid_grid_2_file$snake_mu_effect_sd,"_",GA1_grid_grid_2_file$newt_mu_rate, "_", GA1_grid_grid_2_file$newt_mu_effect_sd, "_", GA1_grid_grid_2_file$rep)
GA1_grid_grid_2_file$group <- paste0(GA1_grid_grid_2_file$snake_mu_rate, "_", GA1_grid_grid_2_file$snake_mu_effect_sd,"_",GA1_grid_grid_2_file$newt_mu_rate, "_", GA1_grid_grid_2_file$newt_mu_effect_sd)
GA1_grid_grid_2_file$sim=LETTERS[factor(GA1_grid_grid_2_file$group)]
GA1_grid_grid_2_file$grid_num = 2


GA1_grid_grid_3_file<- read.csv("~/Desktop/GA1_dif_grids/all_grid_3.txt" , header = TRUE)%>%  filter(between(generation, 9000, 10000))
GA1_grid_grid_3_file$group_rep <- paste0(GA1_grid_grid_3_file$snake_mu_rate, "_", GA1_grid_grid_3_file$snake_mu_effect_sd,"_",GA1_grid_grid_3_file$newt_mu_rate, "_", GA1_grid_grid_3_file$newt_mu_effect_sd, "_", GA1_grid_grid_3_file$rep)
GA1_grid_grid_3_file$group <- paste0(GA1_grid_grid_3_file$snake_mu_rate, "_", GA1_grid_grid_3_file$snake_mu_effect_sd,"_",GA1_grid_grid_3_file$newt_mu_rate, "_", GA1_grid_grid_3_file$newt_mu_effect_sd)
GA1_grid_grid_3_file$sim=LETTERS[factor(GA1_grid_grid_3_file$group)]
GA1_grid_grid_3_file$grid_num = 3

GA1_grid_grid_4_file<- read.csv("~/Desktop/GA1_dif_grids/all_grid_4.txt" , header = TRUE)%>%  filter(between(generation, 9000, 10000))
GA1_grid_grid_4_file$group_rep <- paste0(GA1_grid_grid_4_file$snake_mu_rate, "_", GA1_grid_grid_4_file$snake_mu_effect_sd,"_",GA1_grid_grid_4_file$newt_mu_rate, "_", GA1_grid_grid_4_file$newt_mu_effect_sd, "_", GA1_grid_grid_4_file$rep)
GA1_grid_grid_4_file$group <- paste0(GA1_grid_grid_4_file$snake_mu_rate, "_", GA1_grid_grid_4_file$snake_mu_effect_sd,"_",GA1_grid_grid_4_file$newt_mu_rate, "_", GA1_grid_grid_4_file$newt_mu_effect_sd)
GA1_grid_grid_4_file$sim=LETTERS[factor(GA1_grid_grid_4_file$group)]
GA1_grid_grid_4_file$grid_num = 4

GA1_grid_grid_5_file<- read.csv("~/Desktop/GA1_dif_grids/all_grid_5.txt" , header = TRUE)%>%  filter(between(generation, 9000, 10000))
GA1_grid_grid_5_file$group_rep <- paste0(GA1_grid_grid_5_file$snake_mu_rate, "_", GA1_grid_grid_5_file$snake_mu_effect_sd,"_",GA1_grid_grid_5_file$newt_mu_rate, "_", GA1_grid_grid_5_file$newt_mu_effect_sd, "_", GA1_grid_grid_5_file$rep)
GA1_grid_grid_5_file$group <- paste0(GA1_grid_grid_5_file$snake_mu_rate, "_", GA1_grid_grid_5_file$snake_mu_effect_sd,"_",GA1_grid_grid_5_file$newt_mu_rate, "_", GA1_grid_grid_5_file$newt_mu_effect_sd)
GA1_grid_grid_5_file$sim=LETTERS[factor(GA1_grid_grid_5_file$group)]
GA1_grid_grid_5_file$grid_num = 5

GA1_grid_grid_6_file<- read.csv("~/Desktop/GA1_dif_grids/all_grid_6.txt" , header = TRUE)%>%  filter(between(generation, 9000, 10000))
GA1_grid_grid_6_file$group_rep <- paste0(GA1_grid_grid_6_file$snake_mu_rate, "_", GA1_grid_grid_6_file$snake_mu_effect_sd,"_",GA1_grid_grid_6_file$newt_mu_rate, "_", GA1_grid_grid_6_file$newt_mu_effect_sd, "_", GA1_grid_grid_6_file$rep)
GA1_grid_grid_6_file$group <- paste0(GA1_grid_grid_6_file$snake_mu_rate, "_", GA1_grid_grid_6_file$snake_mu_effect_sd,"_",GA1_grid_grid_6_file$newt_mu_rate, "_", GA1_grid_grid_6_file$newt_mu_effect_sd)
GA1_grid_grid_6_file$sim=LETTERS[factor(GA1_grid_grid_6_file$group)]
GA1_grid_grid_6_file$grid_num = 6

GA1_grid_grid_7_file<- read.csv("~/Desktop/GA1_dif_grids/all_grid_7.txt" , header = TRUE)%>%  filter(between(generation, 9000, 10000))
GA1_grid_grid_7_file$group_rep <- paste0(GA1_grid_grid_7_file$snake_mu_rate, "_", GA1_grid_grid_7_file$snake_mu_effect_sd,"_",GA1_grid_grid_7_file$newt_mu_rate, "_", GA1_grid_grid_7_file$newt_mu_effect_sd, "_", GA1_grid_grid_7_file$rep)
GA1_grid_grid_7_file$group <- paste0(GA1_grid_grid_7_file$snake_mu_rate, "_", GA1_grid_grid_7_file$snake_mu_effect_sd,"_",GA1_grid_grid_7_file$newt_mu_rate, "_", GA1_grid_grid_7_file$newt_mu_effect_sd)
GA1_grid_grid_7_file$sim=LETTERS[factor(GA1_grid_grid_7_file$group)]
GA1_grid_grid_7_file$grid_num = 7

```

## Grid Figs {.tabset}


### 2 
```{r, cor grid 2 high cor mean}

file=GA1_grid_grid_2_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=9981
type="mean"
col_num=2
row_num=col_num*4


grid_plot(file_name, spegen, file, type, row_num, col_num)
```

### 3 
```{r, cor grid 3 high cor mean}

file=GA1_grid_grid_3_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=9501
type="mean"
col_num=3
row_num=col_num*4

grid_plot(file_name, spegen, file, type, row_num, col_num)
```

### 4 
```{r, cor grid 4 high cor mean}

file=GA1_grid_grid_4_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=9501
type="mean"
col_num=4
row_num=col_num*4

grid_plot(file_name, spegen, file, type, row_num, col_num)
```


### 5
```{r, cor grid 5 high cor mean}

file=GA1_grid_grid_5_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=9501
type="mean"
col_num=5
row_num=col_num*4

grid_plot(file_name, spegen, file, type, row_num, col_num)
```

### 6 
```{r, cor grid 6 high cor mean}

file=GA1_grid_grid_6_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=9501
type="mean"
col_num=6
row_num=col_num*4

grid_plot(file_name, spegen, file, type, row_num, col_num)
```

### 7
```{r, cor grid 7 high cor mean}

file=GA1_grid_grid_7_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=9501
type="mean"
col_num=7
row_num=col_num*4

grid_plot(file_name, spegen, file, type, row_num, col_num)
```

### 2 Pop Size
```{r, cor grid 2 popsize}

file=GA1_grid_grid_2_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=9501
type="num_ind"
col_num=2
row_num=col_num*4
grid_plot(file_name, spegen, file, type, row_num, col_num)

```

### 3 Pop Size
```{r, cor grid 3 popsize}

file=GA1_grid_grid_3_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=9501
type="num_ind"
col_num=3
row_num=col_num*4
grid_plot(file_name, spegen, file, type, row_num, col_num)

```

### 4 Pop Size
```{r, cor grid 4 popsize}

file=GA1_grid_grid_4_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=9501
type="num_ind"
col_num=4
row_num=col_num*4
grid_plot(file_name, spegen, file, type, row_num, col_num)

```

### 5 Pop Size
```{r, cor grid 5 popsize}

file=GA1_grid_grid_5_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=9501
type="num_ind"
col_num=5
row_num=col_num*4
grid_plot(file_name, spegen, file, type, row_num, col_num)

```

### 6 Pop Size
```{r, cor grid 6 popsize}

file=GA1_grid_grid_6_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=9501
type="num_ind"
col_num=6
row_num=col_num*4
grid_plot(file_name, spegen, file, type, row_num, col_num)

```

### 7 Pop Size
```{r, cor grid 7 popsize}

file=GA1_grid_grid_7_file
file_name=GA1_pattern[myrandomlist[1]]
spegen=9501
type="num_ind"
col_num=7
row_num=col_num*4
grid_plot(file_name, spegen, file, type, row_num, col_num)

```
## {-}
