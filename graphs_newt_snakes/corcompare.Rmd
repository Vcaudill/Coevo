---
title: "Cor Compare"
output: html_document
date: '2022-08-26'
---

```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE,echo = FALSE) 

library(ggplot2)
library(viridis)
library(colorspace)
library(gridExtra)
library(tidyverse)
require(reshape2)
library(plyr)
library(gridGraphics)
library(grid)
library(knitr)
library("reshape")
library(dplyr)
library(ggside)
```

## Corilation Compare!

I have run four separate experiments and now I will compare their different correlations to see if I can tell the difference between each of the four experiments.

Experiments:

- [A] tall map with 5 sections
- [B] tall map with 7 sections
- [C] tall map with 5 sections no heritability
- [D] tall map with 5 sections no interaction

I am investigating the correlation calculations. I predicted that though co-evolution (interaction & evolution) species' phenotypes would become spatially correlated. I saw some very high correlations (around 0.5) in some of these simulations. To see if there is a difference between the correlations in my experiment I will create some comparative histograms.

Predictions:

-  5 sections & 7 sections will have *similar* correlation distributions
- no heritability & no interaction correlation distributions will look *very different* from 5 sections & 7 sections


```{r, loading in the data}

snewt <- read.csv("~/Desktop/snake_newt_real_data.csv", header = TRUE)

GA1_cor_tall_file<- read.csv("~/Desktop/GA1_tall_redo/all_cor.txt" , header = TRUE)
GA1_cor_tall_file$group_rep <- paste0(GA1_cor_tall_file$snake_mu_rate, "_", GA1_cor_tall_file$snake_mu_effect_sd,"_",GA1_cor_tall_file$newt_mu_rate, "_", GA1_cor_tall_file$newt_mu_effect_sd, "_", GA1_cor_tall_file$rep)
GA1_cor_tall_file$group <- paste0(GA1_cor_tall_file$snake_mu_rate, "_", GA1_cor_tall_file$snake_mu_effect_sd,"_",GA1_cor_tall_file$newt_mu_rate, "_", GA1_cor_tall_file$newt_mu_effect_sd)
GA1_cor_tall_file$sim=LETTERS[factor(GA1_cor_tall_file$group)]
GA1_cor_tall_file$experiment = "A"
toDelete <- seq(2, nrow(GA1_cor_tall_file), 2)
GA1_cor_tall_file_even = GA1_cor_tall_file[-toDelete,]

GA1_cor_tall_7_file<- read.csv("~/Desktop/GA1_tall_redo/all_cor_7.txt" , header = TRUE)
GA1_cor_tall_7_file$group_rep <- paste0(GA1_cor_tall_7_file$snake_mu_rate, "_", GA1_cor_tall_7_file$snake_mu_effect_sd,"_",GA1_cor_tall_7_file$newt_mu_rate, "_", GA1_cor_tall_7_file$newt_mu_effect_sd, "_", GA1_cor_tall_7_file$rep)
GA1_cor_tall_7_file$group <- paste0(GA1_cor_tall_7_file$snake_mu_rate, "_", GA1_cor_tall_7_file$snake_mu_effect_sd,"_",GA1_cor_tall_7_file$newt_mu_rate, "_", GA1_cor_tall_7_file$newt_mu_effect_sd)
GA1_cor_tall_7_file$sim=LETTERS[factor(GA1_cor_tall_7_file$group)]
GA1_cor_tall_7_file$experiment = "B"
toDelete <- seq(2, nrow(GA1_cor_tall_7_file), 2)
GA1_cor_tall_7_file_even = GA1_cor_tall_7_file[-toDelete,]


her_cor_tall_file<- read.csv("~/Desktop/no_hair/all_cor.txt", header = TRUE)
her_cor_tall_file$group_rep <- paste0(her_cor_tall_file$snake_mu_rate, "_", her_cor_tall_file$snake_mu_effect_sd,"_",her_cor_tall_file$newt_mu_rate, "_", her_cor_tall_file$newt_mu_effect_sd, "_", her_cor_tall_file$rep)
her_cor_tall_file$group <- paste0(her_cor_tall_file$snake_mu_rate, "_", her_cor_tall_file$snake_mu_effect_sd,"_",her_cor_tall_file$newt_mu_rate, "_", her_cor_tall_file$newt_mu_effect_sd)
her_cor_tall_file$sim=LETTERS[factor(her_cor_tall_file$group)]
her_cor_tall_file$experiment = "C"
toDelete <- seq(2, nrow(her_cor_tall_file), 2)
her_cor_tall_file_even = her_cor_tall_file[-toDelete,]

inter_cor_tall_file<- read.csv("~/Desktop/no_interaction/all_cor.txt", header = TRUE)
inter_cor_tall_file$group_rep <- paste0(inter_cor_tall_file$snake_mu_rate, "_", inter_cor_tall_file$snake_mu_effect_sd,"_",inter_cor_tall_file$newt_mu_rate, "_", inter_cor_tall_file$newt_mu_effect_sd, "_", inter_cor_tall_file$rep)
inter_cor_tall_file$group <- paste0(inter_cor_tall_file$snake_mu_rate, "_", inter_cor_tall_file$snake_mu_effect_sd,"_",inter_cor_tall_file$newt_mu_rate, "_", inter_cor_tall_file$newt_mu_effect_sd)
inter_cor_tall_file$sim=LETTERS[factor(inter_cor_tall_file$group)]
inter_cor_tall_file$experiment = "D"


all_cor_exp = rbind(GA1_cor_tall_file_even, GA1_cor_tall_7_file_even, her_cor_tall_file_even, inter_cor_tall_file)

all_cor_exp$group_exp=paste0(all_cor_exp$group, "_", all_cor_exp$experiment)
all_cor_exp$exp_group=paste0(all_cor_exp$experiment, "_", all_cor_exp$group)


```

```{r, making the fig}

hist_cors_by_gen_col_all_exp_rep <- function(file, title, subt, x_label, y_label, min_gen, max_gen){
 snewt$mean_res = snewt$mean_toxin+snewt$dif
  real_snewt_cor = cor(snewt$mean_toxin, snewt$mean_res)
   file$snake_newt <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  #unique(file$sim)
  plot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen),]) +
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=as.numeric(mean_newt_pheno_By_mean_snake_pheno),fill=factor(experiment)), alpha=0.4, position="identity")+
  geom_vline(xintercept=real_snewt_cor, linetype="dashed")+
  geom_vline(xintercept=0, linetype="solid")+
  #geom_boxplot(aes(x=factor("CB"), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  #geom_boxplot(aes(x=factor("CC"), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  #geom_boxplot(aes(x=factor("CD"), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  theme(plot.title = element_text(size=5)) +
  xlim(-1.1, 1.1)+
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8),
                    strip.background = element_blank(), strip.text.x = element_blank(),
                   title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                    axis.title.y = element_blank())


  return(plot)
}

dens_cors_by_gen_col_all_exp_rep <- function(file, title, subt, x_label, y_label, min_gen, max_gen){
 snewt$mean_res = snewt$mean_toxin+snewt$dif
  real_snewt_cor = cor(snewt$mean_toxin, snewt$mean_res)
   file$snake_newt <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  #unique(file$sim)
  plot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen),]) +
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_density(aes(x=as.numeric(mean_newt_pheno_By_mean_snake_pheno),fill=factor(experiment)), alpha=0.4, position="identity")+
  geom_vline(xintercept=real_snewt_cor, linetype="dashed")+
  geom_vline(xintercept=0, linetype="solid")+
  #geom_boxplot(aes(x=factor("CB"), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  #geom_boxplot(aes(x=factor("CC"), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  #geom_boxplot(aes(x=factor("CD"), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  theme(plot.title = element_text(size=5)) +
  xlim(-1.1, 1.1)+
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8),
                    strip.background = element_blank(), strip.text.x = element_blank(),
                   title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                    axis.title.y = element_blank())


  return(plot)
}

counting_threshold <- function(file, treshold, whichgroup, p_n_b, min_gen, max_gen){
  
  file=file[which(file$gen>=min_gen & file$gen<=max_gen),]
  
  if(p_n_b == "p"){
  table <-  file %>%
  group_by(get(whichgroup)) %>%
  tally(mean_newt_pheno_By_mean_snake_pheno >= treshold)
  return(table)
  }
  
  if(p_n_b == "n"){
  table <-  file %>%
  group_by(get(whichgroup)) %>%
  tally(mean_newt_pheno_By_mean_snake_pheno <= -treshold)
  return(table)
  }
  
  if(p_n_b == "b"){
  table <-  file %>%
  group_by(get(whichgroup)) %>%
  tally(mean_newt_pheno_By_mean_snake_pheno <= -treshold | mean_newt_pheno_By_mean_snake_pheno >= treshold)
  return(table)
  }else{
    print("p_n_b needs to be positive, negative, or both (p, n, or b)")
  }

}
```


## Comparing the Mean



```{r, looking at the mean}

all_cor_exp %>%
  group_by(experiment) %>%
  summarise_at(vars(mean_newt_pheno_By_mean_snake_pheno), list(name = mean), na.rm = TRUE)


all_the_means = all_cor_exp %>%
  group_by(group_exp) %>%
  summarise_at(vars(mean_newt_pheno_By_mean_snake_pheno), list(name = mean), na.rm = TRUE)

all_the_means$exp <- str_split_fixed(all_the_means$group_exp, "5_", 3)[,3]

exclude_b <- all_the_means[which(all_the_means$exp!='B'),]
exclude_c <- all_the_means[which(all_the_means$exp!='C'),]

print("Anovas from mean of A and B")
res.aov2ab <- aov(name ~ exp, data = exclude_c[which(exclude_c$exp!='D'),])
summary(res.aov2ab)
print("Anovas from mean of A and C")
res.aov2ac <- aov(name ~ exp, data = exclude_b[which(exclude_b$exp!='D'),])
summary(res.aov2ac)
print("Anovas from mean of A and D")
res.aov2ad <- aov(name ~ exp, data = exclude_b[which(exclude_b$exp!='C'),])
summary(res.aov2ad)
print("Anovas from mean of C and D")
res.aov2cd <- aov(name ~ exp, data = exclude_b[which(exclude_b$exp!='A'),])
summary(res.aov2cd)
```

I want to compare the different cor values from the simulations, but i also want to look at it simulation by simulation.

I think trials within a simulation experiment (A, B, C, D) should be the same (same mu and mu effect size).  

They should also be different between different GA combinations

same GA should be different in the different experiments

```{r, wilcoxn test}

wilcox.test(GA1_cor_tall_file$mean_newt_pheno_By_mean_snake_pheno,  GA1_cor_tall_7_file$mean_newt_pheno_By_mean_snake_pheno) #AB

wilcox.test(GA1_cor_tall_file$mean_newt_pheno_By_mean_snake_pheno,  her_cor_tall_file$mean_newt_pheno_By_mean_snake_pheno) #AC

wilcox.test(GA1_cor_tall_file$mean_newt_pheno_By_mean_snake_pheno,  inter_cor_tall_file$mean_newt_pheno_By_mean_snake_pheno) #AD

wilcox.test(GA1_cor_tall_7_file$mean_newt_pheno_By_mean_snake_pheno,  her_cor_tall_file$mean_newt_pheno_By_mean_snake_pheno) #BC

wilcox.test(GA1_cor_tall_7_file$mean_newt_pheno_By_mean_snake_pheno,  inter_cor_tall_file$mean_newt_pheno_By_mean_snake_pheno) #BD

wilcox.test(her_cor_tall_file$mean_newt_pheno_By_mean_snake_pheno,  inter_cor_tall_file$mean_newt_pheno_By_mean_snake_pheno) #CD

```

```{r, t test}



#t.test(GA1_cor_tall_file[GA1_cor_tall_file$group == "1e-08_0.005_1e-08_0.005" & GA1_cor_tall_file$rep <= 1,]$mean_newt_pheno_By_mean_snake_pheno,  GA1_cor_tall_file[GA1_cor_tall_file$group == "1e-08_0.005_1e-08_0.005" & GA1_cor_tall_file$rep >= 2,]$mean_newt_pheno_By_mean_snake_pheno) #AA

t.test(GA1_cor_tall_file$mean_newt_pheno_By_mean_snake_pheno,  her_cor_tall_file$mean_newt_pheno_By_mean_snake_pheno) #AC

t.test(GA1_cor_tall_file$mean_newt_pheno_By_mean_snake_pheno,  inter_cor_tall_file$mean_newt_pheno_By_mean_snake_pheno) #AD

t.test(GA1_cor_tall_7_file$mean_newt_pheno_By_mean_snake_pheno,  her_cor_tall_file$mean_newt_pheno_By_mean_snake_pheno) #BC

t.test(GA1_cor_tall_7_file$mean_newt_pheno_By_mean_snake_pheno,  inter_cor_tall_file$mean_newt_pheno_By_mean_snake_pheno) #BD

t.test(her_cor_tall_file$mean_newt_pheno_By_mean_snake_pheno,  inter_cor_tall_file$mean_newt_pheno_By_mean_snake_pheno) #CD


t.test(GA1_cor_tall_file$mean_newt_pheno_By_mean_snake_pheno,  GA1_cor_tall_7_file$mean_newt_pheno_By_mean_snake_pheno) #AB

```


```{r, distribuuution plots, fig.height = 11, fig.width = 5}


  
dummy<-all_cor_exp %>%
  group_by(group_exp) %>%
  summarise_at(vars(mean_newt_pheno_By_mean_snake_pheno), list(name = mean), na.rm = TRUE)

ggplot(all_cor_exp[which(all_cor_exp$gen>=min_gen & all_cor_exp$gen<=max_gen),])+
   #ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  #xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=mean_newt_pheno_By_mean_snake_pheno, fill=experiment))+ #, y=threshold
 # theme(plot.title = element_text(size=5)) +
 # xlim(-.1, 1.1)+
  #geom_vline(data = dummy, aes(xintercept = name))+
  facet_grid(group~experiment)+
  #facet_wrap(~group_exp)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8),
                    strip.background = element_blank(), strip.text.x = element_blank(),
                   title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                    axis.title.y = element_blank())
```

```{r, other plots}
dummy<-all_cor_exp %>%
  group_by(experiment) %>%
  summarise_at(vars(mean_newt_pheno_By_mean_snake_pheno), list(name = mean), na.rm = TRUE)


ggplot(all_cor_exp[which(all_cor_exp$gen>=min_gen & all_cor_exp$gen<=max_gen),])+
   #ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  #xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=mean_newt_pheno_By_mean_snake_pheno, fill=experiment))+ #, y=threshold
 # theme(plot.title = element_text(size=5)) +
 # xlim(-.1, 1.1)+
  geom_vline(data = dummy, aes(xintercept = name))+
  facet_wrap(~experiment)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8),
                    strip.background = element_blank(), strip.text.x = element_blank(),
                   title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                    axis.title.y = element_blank())
  


```

```{r, cor com figs}


ginmin = 0
ginmax = 5000
suppressMessages(print(hist_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 5000
ginmax = 10000
suppressMessages(print(hist_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 10000
ginmax = 15000
suppressMessages(print(hist_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 15000
ginmax = 20000
suppressMessages(print(hist_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 20000
ginmax = 25000
suppressMessages(print(hist_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 25000
ginmax = 30000
suppressMessages(print(hist_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 30000
ginmax = 35000
suppressMessages(print(hist_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 35000
ginmax = 40000
suppressMessages(print(hist_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 40000
ginmax = 45000
suppressMessages(print(hist_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 45000
ginmax = 50000
suppressMessages(print(hist_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

```

```{r, density com figs}


ginmin = 0
ginmax = 5000
suppressMessages(print(dens_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 5000
ginmax = 10000
suppressMessages(print(dens_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 10000
ginmax = 15000
suppressMessages(print(dens_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 15000
ginmax = 20000
suppressMessages(print(dens_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 20000
ginmax = 25000
suppressMessages(print(dens_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 25000
ginmax = 30000
suppressMessages(print(dens_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 30000
ginmax = 35000
suppressMessages(print(dens_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 35000
ginmax = 40000
suppressMessages(print(dens_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 40000
ginmax = 45000
suppressMessages(print(dens_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

ginmin = 45000
ginmax = 50000
suppressMessages(print(dens_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

```


```{r, one big one}

ginmin = 0
ginmax = 50000
suppressMessages(print(hist_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))

suppressMessages(print(dens_cors_by_gen_col_all_exp_rep(all_cor_exp, "Simulation Correlation Comparied to Real Correlation", "inter", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))


```



# next step is to count the high and the lows 
like make a lower limit like must be above 0.3


```{r, thresholds}

file = all_cor_exp
treshold = 0.3
p_n_b = "p"
min_gen = 100
max_gen =50000
whichgroup = "experiment"


counting_threshold(file, treshold, whichgroup, p_n_b, min_gen, max_gen)

file = all_cor_exp
treshold = 0.3
p_n_b = "b"
min_gen = 100
max_gen =50000
whichgroup = "experiment"

counting_threshold(file, treshold, whichgroup, p_n_b, min_gen, max_gen)

file = all_cor_exp
treshold = 0.5
p_n_b = "b"
min_gen = 100
max_gen =50000
whichgroup = "experiment"

counting_threshold(file, treshold, whichgroup, p_n_b, min_gen, max_gen)

file = all_cor_exp
treshold = 0.7
p_n_b = "b"
min_gen = 100
max_gen =50000
whichgroup = "experiment"

counting_threshold(file, treshold, whichgroup, p_n_b, min_gen, max_gen)


file = all_cor_exp
treshold = 0.7
p_n_b = "b"
min_gen = 100
max_gen =50000
whichgroup = "experiment"
```


```{r, ggslide test}

ggplot(all_cor_exp) + 
  #geom_point(size = 2) +
  #geom_line(aes(generation, mean_newt_pheno_By_mean_snake_pheno, group=rep))+
  geom_density(aes(x=as.numeric(mean_newt_pheno_By_mean_snake_pheno),fill=factor(experiment)), alpha=0.4, position="identity")+
  #geom_xsidehistogram(aes(x=as.numeric(mean_newt_pheno_By_mean_snake_pheno),fill=factor(experiment)), alpha=0.4, position="identity") +
  geom_ysideboxplot(aes(x = experiment, y=mean_newt_pheno_By_mean_snake_pheno, fill=factor(experiment)), orientation = "x") +
  scale_ysidex_discrete(guide = guide_axis(angle = 45)) 


```





