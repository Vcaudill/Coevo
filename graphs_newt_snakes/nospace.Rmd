---
title: "Nospace"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(ggplot2)
library(viridis)
library(colorspace)
library(gridExtra)
library(tidyverse)
require(reshape2)
library(plyr)
library(gridGraphics)
library(grid)
```

## No Space?

This is may no space experiment! I worked with Peter to make the 1on1 newt-snake simulation into a simulation that is not dependent on space. We changed a few things that were dependent on space like reproduction and the interaction, but everything else remained mostly the same.

Some things to not is that in the reproduction callback new individuals will be paced near their parents, but their parents are randomly chosen for anywhere in the simulation. Population size is determined by the amount of individuals in the whole area. To choose the amount of interactions between newts and snake we use numNeighbors = rbinom(1, p1.individualCount, (interaction_rate * 2 * PI * surs^2)/W^2). This will choose a value based on a binomial distribution with the newt population as the size (amount that could be drawn) and a probability of success based on the interaction rate, area a snake and the total area of the simulation.

Extra notes: From a first glance at the visual output there is a lack of color groups (color represents phenotype) 

### Space
![Space](data/space_pic.png)
### No Space
![NoSpace](data/nospace_pic.png)

## My Goals

The goal of this experiment is to see in there is a change in the newts and snakes phenotype that is not based on spatial interactions. Specifically, in this experiment there will be no spatial interaction (between newts and snakes). I will compare these results to the results of all of my other simulations!

## The Specifics of the Simulations

To make these simulations similar to the previous simulation experiments I use the same msprime files to start each of the SLiM simulations. I also keep the parameters the same. 

```{r, making data frames}

making_data_frames <- function(files, spe_col) {
i=1
for (current_file in files){
 #print(current_file)

  if(i ==1){
    file <- read.table(current_file, header = TRUE)
  
    file[[spe_col]][file[[spe_col]] == "NULL"] <- NA
      # might want to change to all_of(spe_col)
    file %>% 
      select(all_of(spe_col), gen) %>%
      #rownames_to_column() %>% 
      gather(variable, value, -gen) %>% 
      spread(gen, value) -> new_file
      
    new_file$variable[i] <- paste0(spe_col,"_trial_", i)
    i = i + 1
    next
    }
  file <- read.table(current_file, header = TRUE)
  
  file[[spe_col]][file[[spe_col]] == "NULL"] <- NA

file %>% 
  select(all_of(spe_col), gen) %>%
  #rownames_to_column() %>% 
  gather(variable, value, -gen) %>% 
  spread(gen, value) -> temp_file

temp_file$variable[1] <- paste0(spe_col,"_trial_", i)

new_file<-rbind(new_file, temp_file)
i = i + 1
}
return(new_file)
}

```

```{r, making resueable figures, results='hide', message=FALSE, warning=FALSE}

phenotype_trends <- function(file, title, subt, my_color, is_log=FALSE, leg_off=FALSE){
  data_frame_temp <- as.data.frame(t(file))
  
  colnames(data_frame_temp) <- data_frame_temp[1,]
  names(data_frame_temp) <- colnames(data_frame_temp)
  steps <- colnames(file[ , !(names(file) %in% "variable")])
data_frame_temp <- data_frame_temp[-1, ] 
data_frame_temp$steps <- as.numeric(unlist(steps))
  
  graph_file <- melt(data_frame_temp,  id.vars = 'steps', variable.name = 'series')
  
    p <- ggplot(graph_file, aes(steps, as.numeric(value))) + geom_line(aes(colour = series))+ 
    ggtitle(title, subtitle = subt) +
    scale_color_manual(values = rep(my_color, nrow(file)))+
    xlab("Generations") + ylab("Interaction")+
    theme_bw() + theme(legend.position="none")
    
    if(is_log==TRUE){
  p = p + scale_y_log10() + ylab("Interaction (Log)")
    }
     if(leg_off==TRUE){
 p = p+ theme(legend.position = "none")}
    return(p)
}

var_by_var <- function(Newt_file_x, Snake_file_x, Newt_file_y, Snake_file_y, title, subt, x_label, y_label, logy=FALSE, subtract_x=FALSE, by_gen=FALSE, just_two=FALSE, colored=FALSE, color_label=NULL, highcol="darkseagreen"){

  data_frame_newt_temp_x <- Newt_file_x
  data_frame_newt_temp_x <- data_frame_newt_temp_x[ , !(names(data_frame_newt_temp_x) %in% "variable")]
  
  data_frame_snake_temp_x <- Snake_file_x
  data_frame_snake_temp_x <- data_frame_snake_temp_x[ , !(names(data_frame_snake_temp_x) %in% "variable")]
  
  data_frame_newt_temp_y <- Newt_file_y
  data_frame_newt_temp_y <- data_frame_newt_temp_y[ , !(names(data_frame_newt_temp_y) %in% "variable")]
  
  data_frame_snake_temp_y <- Snake_file_y
  data_frame_snake_temp_y <- data_frame_snake_temp_y[ , !(names(data_frame_snake_temp_y) %in% "variable")]
  
  
  Number <- colnames(data_frame_newt_temp_x)
  data_frame_newt_x <- gather(data_frame_newt_temp_x, Number, value_x)
  data_frame_newt_x$type <- "Newt"
  data_frame_newt_y <- gather(data_frame_newt_temp_y, Number, value_y)
  data_frame_newt <- cbind(data_frame_newt_x, data_frame_newt_y)
  data_frame_newt <- data_frame_newt[-4]
  data_frame_snake_x <- gather(data_frame_snake_temp_x, Number, value_x)
  data_frame_snake_x$type <- "Snake"
  data_frame_snake_y <- gather(data_frame_snake_temp_y, Number, value_y)
  data_frame_snake <- cbind(data_frame_snake_x, data_frame_snake_y)
  data_frame_snake <- data_frame_snake[-4]
  
  
 if(subtract_x==FALSE){
   combo <- rbind(data_frame_newt, data_frame_snake)
   combo_s <- combo[sample(nrow(combo), nrow(combo)), ]
   p <- ggplot(combo_s) +
    #xlim(0, 1000)+
      ggtitle(title, subtitle = subt) +
      xlab(x_label) + ylab(y_label)+
      geom_point(aes(x=as.numeric(value_x), y=as.numeric(value_y), color=type), alpha=0.1)+
      scale_color_manual(name = "Species", values = c("Newt" = "darkred", "Snake" = "steelblue"))+
      theme(plot.title = element_text(size=5)) +
      theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8))
 }
 if(subtract_x==TRUE){
    subtract_val <- data_frame_snake_x$value_x - data_frame_newt_x$value_x
    total_sub_dataframe <- data.frame(subtract_val, data_frame_newt_y$value_y, data_frame_snake_y$value_y)
    total_sub_dataframe <- total_sub_dataframe[sample(nrow(total_sub_dataframe), nrow(total_sub_dataframe)), ]
    colnames(total_sub_dataframe) <- c("SnakeMisNewt_Pheno","Newts","Snakes")
     p <- ggplot(total_sub_dataframe) +
      #xlim(0, 1000)+
       ggtitle(title, subtitle = subt) +
       xlab(x_label) + ylab(y_label)+
       geom_point(aes(x=as.numeric(SnakeMisNewt_Pheno), y=as.numeric(Newts), color="Newts"), alpha=0.1)+
       geom_point(aes(x=as.numeric(SnakeMisNewt_Pheno), y=as.numeric(Snakes), color="Snakes"), alpha=0.1)+
        scale_colour_manual(name = "Species", values = c("Newts" = "darkred", "Snakes" = "steelblue"))+
        theme(plot.title = element_text(size=5)) +
        theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8))
 }
  if(by_gen==TRUE){
    combo <- rbind(data_frame_newt, data_frame_snake)
    combo_s <- combo[sample(nrow(combo), nrow(combo)), ]
       p <- ggplot(combo_s) +
    #xlim(0, 1000)+
      ggtitle(title, subtitle = subt) +
      xlab(x_label) + ylab(y_label)+
      geom_point(aes(x=as.numeric(Number), y=as.numeric(value_y), color=type), alpha=0.1)+
      scale_color_manual(name = "Species", values = c("Newt" = "darkred", "Snake" = "steelblue"))+
      theme(plot.title = element_text(size=5)) +
      theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8))
  }
  
  
  
   if(just_two==TRUE){
     just2 <- cbind(data_frame_newt_x, data_frame_snake_y)
     just2 <- just2[-4]
       p <- ggplot(just2) +
    #xlim(0, 1000)+
      ggtitle(title, subtitle = subt) +
      xlab(x_label) + ylab(y_label)+
      geom_point(aes(x=as.numeric(value_x), y=as.numeric(value_y)), color = "darkgreen", alpha=0.1)+
      theme(plot.title = element_text(size=5)) +
      theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8))
   }
  

   if(colored==TRUE){
     color3 <- cbind(data_frame_newt_x, data_frame_snake_y, data_frame_newt_y)
     color3 <- color3[-c(1,3,4,6)]
     suppressWarnings(suppressMessages(suppressPackageStartupMessages({require(scales)})))
     amin <- 0.1
     lowcol.hex <- as.hexmode(round(col2rgb(highcol) * amin + 255 * (1 - amin)))
     lowcol <- paste0("#",   sep = "",
                 paste(format(lowcol.hex, width = 2), collapse = ""))
       p <- ggplot(color3) +
    #xlim(0, 1000)+
      ggtitle(title, subtitle = subt) +
      xlab(x_label) + ylab(y_label)+
      geom_point(aes(x=as.numeric(value_x), y=as.numeric(value_y), color = value_y.1))+
      theme(plot.title = element_text(size=5)) +
      scale_colour_gradient(high = highcol, low = lowcol) + 
      labs(colour = color_label) +
      theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8))
  }
  if(logy==TRUE){
    p = p + scale_y_log10()
  }
  
  
  
  return(p)
 
  
}

phenotype_boxplot <- function(Newt_file, Snake_file, title, subt, boxy=FALSE, section=FALSE, section_num=0, leg_off=FALSE, ylim_max=100){
  data_frame_newt_temp <- Newt_file
  data_frame_newt_temp <- data_frame_newt_temp[ , !(names(data_frame_newt_temp) %in% "variable")]
  
  data_frame_snake_temp <- Snake_file
  data_frame_snake_temp <- data_frame_snake_temp[ , !(names(data_frame_snake_temp) %in% "variable")]
  
   if(section==TRUE){
   
   selcol = seq(1,ncol(data_frame_newt_temp), section_num)
   data_frame_newt_temp <- data_frame_newt_temp %>% select(all_of(selcol))
   data_frame_snake_temp <- data_frame_snake_temp %>% select(all_of(selcol))
   
   }
   Number <- colnames(data_frame_newt_temp)
  data_frame_newt <- gather(data_frame_newt_temp, Number, value)
  data_frame_newt$type <- "Newt"
  data_frame_snake <- gather(data_frame_snake_temp, Number, value)
  data_frame_snake$type <- "Snake"
  
 combo <- rbind(data_frame_newt, data_frame_snake)
 
 small_combo <- aggregate(as.numeric(combo$value),by=list(Number=as.numeric(combo$Number),type=combo$type),data=combo,FUN=mean, na.action = TRUE)

if(boxy==TRUE){
  p <- ggplot(combo) +
    ylim(0, ylim_max)+
    ggtitle(title, subtitle = subt) +
    xlab("Generation") + ylab("Average Phenotypes")+
    scale_color_manual(name = "Species", values = c("Newt" = "darkred", "Snake" = "steelblue"))+
    theme(plot.title = element_text(size=5)) +
    theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8))+
    geom_boxplot(aes(x=factor(as.numeric(Number)), y=as.numeric(value), color=type) )
  }
if(boxy==FALSE){
  p <- ggplot(small_combo) +
  #xlim(0, 1000)+
    ggtitle(title, subtitle = subt) +
    xlab("Generation") + ylab("Average Phenotypes")+
    scale_color_manual(name = "Species", values = c("Newt" = "darkred", "Snake" = "steelblue"))+
    theme(plot.title = element_text(size=5)) +
    theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8))+
    geom_point(aes(x=factor(as.numeric(Number)), y=as.numeric(x), color=type) )
}

 if(leg_off==TRUE){
 p = p+ theme(legend.position = "none")}

return(p)
}


phenotype_dif_boxplot <- function(Newt_file, Snake_file, title, subt, boxy=FALSE, section=FALSE, section_num=0, leg_off=FALSE){
  data_frame_newt_temp <- Newt_file
  data_frame_newt_temp <- data_frame_newt_temp[ , !(names(data_frame_newt_temp) %in% "variable")]
  
  data_frame_snake_temp <- Snake_file 
  data_frame_snake_temp <- data_frame_snake_temp[ , !(names(data_frame_snake_temp) %in% "variable")]

  if(section==TRUE){
   
   selcol = seq(1,ncol(data_frame_newt_temp), section_num)
   data_frame_newt_temp <- data_frame_newt_temp %>% select(all_of(selcol))
   data_frame_snake_temp <- data_frame_snake_temp %>% select(all_of(selcol))
   
 }
  
  Number <- colnames(data_frame_newt_temp)
  data_frame_newt <- gather(data_frame_newt_temp, Number, value)
  data_frame_snake <- gather(data_frame_snake_temp, Number, value)
  dif <- as.numeric(data_frame_snake$value)-as.numeric(data_frame_newt$value)
  
  df_dif <- as.data.frame(dif)
  df_dif$Number <- as.numeric(data_frame_newt$Number)
  
  if(boxy==TRUE){
 p <- ggplot(df_dif) +
    ggtitle(title, subtitle = subt) +
    xlab("Generation") + ylab("Average Phenotype Differences")+
    theme(plot.title = element_text(size=5)) +
    theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8))+
    geom_boxplot(aes(x=factor(as.numeric(Number)), y=as.numeric(dif)), color="darkolivegreen" )
 }
 if(boxy==FALSE){
   df_dif$trial <- rep(Newt_file$variable, ncol(Newt_file)-1)
   p <- ggplot(df_dif) +
    ggtitle(title, subtitle = subt) +
    xlab("Generation") + ylab("Average Phenotype Differences")+
    theme(plot.title = element_text(size=5)) +
    theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8))+
    geom_line(aes(x=as.numeric(Number), y=as.numeric(dif), color=trial ))+ 
     theme(legend.position="none")+
     scale_color_manual(values = rep("darkolivegreen", nrow(data_frame_newt_temp)))
 }
   if(leg_off==TRUE){
 p = p+ theme(legend.position = "none")}
  return(p)
}


phenotype_change_graph_s <- function(files, title, is_log=FALSE, xlim_value){
file1 <- read.table(files[1], header = TRUE)
p <- ggplot(file1, aes(x=1:144)) +
  xlim(0, xlim_value)+
  ggtitle(title) +
  xlab("Simulation number") + ylab("Phenotype")+
  theme_bw()


if(is_log==TRUE){
  p = p + scale_y_log10() + ylab("Phenotype  (Log)")
  
}

i=1
for (current_file in files){

  file <- read.table(current_file, header = TRUE)
  file$Newt_mean_Pheno[file$Newt_mean_Pheno == "NULL"] <- 0
  file$Snake_mean_Pheno[file$Snake_mean_Pheno == "NULL"] <- 0
  file <- file[complete.cases(file), ]
 p <- p + geom_point(data= file, x = i, aes(y = as.numeric(Newt_mean_Pheno[1])+0.1), color= darken("darkred")) +
   geom_point(data= file,x = i, aes(y = as.numeric(Newt_mean_Pheno[50])+0.1), color=lighten("darkred"))  + 
  geom_point(data= file, x = i, aes(y = as.numeric(Snake_mean_Pheno[1])+0.1), color=darken("steelblue")) +
  geom_point(data= file, x = i, aes(y = as.numeric(Snake_mean_Pheno[50])+0.1), color=lighten("steelblue"))+
  geom_segment(data = file, x=i, xend=i, aes( y=as.numeric(Newt_mean_Pheno[1])+0.1, yend=as.numeric(Newt_mean_Pheno[50])+0.1, colour="Newt"), size = 0.3, arrow = arrow(length = unit(0.5, "cm")))+
   geom_segment(data = file, x=i, xend=i, aes( y=as.numeric(Snake_mean_Pheno[1])+0.1, yend=as.numeric(Snake_mean_Pheno[50])+0.1, colour="Snake"), size = 0.3, arrow = arrow(length = unit(0.5, "cm")))
   
 i = i+1
}
p <- p +
 scale_colour_manual(name = "Species", values = c("Newt" = "darkred", "Snake"="steelblue"))
return(p)
}


```

```{r, data info}
# Files for No space results
files <- list.files(path="~/Desktop/nospace/u5", pattern="nu_*1.56", full.names=TRUE, recursive=FALSE)
file <- read.table(files[51], header = TRUE)
beta_n <- making_data_frames(files, all_of("beta_n"))
beta_s <- making_data_frames(files, all_of("beta_s"))
Newt_mean_Pheno <- making_data_frames(files, all_of("Newt_mean_Pheno"))
Snake_mean_Pheno <- making_data_frames(files, all_of("Snake_mean_Pheno"))
Newt_sd_Pheno <- making_data_frames(files, all_of("Newt_sd_Pheno"))
Snake_sd_Pheno <- making_data_frames(files, all_of("Snake_sd_Pheno"))
mean_newts_eaten <- making_data_frames(files, all_of("mean_newts_eaten"))
mean_snakes_eaten <- making_data_frames(files, all_of("mean_snakes_eaten"))
newt_deaths <- making_data_frames(files, all_of("newt_deaths"))
snake_deaths <- making_data_frames(files, all_of("snake_deaths"))
Newt_age <- making_data_frames(files, all_of("Newt_age"))
Snake_age <- making_data_frames(files, all_of("Snake_age"))
Newt_pop_size <- making_data_frames(files, all_of("Newt_pop_size"))
Snake_pop_size <- making_data_frames(files, all_of("Snake_pop_size"))

# Files for space results
files_u5 <- list.files(path="~/Desktop/beta_u5", pattern="nu_*1.56", full.names=TRUE, recursive=FALSE)

beta_n_s <- making_data_frames(files_u5, all_of("beta_n"))
beta_s_s <- making_data_frames(files_u5, all_of("beta_s"))
Newt_mean_Pheno_s <- making_data_frames(files_u5, all_of("Newt_mean_Pheno"))
Snake_mean_Pheno_s <- making_data_frames(files_u5, all_of("Snake_mean_Pheno"))
Newt_sd_Pheno_s <- making_data_frames(files_u5, all_of("Newt_sd_Pheno"))
Snake_sd_Pheno_s <- making_data_frames(files_u5, all_of("Snake_sd_Pheno"))
mean_newts_eaten_s <- making_data_frames(files_u5, all_of("mean_newts_eaten"))
mean_snakes_eaten_s <- making_data_frames(files_u5, all_of("mean_snakes_eaten"))
newt_deaths_s <- making_data_frames(files_u5, all_of("newt_deaths"))
snake_deaths_s <- making_data_frames(files_u5, all_of("snake_deaths"))
Newt_age_s <- making_data_frames(files_u5, all_of("Newt_age"))
Snake_age_s <- making_data_frames(files_u5, all_of("Snake_age"))
Newt_pop_size_s <- making_data_frames(files_u5, all_of("Newt_pop_size"))
Snake_pop_size_s <- making_data_frames(files_u5, all_of("Snake_pop_size"))

```

## The distribution of Phenotypes

see if there is a difference in the distribution of phenotypes between the space and no space simulations. Currently running 9-13-2021 then talapas was updating 9-14-2021

## How Restance and Toxin Levels Change Overtime

Above, I looked at the distributions of newt and snake phenotypes for the 1st and 1000th generation. Next, I will look at how the phenotypes of newts and snakes change over 1000 generations. I will specifically focus on three types of graphs to show how the phenotypes of newts and snakes vary and change.

The graphs I will be looking at are listed and described below: 

* phenotype change (finding sigma and mu): looks at the mean phenotype at the 1st generation and draws an arrow to the mean phenotype at the last generation one pair of lines for each simulation.
* phenotype variation (from what is a normal sim): looks at all of the mean phenotypes of newts and snakes for the 1000 generations and creates box plots to show how the simulations differ for each other. This is also repeated for the standard deviation.
* differences (from what is a normal sim): This figure creates box plots of how the difference between snake and newt phenotypes change over time.

I will first show the results for space simulations followed by no space predictions and results.

### Phenotype Change

I predict that that the phenotypes of newts and snakes will change over 1000 generations. I think that both phenotypes will increase. The phenotype starting points should be the same between the space and no space simulation, but I am unsure on how they will differ. 

```{r, phenotype change}


w1 <- phenotype_change_graph_s(files_u5, title="Change in Phenotype Space", is_log=TRUE, xlim_value=104)

w1

w2 <- phenotype_change_graph_s(files, title="Change in Phenotype NoSpace", is_log=TRUE, xlim_value=104)

w2
```


After graphing the change in phenotypes for spatial and non-spatial simulations, it seems like the phenotypes of the non-spatial simulations got larger. If there are no spatial groups, any newt can run into any snake and only the one with the greater phenotype will survive. There wont be areas where a low phenotype could exist (unless that newt/snake was never chosen for an interaction). Maybe this creases an increased mean phenotype. Would no space lower the variation of a particular species phenotype? I wonder what would happen if I ran the spatial simulation with a larger area.  
### Phenotype Variation

I predict that as the number of generations increase there should be an increase in variation of the mean phenotypes at that particular generation. I also predict that standard deviation between the simulation will also vary more as the number of generations increases. Now, if I compare the difference between space and no space simulations I think that no space simulation might have less variation in the standard deviation of the simulation. I predict this because there might a bunch of newts and snakes with similar phenotypes (within their species at the 1000th generation). But, the no space simulations could also have more variation in the mean phenotypes, solely based off of which newts and snakes are selected to interact. 

```{r, comparative figures this params}

sp_s<-phenotype_boxplot(Newt_mean_Pheno_s, Snake_mean_Pheno_s, title="Space: Variation in the Mean Phenotype For Newts and Snakes by Generation", subt="sigma = 0.2, mu = 1.5625e-10", boxy=TRUE, section=TRUE, section_num=10, ylim_max=30)

sdp_s<-phenotype_boxplot(Newt_sd_Pheno_s, Snake_sd_Pheno_s, title="Space: Variation in the Sd of Phenotype For Newts and Snakes by Generation", subt="sigma = 0.2, mu = 1.5625e-10", boxy=TRUE, section=TRUE, section_num=10, ylim_max=30)

grid.arrange(sp_s, sdp_s, nrow=1)

sp<-phenotype_boxplot(Newt_mean_Pheno, Snake_mean_Pheno, title="NoSpace: Variation in the Mean Phenotype For Newts and Snakes by Generation", subt="sigma = 0.2, mu = 1.5625e-10", boxy=TRUE, section=TRUE, section_num=10, ylim_max=30)

sdp<-phenotype_boxplot(Newt_sd_Pheno, Snake_sd_Pheno, title="NoSpace: Variation in the Sd of Phenotype For Newts and Snakes by Generation", subt="sigma = 0.2, mu = 1.5625e-10", boxy=TRUE, section=TRUE, section_num=10, ylim_max=30)

grid.arrange(sp, sdp, nrow=1)
```


There were more points in the no space simulations that were above my y-limit max value of 30.
There are a lot more points above the boxplot in the no space simulations. Are the phenotypes running away?

When looking at the differences between the space and no space simulation, the no space simulations had more variation between individual simulations in both the the mean average phenotype and the average standard deviation. Although, the mean line of the non-spatial sd boxplots seemed to be lower than the mean lines of the spatial sd boxplots. I wonder if the increase in variation between the no-space simulations is due to the random selection of newts and snake that interact. Maybe there is something about space that keeps the simulations more similar to each other??? A graph showing the distribution of means and sds might be helpful.

### Phenotype Differences

I had predicted that the no space population would be more well mixed, meaning that there would be more newts and snakes with similar phenotypes (within the same species). But this prediction did not seem to be necessarily true. I wonder if the no space simulation will have an effect on the difference between the snake and newt phenotypes. I expect that there will be an increase in the variation of difference (some more positive values while others have a more negative values)as the number of generations increases. I suspect that in the no space simulation the mean phenotypes will either be more closely matched, because newts and snakes of similar phenotypes were interacting, or vastly different, because newts and snakes of different phenotypes were interacting. There also might be more variation between individual simulation in the no space simulation set.

```{r, the differences}
bp_s<- phenotype_dif_boxplot(Newt_mean_Pheno_s, Snake_mean_Pheno_s, title="Space: Differences", subt="sigma = 0.2, mu = 1.5625e-10",boxy=TRUE, section=TRUE, section_num=10)

bp2_s <- phenotype_dif_boxplot(Newt_mean_Pheno_s, Snake_mean_Pheno_s, title="Space: Differences", subt="sigma = 0.2, mu = 1.5625e-10",boxy=FALSE, section=FALSE, section_num=0)

grid.arrange(bp_s, bp2_s, nrow=1)

bp <- phenotype_dif_boxplot(Newt_mean_Pheno, Snake_mean_Pheno, title="NoSpace: Differences", subt="sigma = 0.2, mu = 1.5625e-10",boxy=TRUE, section=TRUE, section_num=10)

bp2 <- phenotype_dif_boxplot(Newt_mean_Pheno, Snake_mean_Pheno, title="NoSpace: Differences", subt="sigma = 0.2, mu = 1.5625e-10",boxy=FALSE, section=FALSE, section_num=0)

grid.arrange(bp, bp2, nrow=1)
```

Well, just like in the mean phenotype graphs, the values in the mean phenotype differences graphs are much larger in the no space simulations. Although, the mean phenotype difference remains near zero in both the spatial and non-spatial simulations. As time increases the differences between phenotypes get larger at a faster rate in the no space simulations. What could be happening to create such a large difference between spatial and non-spatial newt and snake phenotypes?

## The Interaction

### Differnece in mean phenotype by Deaths/Age or Pouplation Size  (from Selection coef)

Previously, I saw a strange interaction between the difference between snakes and newts phenotype and the amount of deaths/age. I saw that the higher a snakes phenotype there were less newts being eaten. The same was true that when a newts phenotype was higher there were less snakes being eaten. We speculated that this phenomenon was occurring due to less snakes or newts in simulations with higher phenotypes in the opposite species. When I re-graphed these results by replacing death/age with population size we were able to see that the population with a higher phenotype had more individuals and the other species population was lower.

Originally, I had predicted that when the mean snakes phenotype was higher than the newts phenotype then there would be less snakes dying. But if the snakes have the higher phenotype, they were reducing the newts population size, totaling in less newts available to kill. The graph was really messy, so I wonder if spatial structure was influencing these results and if so how. So then I repeated these same figures with the data from no space simulations without really thinking there would be a significant difference.

```{r, sel coef graphs}

ps1_s <- var_by_var( Newt_mean_Pheno_s, Snake_mean_Pheno_s, mean_newts_eaten_s, mean_snakes_eaten_s, title="Space: Differnece in mean phenotype by Deaths", subt="sigma = 0.2, mu = 1.5625e-10", x_label="Dif in Mean Pheno", y_label="Deaths/age", subtract_x=TRUE)

ps2_s <- var_by_var( Newt_mean_Pheno_s, Snake_mean_Pheno_s, Newt_pop_size_s, Snake_pop_size_s, title="Space: Differnece in mean phenotype by PopSize", subt="sigma = 0.2, mu = 1.5625e-10", x_label="Dif in Mean Pheno", y_label="PopSize", subtract_x=TRUE) 


grid.arrange(ps1_s, ps2_s, nrow=1)

ps1 <- var_by_var( Newt_mean_Pheno, Snake_mean_Pheno, mean_newts_eaten, mean_snakes_eaten, title="NoSpace: Differnece in mean phenotype by Deaths", subt="sigma = 0.2, mu = 1.5625e-10", x_label="Dif in Mean Pheno", y_label="Deaths/age", subtract_x=TRUE)

ps2 <- var_by_var( Newt_mean_Pheno, Snake_mean_Pheno, Newt_pop_size, Snake_pop_size, title="NoSpace: Differnece in mean phenotype by PopSize", subt="sigma = 0.2, mu = 1.5625e-10", x_label="Dif in Mean Pheno", y_label="PopSize", subtract_x=TRUE) 


grid.arrange(ps1, ps2, nrow=1)
```


Well, the no space simulation results look very different from the spatial simulations. It looks more like my original prediction where if snakes have a higher phenotype there would be less of them being killed and more newts being killed (in the death/age graph). A similar pattern between the space and no space emerged where as the phenotype of one population goes up the population size of that species also goes up, while the other species population size decreases. Although, the no space difference in mean phenotypes and population size did look very curved. I noticed that the population sizes in the no space simulations were larger than the population sizes in the space simulations, could this have an effect on the results?

### Population size of Newts by Snakes with phenotype as color

In the selection coefficients rmarkdown I made these beautiful whale plots that again showed (for the most part) that when a species phenotype was high then their population size is higher than the other species. Its really weird that these looked uniform across many simulations. Almost like some sort of conditions need to be met for a phenotype and population size to reach a particular value. In the spatial simulation there were cases where the snakes had a high phenotype and a low population size. There was also a fin where the newt and snake populations were not a steady-state yet. 

From the previous graphs I expected a similar trend in the no space simulations (higher the population size the higher the phenotype of a species).

```{r, popsize of newts and snakes with color of phenotype}

vc1_s <- var_by_var(Newt_pop_size_s, Newt_mean_Pheno_s, Newt_mean_Pheno_s, Snake_pop_size_s, title="Space: Newt VS Snake Population Size Color=Phenotype", subt="sigma = 0.1, mu = 1.0e-10", y_label="Snake Popsize", x_label="Newt Popsize", colored=TRUE, color_label="Newt Phenotype" , highcol="darkred") 

vc2_s <- var_by_var(Newt_pop_size_s, Snake_mean_Pheno_s, Snake_mean_Pheno_s, Snake_pop_size_s, title="Space: Newt VS Snake Population Size Color=Phenotype", subt="sigma = 0.1, mu = 1.0e-10", y_label="Snake Popsize", x_label="Newt Popsize", colored=TRUE, color_label="Snake Phenotype", highcol="steelblue") 

vc1_s 
vc2_s


vc1 <- var_by_var(Newt_pop_size, Newt_mean_Pheno, Newt_mean_Pheno, Snake_pop_size, title="NoSpace: Newt VS Snake Population Size Color=Phenotype", subt="sigma = 0.1, mu = 1.0e-10", y_label="Snake Popsize", x_label="Newt Popsize", colored=TRUE, color_label="Newt Phenotype" , highcol="darkred") 

vc2 <- var_by_var(Newt_pop_size, Snake_mean_Pheno, Snake_mean_Pheno, Snake_pop_size, title="NoSpace: Newt VS Snake Population Size Color=Phenotype", subt="sigma = 0.1, mu = 1.0e-10", y_label="Snake Popsize", x_label="Newt Popsize", colored=TRUE, color_label="Snake Phenotype", highcol="steelblue") 

vc1 
vc2
```

After graphing both the spatial and no space results there were a few differences that I noticed. First, the no space simulations don't have the in-between population size (the fin in the spatial graph). This might be due to the population sizes growing to their stead-state sizes within the first 20 generations. Second, I noticed that the population size of newts and snakes seems more linear in the no space simulations. This reflects the sigmoid shape of the above interaction graphs. Third, I noticed a difference in population size (they were larger in the no space simulations) and the phenotypes (also larger in the no space simulations). Does space prevent the phenotypes from get exponentially large? Beacuse the no space phenotypes got so much larger its kind of hard to compare the colors. Forth, there is a similar phenotype trend between the spatial and no space simulations. However, there is one no space simulation where the phenotype got really large when both populations sizes were middle sized. The color change seemed more uniform in the no space simulation results. Maybe the pattern is lighter in the middle and darker at the edges with the darkest edge at the point of the highest population size. (Might be worth it to do the arrow graphs for each of the individual simulations.) Final note the spatial results look cooler than the no space results.

### Beta Distributions 

The interaction rate in both the space and no space simulations was 0.05. This value seems very low? Beta is the kind of like a selection coefficient, it will tell how strange section is. In the spatial simulations the beta values for nets and snakes were close to 0. This value indicates that selection is very weak or non-existent. I think that the beta values are low because the interaction rate which is my selective force is low and the non selective force (density dependence) is stronger. In the no space simulation there is still density dependent selection and a low interaction rate, so I don't expect the beta value to change that much.

```{r, beta distribution}

hist(unlist(beta_s_s[ , 2:52]), col=rgb(173,216,230,max = 255, alpha = 80, names = "lt.blue"), main="Space: Beta Values", xlab="Beta", breaks=15) 
hist(unlist(beta_n_s[ , 2:52]), col=rgb(255,192,203, max = 255, alpha = 80, names = "lt.pink"), add = TRUE, breaks=15) #ylim=c(0,2100)

abline(v = mean(unlist(beta_n_s[ , 2:52])), col = rgb(255,192,203, max = 255), lwd = 2)
abline(v = mean(unlist(beta_s_s[ , 2:52])), col = rgb(173,216,230, max = 255), lwd = 2)
legend("topright", c("Newt", "Snake"), fill=c(rgb(255,192,203, max = 255), rgb(173,216,230, max = 255)))

hist(unlist(beta_s[ , 2:52]), col=rgb(173,216,230,max = 255, alpha = 80, names = "lt.blue"), main="NoSpace: Beta Values", xlab="Beta", breaks=15) 
hist(unlist(beta_n[ , 2:52]), col=rgb(255,192,203, max = 255, alpha = 80, names = "lt.pink"), add = TRUE, breaks=15) #ylim=c(0,2100)

abline(v = mean(unlist(beta_n[ , 2:52])), col = rgb(255,192,203, max = 255), lwd = 2)
abline(v = mean(unlist(beta_s[ , 2:52])), col = rgb(173,216,230, max = 255), lwd = 2)
legend("topright", c("Newt", "Snake"), fill=c(rgb(255,192,203, max = 255), rgb(173,216,230, max = 255)))

```

The beta values between no space and the space simulations don't seem to change that much. I noticed that the beta values range in no space were smaller from -0.1 to 0.1ish compared to the spatial simulation -0.2 to 0.2. I am not sure why


Now I plot the newt betas by the snake betas to see if there is a relationship between them. In the spacial simulation the the points were clusters around 0 with an oval surrounding that. Since the beta distribution was similar between the space and no space simulations I think the same thing will happen.

```{r, comp betas}
var_by_var(beta_n_s, beta_s_s, beta_n_s, beta_s_s, title="Space: Newt Betas by Snake Betas", subt="sigma = 0.2, mu = 1.5625e-10", x_label="Newt betas", y_label="Snake Betas", just_two = TRUE) 

var_by_var(beta_n, beta_s, beta_n, beta_s, title="NoSpace: Newt Betas by Snake Betas", subt="sigma = 0.2, mu = 1.5625e-10", x_label="Newt betas", y_label="Snake Betas", just_two = TRUE) 

```

The clustering looks very similar between the no space and space simulations. It is possible that the no space is shifted a little bit to the right of 0, but I am not sure. I wonder what would happen if I increase the interaction rate?

### Extra Figures

These figures are to check to see if everything is working like how I would expect it to. I thought it would be fun to compare these results between the two different simulations to see if anything look different.

```{r, beta figures}

g1_s <- var_by_var( beta_n_s, beta_s_s, beta_n_s, beta_s_s, title="Space: Betas By Generation", subt="sigma = 0.2, mu = 1.5625e-10", x_label="Generation", y_label="Betas", by_gen=TRUE) 

g2_s <- var_by_var( Newt_mean_Pheno_s, Snake_mean_Pheno_s, beta_n_s, beta_s_s, title="Space: Differnece in mean phenotype by Betas", subt="sigma = 0.2, mu = 1.5625e-10", x_label="Dif in Pheno", y_label="Betas", subtract_x=TRUE)

g3_s <- var_by_var( Newt_mean_Pheno_s, Snake_mean_Pheno_s, Newt_age_s, Snake_age_s, title="Space: Differnece in mean phenotype by Age", subt="sigma = 0.2, mu = 1.5625e-10", x_label="Dif in Pheno", y_label="Age", subtract_x=TRUE) 

g4_s <- var_by_var(Newt_mean_Pheno_s, beta_s_s, beta_n_s, Snake_mean_Pheno_s, title="Space: Newt Pheno by Snake Pheno", subt="sigma = 0.2, mu = 1.5625e-10", x_label="Newt Mean Phenotype", y_label="Snake Mean Phenotype", just_two = TRUE) 


grid.arrange(g1_s, g2_s, g3_s, g4_s, nrow=2)


g1 <- var_by_var( beta_n, beta_s, beta_n, beta_s, title="NoSpace: Betas By Generation", subt="sigma = 0.2, mu = 1.5625e-10", x_label="Generation", y_label="Betas", by_gen=TRUE) 

g2 <- var_by_var( Newt_mean_Pheno, Snake_mean_Pheno, beta_n, beta_s, title="NoSpace: Differnece in mean phenotype by Betas", subt="sigma = 0.2, mu = 1.5625e-10", x_label="Dif in Pheno", y_label="Betas", subtract_x=TRUE)

g3 <- var_by_var( Newt_mean_Pheno, Snake_mean_Pheno, Newt_age, Snake_age, title="NoSpace: Differnece in mean phenotype by Age", subt="sigma = 0.2, mu = 1.5625e-10", x_label="Dif in Pheno", y_label="Age", subtract_x=TRUE) 

g4 <- var_by_var(Newt_mean_Pheno, beta_s, beta_n, Snake_mean_Pheno, title="NoSpace: Newt Pheno by Snake Pheno", subt="sigma = 0.2, mu = 1.5625e-10", x_label="Newt Mean Phenotype", y_label="Snake Mean Phenotype", just_two = TRUE) 


grid.arrange(g1, g2, g3, g4, nrow=2)

```





