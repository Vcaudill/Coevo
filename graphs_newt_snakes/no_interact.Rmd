---
title: "No Interaction"
output: html_document
date: '2022-08-19'
---

```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE,echo = FALSE) 

library(ggplot2)
library(viridis)
library(colorspace)
library(gridExtra)
library(tidyverse)
require(reshape2)
library(plyr)
library(gridGraphics)
library(grid)
library(knitr)
library(kableExtra)
library("reshape")
library(ggpubr)
theme_set(theme_pubr())
library(stringr)
library(patchwork)

```

## Goal:

In this experiment I am observing a co-evolving population (survival is determined by a random draw) with a non-interactive trait. Newts and snakes have heritable traits, but their interaction is not determined by their phenotype. Instead, when newts and snakes interact, the outcome is determined by a coin flip. SLiM code changes: (1) prob_of_survive = runif(1); survive = runif(1) < prob_of_survive; //Things changes probably of snakes survival to 50%. If snake survives, newt dies. If snake dies, newt survives. Interaction not based on phenotypes

### Questions:

What happens when a co-evolving trait is not interactive?

## Background

In this experiment I keep everything about my simulation the same as GA1 tall (landscape size, fitness, cost, GA combinations, heritability) and change the interaction. Without the interaction of newts and snakes relying on their phenotype, there is no selection selecting for higher phenotypes. This experiment took away interspecific competition, but left in intraspecific competition (density dependent). I will explore how the lack of newt-snake phenotype dependent interaction affect newt/snake mean phenotype and spatial correlations. I predict that there will be no spatial phenotype correlation. I have no idea what to predict about the phenotypes.

```{bash, data file gathering}
#!/usr/bin/env bash

# Run these comands while in The the folder that contains the file you would like to condence
# Goal is to condence all the text files into one file 
# Requirements: need to have the same name and need to add additional columns
thepath=/Users/victoria/Desktop/
foldername=no_interaction
thefolder=${thepath}${foldername}/*

add_in_column=",rep,snake_mu_rate,snake_mu_effect_sd,newt_mu_rate,newt_mu_effect_sd"

cor_head_file=$(find ${thepath}${foldername} -name "*_cor_*" | head -n 1)
cor_head=$(head -n 1 "${cor_head_file}")

grid_head_file=$(find ${thepath}${foldername} -name "*_grid_*" | head -n 1)
grid_head=$(head -n 1 "${grid_head_file}")

lit_head_file=$(find ${thepath}${foldername} -name "*_lit_*" | head -n 1)
lit_head=$(head -n 1 "${lit_head_file}")




#test -f /Users/victoria/Desktop/bash_test/all_lit.txt && echo "all lit file exists."
#test -f /Users/victoria/Desktop/bash_test/all_grid.txt && echo "all grid file exists."
#test -f /Users/victoria/Desktop/bash_test/all_cor.txt && echo "all cor file exists."

if [[ -f ${thepath}${foldername}/all_lit.txt ]] && [[ -f ${thepath}${foldername}/all_grid.txt ]] && [[ -f ${thepath}${foldername}/all_cor.txt ]]
then
  echo "All cor, lit, and grid files exist!"
  echo "This program will now end!"
  exit 0
fi

#creating the files
echo ${lit_head}${add_in_column} > ${thepath}${foldername}/all_lit.txt
echo ${grid_head}${add_in_column} > ${thepath}${foldername}/all_grid.txt
echo ${cor_head}${add_in_column} > ${thepath}${foldername}/all_cor.txt



for filename in $thefolder*.text;
  do 
#getting the variables 
my_type=$(echo ${filename} |sed 's/.*GA205_//; s/_.*//')
snake_mu_rate=$(echo ${filename} |sed 's/.*snake_mu_rate_//; s/_.*//')
snake_mu_effect_sd=$(echo ${filename} |sed 's/.*snake_mu_effect_sd_//; s/_.*//')
newt_mu_rate=$(echo ${filename} |sed 's/.*newt_mu_rate_//; s/_.*//')
newt_mu_effect_sd=$(echo ${filename} |sed 's/.*newt_mu_effect_sd_//; s/_.*//')
rep=$(echo ${filename} | sed "s/.*rep_//; s/_.*//")
#echo ${newt_mu_rate}	
# echo $my_type
# echo $my_other_type
# these new columns adding them to the data
sed -i '' -e 's/$/,'${rep}'/' $filename
sed -i '' -e 's/$/,'${snake_mu_rate}'/' $filename
sed -i '' -e 's/$/,'${snake_mu_effect_sd}'/' $filename
sed -i '' -e 's/$/,'${newt_mu_rate}'/' $filename
sed -i '' -e 's/$/,'${newt_mu_effect_sd}'/' $filename
#infile >outfile
if [[ $my_type == "lit" ]]
then
    tail -n +2 -q $filename >> ${thepath}${foldername}/all_lit.txt
fi

if [[ $my_type == "grid" ]]
then
    tail -n +2 -q $filename >> ${thepath}${foldername}/all_grid.txt
fi

if [[ $my_type == "cor" ]]
then
    tail -n +2 -q $filename >> ${thepath}${foldername}/all_cor.txt
fi

done

```



```{r, data gathering}

snewt <- read.csv("~/Desktop/snake_newt_real_data.csv", header = TRUE)

folder="no_interaction"
filelocation=paste0("~/Desktop/",folder)

inter_tall_tall_file<- read.csv(paste0(filelocation, "/all_lit.txt") , header = TRUE)

inter_tall_tall_file$group_rep <- paste0(inter_tall_tall_file$snake_mu_rate, "_", inter_tall_tall_file$snake_mu_effect_sd,"_",inter_tall_tall_file$newt_mu_rate, "_", inter_tall_tall_file$newt_mu_effect_sd, "_", inter_tall_tall_file$rep)

inter_tall_tall_file$group <- paste0(inter_tall_tall_file$snake_mu_rate, "_", inter_tall_tall_file$snake_mu_effect_sd,"_",inter_tall_tall_file$newt_mu_rate, "_", inter_tall_tall_file$newt_mu_effect_sd)

inter_tall_tall_file$sim=LETTERS[factor(inter_tall_tall_file$group)]
inter_tall_tall_file$dif <- inter_tall_tall_file$Snake_mean_Pheno-inter_tall_tall_file$Newt_mean_Pheno


inter_cor_tall_file<- read.csv(paste0(filelocation,"/all_cor.txt") , header = TRUE)
inter_cor_tall_file$group_rep <- paste0(inter_cor_tall_file$snake_mu_rate, "_", inter_cor_tall_file$snake_mu_effect_sd,"_",inter_cor_tall_file$newt_mu_rate, "_", inter_cor_tall_file$newt_mu_effect_sd, "_", inter_cor_tall_file$rep)
inter_cor_tall_file$group <- paste0(inter_cor_tall_file$snake_mu_rate, "_", inter_cor_tall_file$snake_mu_effect_sd,"_",inter_cor_tall_file$newt_mu_rate, "_", inter_cor_tall_file$newt_mu_effect_sd)
inter_cor_tall_file$sim=LETTERS[factor(inter_cor_tall_file$group)]

inter_inter_grid_tall_file<-read.csv(paste0(filelocation,"/all_grid.txt") , header = TRUE)
inter_inter_grid_tall_file$group <- paste0(inter_inter_grid_tall_file$snake_mu_rate, "_", inter_inter_grid_tall_file$snake_mu_effect_sd,"_",inter_inter_grid_tall_file$newt_mu_rate, "_", inter_inter_grid_tall_file$newt_mu_effect_sd)
inter_inter_grid_tall_file$group_rep <- paste0(inter_inter_grid_tall_file$snake_mu_rate, "_", inter_inter_grid_tall_file$snake_mu_effect_sd,"_",inter_inter_grid_tall_file$newt_mu_rate, "_", inter_inter_grid_tall_file$newt_mu_effect_sd, "_", inter_inter_grid_tall_file$rep)

inter_inter_grid_tall_file$sim=LETTERS[factor(inter_inter_grid_tall_file$group)]
inter_inter_grid_tall_file$snake_newt_rep <- paste0("Snake_",inter_inter_grid_tall_file$snake_mu_rate, "_", inter_inter_grid_tall_file$snake_mu_effect_sd, "_Newt_",inter_inter_grid_tall_file$newt_mu_rate, "_", inter_inter_grid_tall_file$newt_mu_effect_sd, "_", inter_inter_grid_tall_file$rep)



```



```{r, cor box set up}

boxplot_cors_by_gen <- function(file, title, subt, x_label, y_label, min_gen, max_gen){
 snewt$mean_res = snewt$mean_toxin+snewt$dif
  real_snewt_cor = cor(snewt$mean_toxin, snewt$mean_res)
  #file=inter_cor_tall_file
  #file$snake_newt <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  
  myplot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen),]) +
  ylim(-1.1, 1.1)+
  #ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  #xlab(x_label) + ylab(y_label)+
  geom_boxplot(aes(x=factor(rep), y=as.numeric(mean_newt_pheno_By_mean_snake_pheno), color = "CA"))+
  geom_hline(yintercept=real_snewt_cor, linetype="dashed")+
    geom_hline(yintercept=0, linetype="solid")+
  #geom_boxplot(aes(x=factor("CB"), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  #geom_boxplot(aes(x=factor("CC"), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  #geom_boxplot(aes(x=factor("CD"), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  theme(plot.title = element_text(size=5)) +
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())


  return(myplot)
}



hist_cors_by_gen_col_rep <- function(file, title, subt, x_label, y_label, min_gen, max_gen){
 snewt$mean_res = snewt$mean_toxin+snewt$dif
  real_snewt_cor = cor(snewt$mean_toxin, snewt$mean_res)
   #file$snake_newt <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  #unique(file$sim)
  plot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen),]) +
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=as.numeric(mean_newt_pheno_By_mean_snake_pheno),fill=factor(rep)))+
  geom_vline(xintercept=real_snewt_cor, linetype="dashed")+
  geom_vline(xintercept=0, linetype="solid")+
  #geom_boxplot(aes(x=factor("CB"), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  #geom_boxplot(aes(x=factor("CC"), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  #geom_boxplot(aes(x=factor("CD"), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  theme(plot.title = element_text(size=5)) +
  xlim(-1.1, 1.1)+
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())


  return(plot)
}

hist_cors_by_gen_col_rep_nofill <- function(file, title, subt, x_label, y_label, min_gen, max_gen){
 snewt$mean_res = snewt$mean_toxin+snewt$dif
  real_snewt_cor = cor(snewt$mean_toxin, snewt$mean_res)
  #file$snake_newt <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  unique(file$sim)
  plot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen),]) +
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=as.numeric(mean_newt_pheno_By_mean_snake_pheno)))+
  geom_vline(xintercept=real_snewt_cor, linetype="dashed")+
  geom_vline(xintercept=0, linetype="solid")+
  #geom_boxplot(aes(x=factor("CB"), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  #geom_boxplot(aes(x=factor("CC"), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  #geom_boxplot(aes(x=factor("CD"), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  theme(plot.title = element_text(size=5)) +
  #stat_bin(bins=30)+
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())

suppressMessages(print(plot))

  return(plot)
}


var_cor <- function(file, cfile, title, subt, x_label, y_label, min_gen, max_gen){
  real_snewt_cor = cor(snewt$mean_toxin, snewt$mean_res)
  real_snewt_var = var(snewt$dif)
  var_cor_table=data.frame()

  
  for(i in 1:length(unique(file$snake_newt_rep))){
    pattern<-unique(file$snake_newt_rep)[i]
    temp_file<-file[which(file$gen>=min_gen & file$gen<=max_gen & file$snake_newt_rep==pattern),]
    temp_cor_file<-cfile[which(cfile$gen>=min_gen & cfile$gen<=max_gen & cfile$snake_newt_rep==pattern),]
    
    var_cor_table_temp<- data.frame("pattern"=pattern, "var"= var(temp_file$dif),"cor" = cor(temp_file$newt_toxin, temp_file$snake_res), "mean_corr" = mean(temp_cor_file$mean_newt_pheno_By_mean_snake_pheno))
    var_cor_table <- rbind(var_cor_table, var_cor_table_temp)
  }
 
  var_cor_table_temp<- data.frame("pattern"="real", "var"= real_snewt_var, "cor" = real_snewt_cor, "mean_corr" = real_snewt_cor)
  var_cor_table <- rbind(var_cor_table, var_cor_table_temp)
  
  plot <- ggplot(var_cor_table) +
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_point(aes(x=as.numeric(var), y=as.numeric(cor), color = pattern), shape=17, size=3)+
  geom_point(aes(x=as.numeric(var), y=as.numeric(mean_corr), color = pattern), size=3)+
  theme(plot.title = element_text(size=5)) +
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8))


  return(plot)
}


cor_trends_by_gen <- function(file, cfile, title, subt, x_label, x_label_cor, y_label, min_gen, max_gen, pattern){
#file=inter_tall_tall_file
#cfile=inter_cor_tall_file 
 # pattern="1.0e-10_0.05_1.0e-08_0.005_3"
 file$snake_newt_rep <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd,"_", file$rep)
  cfile$snake_newt_rep <- paste0(cfile$snake_mu_rate, "_", cfile$snake_mu_effect_sd, "_", cfile$newt_mu_rate, "_", cfile$newt_mu_effect_sd, "_", cfile$rep)
  plot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen & file$snake_newt_rep==pattern),]) +
    #geom_line(aes(generation, dif, group=rep, col="dif"))+
      ggtitle(title, subtitle = paste0(subt," pattern ", pattern, " From ", min_gen, " gen to ", max_gen, " gen"))+
    geom_line(aes(generation, Snake_mean_Pheno, group=rep, color="Snake_mean_Pheno"),)+
    geom_line(aes(generation, Newt_mean_Pheno, group=rep, color="Newt_mean_Pheno"))+
    #ylim(0,10)+
    #xlab(x_label) + ylab(y_label)+
    scale_color_manual(name = "Type",
values = c( "Snake_mean_Pheno" = "steelblue", "Newt_mean_Pheno" = "darkred"),
labels = c("Snake", "Newt"))+
    theme_bw() +theme(legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank(), axis.ticks.x = element_blank(), axis.text.x = element_blank(),
                      plot.margin=unit(c(1,1,+0.3,1), "cm"))
  
  cor_plot <- ggplot(cfile[which(cfile$gen>=min_gen & cfile$gen<=max_gen & cfile$snake_newt_rep==pattern),]) +
    geom_line(aes(generation, mean_newt_pheno_By_mean_snake_pheno, col="CA"))+
    #ggtitle(title, subtitle = subt) +
    ylim(-1.1, 1.1)+
    #xlab(x_label_cor) + ylab(y_label)+
    theme_bw() +theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank(),
                      plot.margin=unit(c(-0.5,1,1,1), "cm"))
  
  file<-file[which(file$gen>=min_gen & file$gen<=max_gen & file$snake_newt_rep==pattern),]
  cfile<-cfile[which(cfile$gen>=min_gen & cfile$gen<=max_gen & cfile$snake_newt_rep==pattern),]
  
  if(nrow(cfile)>nrow(file)){
    toDelete <- seq(0, nrow(cfile), 2)
    cfile_short <-  cfile[-toDelete, ]
  }else{
    cfile_short <-  cfile
  }
  
  if(nrow(cfile_short)>nrow(file)){
      toDelete <- seq(0, nrow(cfile_short), 2)
      cfile_short <-  cfile_short[-toDelete, ]
    }
  figure <- ggarrange(plot, cor_plot + font("x.text", size = 10),heights = c(2, 1.5),ncol = 1, nrow = 2, align = "v")
    print(paste0("pattern ", pattern))
  print(paste0("Cor between average snake pheno and local cor ", cor(file$Snake_mean_Pheno, cfile_short$mean_newt_pheno_By_mean_snake_pheno)))
  print(paste0("Cor between average newt pheno and local cor ", cor(file$Newt_mean_Pheno, cfile_short$mean_newt_pheno_By_mean_snake_pheno)))
  print(paste0("Cor between average dif pheno and local cor ", cor(file$dif, cfile_short$mean_newt_pheno_By_mean_snake_pheno)))
  print(paste0("Cor between newt pheno and snake ", cor(file$Newt_mean_Pheno, file$Snake_mean_Pheno)))
  return(figure)
}


four_types_boxplot_cors_by_gen <- function(file,title, subt, x_label, y_label, min_gen, max_gen){
  #file$snake_newt <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  plot <- ggplot(file[which(file$gen>=min_gen & file$gen<=max_gen),]) +
  ylim(-1.1, 1.1)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen"))+
  xlab(x_label) + ylab(y_label)+
  geom_boxplot(aes(x=factor("CA"), y=as.numeric(mean_newt_pheno_By_mean_snake_pheno), color = "CA"))+
  geom_boxplot(aes(x=factor("CB"), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  geom_boxplot(aes(x=factor("CC"), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  geom_boxplot(aes(x=factor("CD"), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  geom_hline(yintercept=0, linetype="solid")+
  theme(plot.title = element_text(size=5)) +
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())


  return(plot)
}

```


```{r, general file and graph making}

#the functions to make the params file and the summary and heatmap figures 

create_parm_file <- function(file, min_gen, max_gen){
params <- data_frame()

for(i in 1:length(unique(file$snake_newt_rep))){

  pattern=unique(file$snake_newt_rep)[i]
  sumitup <- file[which(file$gen>=min_gen & file$gen<=max_gen & file$snake_newt_rep ==pattern),]
 
  params_temp<- data_frame(Newt_mean_Pheno=mean(sumitup$Newt_mean_Pheno),
                           Snake_mean_Pheno=mean(sumitup$Snake_mean_Pheno), 
                           Newt_mean_Pheno_sd=sd(sumitup$Newt_mean_Pheno),
                           Snake_mean_Pheno_sd=sd(sumitup$Snake_mean_Pheno),
                           Newt_pop_size=mean(sumitup$Newt_pop_size),
                           Snake_pop_size=mean(sumitup$Snake_pop_size),
                           dif=mean(sumitup$dif),
                           snake_mu_rate=sumitup$snake_mu_rate[1],
                           newt_mu_rate=sumitup$newt_mu_rate[1],
                           snake_mu_effect_sd=sumitup$snake_mu_effect_sd[1],
                           newt_mu_effect_sd=sumitup$newt_mu_effect_sd[1],
                           rep=sumitup$rep[1])
  
  
  params <- rbind(params, params_temp)
}

params$snake <- paste0(params$snake_mu_rate, "_",params$snake_mu_effect_sd)
params$newt <- paste0(params$newt_mu_rate, "_",params$newt_mu_effect_sd)
params$snake_newt <- paste0(params$snake, "_", params$newt)
return(params)
}

GA_summary <- function(file, min_gen, max_gen, x_line, y_line, title, subt, y_label, x_label){

file$snake_newt_rep <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd, "_", file$rep)

params<-create_parm_file(file, min_gen, max_gen)

my_plot <- ggplot(params) +
  #xlim(0, 1000)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_point(aes(x=as.numeric(get(x_line)), y=as.numeric(get(y_line)), color = factor(snake), shape=factor(newt)),size=3)+
#  geom_point(aes(x=as.numeric(Newt_pop_size_20), y=as.numeric(Snake_pop_size_20), color = factor(snake), shape=factor(newt)))+
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  #facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text( hjust=1, size = 8))

return(my_plot)
}

GA_summary_by_species <- function(file, min_gen, max_gen, x_line, y_line, title, subt, y_label, x_label){

file$snake_newt_rep <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd, "_", file$rep)

params<-create_parm_file(file, min_gen, max_gen)

my_plot <- ggplot(params) +
  #xlim(0, 1000)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_point(aes(x=(get(x_line)), y=(get(y_line)), color = factor(snake), shape=factor(newt)),size=3)+
#  geom_point(aes(x=as.numeric(Newt_pop_size_20), y=as.numeric(Snake_pop_size_20), color = factor(snake), shape=factor(newt)))+
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  #facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text( hjust=1, size = 8))

return(my_plot)
}

build_heatmap <- function(file, min_gen, max_gen, fill_line, fill_line_text, title, subt, y_label, x_label, red_blue=F){
  file$snake_newt_rep <- paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd, "_", file$newt_mu_rate, "_", file$newt_mu_effect_sd, "_", file$rep)
  params<-create_parm_file(file, min_gen, max_gen)
  
 my_plot <- ggplot(params, aes(newt, paste0(snake, "_", rep))) +    # Create heatmap with ggplot2
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_tile(aes(fill = get(fill_line)))+theme(axis.text.x = element_text(angle = 45, hjust=1, size = 10), axis.text.y = element_text(size = 10))
 
 if(red_blue==FALSE){
  my_plot<- my_plot + scale_fill_viridis_c(name = fill_line_text) + theme(legend.text=element_text(angle = 45, hjust=1, size=10))
  }
 if(red_blue==TRUE){
  my_plot<- my_plot + scale_fill_gradient2(low = "red",mid = "beige", high = "blue", name = fill_line_text) + theme(legend.text=element_text(size=5))
 }
 
  return(my_plot)
}

trends_by_gen <- function(file, title, subt, x_label, y_label, min_gen, max_gen){
 
  plot <- ggplot(file[ which(file$generation>=min_gen & file$generation<=max_gen),]) +
    facet_wrap(~sim)+
    geom_line(aes(generation, dif, group=rep, col="dif"))+
    ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
    geom_line(aes(generation, Snake_mean_Pheno, group=rep, color="Snake_mean_Pheno"),)+
    geom_line(aes(generation, Newt_mean_Pheno, group=rep, color="Newt_mean_Pheno"))+
    geom_hline(yintercept=0, linetype="dashed", color="gray54")+
    ylim(-1.,2.5)+
    xlab(x_label) + ylab(y_label)+
    scale_color_manual(name = "Type",
values = c( "Snake_mean_Pheno" = "steelblue", "Newt_mean_Pheno" = "darkred", "dif" = "black"),
labels = c("Snake", "Newt", "Dif"))+
    theme_bw() + theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())
  return(plot)
}

whale_gen <- function(file, title, subt, x_label, y_label,min_gen, max_gen, rep){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
dif <- ggplot(file[ which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep),]) +
  #xlim(0, 1000)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen, rep ",rep)) +
  xlab(x_label) + ylab(y_label)+
  geom_point(aes(x=as.numeric(Newt_pop_size), y=as.numeric(Snake_pop_size), color = dif))+
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}


pop_size_hist <- function(file, title, subt, x_label, y_label,min_gen, max_gen, rep){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  file<-file[ which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep),]
  themin <- min(file$Snake_pop_size-file$Newt_pop_size) 
  themax <- max(file$Snake_pop_size-file$Newt_pop_size)
  true_max <- max(abs(themin), abs(themax))
dif <- ggplot(file) +
  #xlim(0, 1000)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(Snake_pop_size-Newt_pop_size), fill="darkolivegreen4")+
  xlim((-1*themax)-5, themax+5)+
  theme(plot.title = element_text(size=5)) +
  facet_wrap(~sim)+
  geom_vline(xintercept = 0)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)
}

pheno_dif_hist <- function(file, title, subt, x_label, y_label,min_gen, max_gen, rep){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  file<-file[ which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep),]
  
  themin <- min(file$dif) 
  themax <- max(file$dif)
  true_max <- max(abs(themin), abs(themax))
dif <- ggplot(file) +
  #xlim(0, 1000)+
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen, rep ",rep)) +
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(dif), fill="aquamarine4")+
  xlim((-1*true_max)-1, true_max+1)+

  # y=as.numeric(Snake_pop_size-Newt_pop_size), color = snake_GA, shape = factor(newt_GA)
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  geom_vline(xintercept = 0)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}




two_hist <- function(file, title, subt, x_label, y_label,min_gen, max_gen, rep){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  
  file<-file[ which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep),]
  
  thepopmin <- min(file$Snake_pop_size-file$Newt_pop_size)/1000 
  thepopmax <- max(file$Snake_pop_size-file$Newt_pop_size)/1000
  thedifmin <- min(file$dif) 
  thedifmax <- max(file$dif)
  true_max <- max(abs(thepopmin), abs(thepopmax),abs(thedifmin), abs(thedifmax))

  data_points <- nrow(file[which(file$generation>=min_gen & file$generation<=max_gen & file$rep==rep &  file$snake_GA==file$snake_GA[1] &  file$newt_GA==file$newt_GA[1]),])
dif <- ggplot(file) +
  
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen, rep ",rep)) +
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=dif, y=..count../data_points), fill="#8B008B",  alpha = 0.65)+
  geom_histogram(aes(x=(Snake_pop_size-Newt_pop_size)/1000, y=..count../data_points), fill="#008B00",  alpha = 0.65)+
  scale_y_continuous(labels = scales::percent)+
  xlim((-1*true_max), true_max)+
  # y=as.numeric(Snake_pop_size-Newt_pop_size), color = snake_GA, shape = factor(newt_GA)
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  geom_vline(xintercept = 0)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      # strip.background = element_blank(), 
                      # strip.text.x = element_blank(), 
                      # panel.grid.major = element_blank(), 
                      # panel.grid.minor = element_blank(),
                      # panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}

two_hist_all_rep <- function(file, title, subt, x_label, y_label,min_gen, max_gen){
  #file$rep==rep
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  
  file<-file[ which(file$generation>=min_gen & file$generation<=max_gen),]
  
  thepopmin <- min(file$Snake_pop_size-file$Newt_pop_size)/100 
  thepopmax <- max(file$Snake_pop_size-file$Newt_pop_size)/100
  thedifmin <- min(file$dif) 
  thedifmax <- max(file$dif)
  true_max <- max(abs(thepopmin), abs(thepopmax),abs(thedifmin), abs(thedifmax))

  data_points <- nrow(file[which(file$generation>=min_gen & file$generation<=max_gen  &  file$snake_GA==file$snake_GA[1] &  file$newt_GA==file$newt_GA[1]),])
  
dif <- ggplot(file) +
  
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=dif, y=..count../data_points), fill="#8B008B",  alpha = 0.65, bins = 20)+ #purple
  geom_histogram(aes(x=(Snake_pop_size-Newt_pop_size)/100, y=..count../data_points), fill="#008B00",  alpha = 0.65, bins = 20)+ #green
  scale_y_continuous(labels = scales::percent)+
  xlim((-1*true_max)-1, true_max+1)+
  # y=as.numeric(Snake_pop_size-Newt_pop_size), color = snake_GA, shape = factor(newt_GA)
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  geom_vline(xintercept = 0)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      #strip.background = element_blank(), 
                      strip.text.x = element_blank(), 
                      #panel.grid.major = element_blank(), 
                      #panel.grid.minor = element_blank(),
                      #panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}

two_hist_death_all_rep <- function(file, title, subt, x_label, y_label,min_gen, max_gen){
  #file=inter_tall_tall_file
  file$snake_GA<-paste0(file$snake_mu_rate, "_", file$snake_mu_effect_sd)
  file$newt_GA<-paste0(file$newt_mu_rate, "_", file$newt_mu_effect_sd)
  
  file<-file[ which(file$generation>=min_gen & file$generation<=max_gen),]
  
  thepopmin <- min(file$newt_deaths)
  thepopmax <- max(file$newt_deaths)
  thedifmin <- min(file$snake_deaths) 
  thedifmax <- max(file$snake_deaths)
  true_max <- max(abs(thepopmin), abs(thepopmax),abs(thedifmin), abs(thedifmax))

  data_points <- nrow(file[which(file$generation>=min_gen & file$generation<=max_gen  &  file$snake_GA==file$snake_GA[1] &  file$newt_GA==file$newt_GA[1]),])
  
dif <- ggplot(file) +
  
  ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
  xlab(x_label) + ylab(y_label)+
  geom_histogram(aes(x=newt_deaths), fill="red",  alpha = 0.65, bins = 20)+
  geom_histogram(aes(x=snake_deaths), fill="blue",  alpha = 0.65, bins = 20)+
  #scale_y_continuous(labels = scales::percent)+
  #xlim((-1*true_max)-1, true_max+1)+
  # y=as.numeric(Snake_pop_size-Newt_pop_size), color = snake_GA, shape = factor(newt_GA)
  #paste0(snake_mu_rate, "_", snake_mu_effect_sd), shape = paste0(newt_mu_rate, "_", newt_mu_effect_sd), group=T)
  theme(plot.title = element_text(size=5)) +
  #scale_colour_gradient2(high = "steelblue", mid = "beige", low = "darkred")+
  #labs(colour = color_label) +
  facet_wrap(~sim)+
  #geom_vline(xintercept = 0)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), 
                      #strip.background = element_blank(), 
                      strip.text.x = element_blank(), 
                      #panel.grid.major = element_blank(), 
                      #panel.grid.minor = element_blank(),
                      #panel.background = element_blank(), 
                      axis.line = element_line(colour = "black"))

return(dif)

}

#two_hist_death_all_rep(inter_tall_tall_file, title="Snake-Newt Winning Hist", subt="Gen 16sims", y_label="Count", x_label="Snake-Newt Phenotype (purple) & Snake-Newt Popsize/100 (green)",  min_gen=20000, max_gen=25000)

```


## Mean Phenotype Whole Simulation {.tabset}

This section explores how mutation rate with mutation effect size (GAs of newts and snakes) and the lack of newt-snake interaction affects newt and snake phenotypes over time. This figure has 16 GA combinations with four trials per combination. Mean newt phenotype is represented by the red lines, while mean snake phenotype is represented by the blue lines. The black lines is the difference between snake and newt mean phenotype. This section also has a table that states the average difference between snake and newt mean phenotypes from 100-50,000 generations.

### Phenotype differences
```{r, graphing by gen}
trends_by_gen(inter_tall_tall_file, title="Space Tall: Newt VS Snake Population Size GA1", subt="Gen 16sims", y_label="Mean Phenotype", x_label="Generations", 100, 50000)


#aggregate(inter_tall_tall_file[which(inter_tall_tall_file$generation>=100 & inter_tall_tall_file$generation<=50000),]$dif, list(inter_tall_tall_file[which(inter_tall_tall_file$generation>=100 & inter_tall_tall_file$generation<=50000),]$group_rep), FUN=mean) 

```

### Table of average Differences

```{r, average difference}
aggregate(inter_tall_tall_file[which(inter_tall_tall_file$generation>=100 & inter_tall_tall_file$generation<=50000),]$dif, list(inter_tall_tall_file[which(inter_tall_tall_file$generation>=100 & inter_tall_tall_file$generation<=50000),]$group), FUN=mean) 
```

## {-}

Wow, this figure is really interesting. It is very mirrored across the diagonal. It seems like when there is a GA with more effect size variance the species' phenotype drops (fairly quickly) to 0. The phenotypes of newts and snakes tend to stay around one or drop to 0. None of the phenotypes continuously increase. By looking at the table I see that the biggest difference in phenotype occurs when one species has a GA of 1e-11_5 and the other has a GA of 1e-08_0.005. I notices when GA were either the same or low (1e-08_0.005, 1e-09_0.05) the difference between snake and newt phenotype was small (~ 0.2 or lower). When the GA was high (1e-10_0.5, 1e-11_5) or further apart the difference between snake and newt phenotype was large (~ 0.43 or higher). Species with a higher mutational variance tended to have a lower mean phenotype. The difference in mutational variance lead to a positive or negative mean phenotype difference (when newts had a higher mutational variance the snake-newt mean phenotype difference was positive). 

## Connection between higher phenotype and population {.tabset}

The newt few figures check to see if there is a connection between population size and phenotype. The first figure compares the population size of newts and snake to the difference between mean snake and newt phenotype for a time slice (5,000-10,000 generations). Color in this plot represents the difference between snake and newt phenotype, with blue indicating snakes have a larger phenotype and red indicating newts have a larger phenotype. Cream color points indicate that the two phenotypes are nearly the same. The second figure present the histograms of the difference between snake and newt population size (green) and phenotype (purple) for a time slice (5,000-10,000 generations). 

### Phenotype differences
```{r, whale}
min_gen=5000
max_gen=10000
rep=0

whale_gen(inter_tall_tall_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Population Size", x_label="Newt Population Size", min_gen=min_gen, max_gen=max_gen, rep=rep )
```

### Phenotype & Populationsize differences
```{r, popsize and pheno}

suppressMessages(print(two_hist(inter_tall_tall_file, title="Snake-Newt Winning Hist", subt="Gen 16sims", y_label="Count", x_label="Snake-Newt Popsize/1000 (green) & Snake-Newt Phenotype (purple)",  min_gen=min_gen, max_gen=max_gen, rep=rep )))

#suppressMessages(print(two_hist_all_rep(inter_tall_tall_file, title="Snake-Newt Winning Hist", subt="Gen 16sims", y_label="Count", x_label="Snake-Newt Popsize/100 (green) & Snake-Newt Phenotype (purple)",  min_gen=min_gen, max_gen=max_gen)))


```

## {-}

The Newt VS Snake Population Size figure is very symmetrical. The species that has a higher mutational variance tends to have a lower phenotype. This figure can also be read as: the species with a larger mutational effect size has a lower phenotype or the species with a higher mutation rate has a higher phenotype. This plot matches what I observed in the section above: when GA were either the same or low (1e-08_0.005, 1e-09_0.05) the difference between snake and newt phenotype was small & when the GA was high (1e-10_0.5, 1e-11_5) or further apart the difference between snake and newt phenotype was large. When looking at the phenotype and population size differences plots I noticed a few patterns. Going across the difference in phenotype size moves right (snakes have a larger population size), going down the difference in phenotype size moves left (newts have a larger population size). The population sizes say about the same. Population size is not connected to phenotype?

## Correlation

The correlation section looks at how correlated newt and snake phenotypes are at a local level. The simulation map is divided into smaller grids, then the mean phenotype of newts and snakes is collected and a correlation value is calculated. The figure below shows the results of four trials for all 16 GA combinations. Snake mutation rate decreases while mutation effect size increase from left to right. Newt mutation rate decreases while mutation effect size increase from top to bottom. Newt and snake mutation rate and effect size are equal across the diagonal. 


```{r, combo myplots}
#files
#inter_tall_tall_file
#GA2_long_file 
#inter_cor_tall_file
#GA2_cor_file

# Legend: Not needed currently
# 
# - "CA" = mean_newt_pheno_By_mean_snake_pheno (Pink)
# - "CB" = num_newts_By_num_snakes (Green)
# - "CC" = sum_newt_pheno_By_num_snake (Blue)
# - "CD" = sum_snake_pheno_By_num_newt (Purple)

ginmin = 10000
ginmax = 15000

boxplot_cors_by_gen(inter_cor_tall_file, "Simulation Correlation Comparied to Real Correlation Trials", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)


#four_types_boxplot_cors_by_gen(inter_cor_tall_file, "Simulation four Correlation", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)


```

After looking at this figure, I can see that there is a range of correlation values. The correlation values can sometimes be positive, near 0, or negative. Some approach the real newt-snake correlation, which was unexpected. How often would newt and snake phenotypes be randomly correlated? How does individuals movements affect spatial correlation (my thought here: newts and snake phenotypes can become correlated if a newt and snake who live in a general vicinity both get a mutation that increases their fitness and the mutation spreads)? How does newt and snake interaction change correlation and the way a new mutation spreads?


## Correlation Histograms {.tabset}

In order to understand how spatial correlations where changing with time I took 5,000 generation time slices to look at all four trials correlation values. Each color is a different trial per GA combination. The histogram values are stacked. 

### Plot 1
```{r, GA1 cor by dif windows}
ginmin = 0
ginmax = 5000
suppressMessages(print(hist_cors_by_gen_col_rep(inter_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))
```

### Plot 2

```{r, GA1 cor by dif windows 2}
ginmin = 5000
ginmax = 10000
suppressMessages(print(hist_cors_by_gen_col_rep(inter_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))
```

### Plot 3
```{r, GA1 cor by dif windows 3}
ginmin = 10000
ginmax = 15000
suppressMessages(print(hist_cors_by_gen_col_rep(inter_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))
```

### Plot 4
```{r, GA1 cor by dif windows 4}
ginmin = 15000
ginmax = 20000
suppressMessages(print(hist_cors_by_gen_col_rep(inter_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))
```

### Plot 5
```{r, GA1 cor by dif windows 5}
ginmin = 20000
ginmax = 25000
suppressMessages(print(hist_cors_by_gen_col_rep(inter_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))
```

### Plot 6
```{r, GA1 cor by dif windows 6}
ginmin = 25000
ginmax = 30000
suppressMessages(print(hist_cors_by_gen_col_rep(inter_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))
```

### Plot 7
```{r, GA1 cor by dif windows 7}
ginmin = 30000
ginmax = 35000
suppressMessages(print(hist_cors_by_gen_col_rep(inter_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))
```

### Plot 8
```{r, GA1 cor by dif windows 8}
ginmin = 35000
ginmax = 40000
suppressMessages(print(hist_cors_by_gen_col_rep(inter_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))
```

### Plot 9
```{r, GA1 cor by dif windows 9}
ginmin = 40000
ginmax = 45000
suppressMessages(print(hist_cors_by_gen_col_rep(inter_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))
```

### Plot 10
```{r, GA1 cor by dif windows 10}
ginmin = 45000
ginmax = 50000
suppressMessages(print(hist_cors_by_gen_col_rep(inter_cor_tall_file, "Simulation Correlation Comparied to Real Correlation", "GA1", "newt/snake GAs&rep", "Cor", ginmin, ginmax)))
```

## {-}

As I move through time chunks there is a lot of movement of spatial correlation values. Most correlation values are near 0, but a few become very correlated (both positive and negative). The most noticeable ones occur in the first group of four (A, B, E, F). I wonder if there is an even number of strong positive and negative correlation values (this would make it more of a random process). 

## Correlation across time {.tabset}

This next section examines how newt and snake mean phenotype (red and blue) and the newt-snake phenotype (pink) is correlated across time. There are three randomly chosen figures to represent the 16 GA combinations.


### Random 1
```{r, GA1 cor and pheno}
GA1_pattern <- unique(paste0(inter_tall_tall_file$snake_mu_rate, "_", inter_tall_tall_file$snake_mu_effect_sd,"_",inter_tall_tall_file$newt_mu_rate, "_", inter_tall_tall_file$newt_mu_effect_sd, "_", inter_tall_tall_file$rep))

myrandomlist=sample.int(length(GA1_pattern), 3)

# for(i in myrandomlist){
#   myine<-cor_trends_by_gen(inter_tall_tall_file, inter_cor_tall_file, "test", "GA1", "newt/snake GAs&rep","other", "Cor", min_gen=100, max_gen=50000, pattern=GA1_pattern[i])
#   plot(myine)
# }

cor_trends_by_gen(inter_tall_tall_file, inter_cor_tall_file, "test", "GA1", "newt/snake GAs&rep","other", "Cor", min_gen=100, max_gen=50000, pattern=GA1_pattern[myrandomlist[1]])

```

### Random 2
```{r, random cor-pheno plot 2}

cor_trends_by_gen(inter_tall_tall_file, inter_cor_tall_file, "test", "GA1", "newt/snake GAs&rep","other", "Cor", min_gen=100, max_gen=50000, pattern=GA1_pattern[myrandomlist[2]])
```

### Random 3
```{r, random cor-pheno plot 3}

cor_trends_by_gen(inter_tall_tall_file, inter_cor_tall_file, "test", "GA1", "newt/snake GAs&rep","other", "Cor", min_gen=100, max_gen=50000, pattern=GA1_pattern[myrandomlist[3]])
```

## {-}

In this simulation experiment, newt and snakes have an interaction not based on their phenotype. This reduces the section presser placed on newts and snakes in a co-evolutionary arms race. In each of these examples newt/snake mean phenotype(s) drop close to 0 or stay around one. Potentially, they either drop or stay at one due a combination of mutation effect size and phenotype cost. Theoretically, if there is a cost for having a higher phenotype and no benefit, the mean phenotype would decrease. However, the mean phenotype is more likely to decrease to zero is there is a larger mutation effect size or more mutational variance. The spatial correlation goes up and down, making me wonder why. There is no reason for there to be high correlation, but it can happen randomly. I wonder if the individuals might be moving around too much. I wonder what would happen on a larger map? It would be cool to look at the spread of different mutations with different GA through the map/grids. It would also be interesting to change the number of grids to see if it effects this correlation calculation.


## What happens over time (looking at the beginning, middle, and late part of my simulations) {.tabset}

This next section is just getting a glimpse at how newt & snake phenotype and population size differ over time (beginning, middle, and end of my simulation). The populations start off with about 250 individuals each. Each individual has a different genetic background created from msprime. Plots show newt by snake population size, with the point color representing the difference between mean snake and newt phenotype. The other plots show histograms of difference between snakes and newts phenotype and population size (purple and green).

### Pheno Beginning 

```{r, early plots}


min_gen=100
max_gen=5000


# for(i in 1:length(unique(inter_tall_tall_file$rep))){
#   myine<-whale_gen(inter_tall_tall_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(inter_tall_tall_file$rep)[i])
#   plot(myine)
# 
# }
whale_gen(inter_tall_tall_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(inter_tall_tall_file$rep)[1])
```

### Pheno Middle 

```{r, middle plots}


min_gen=25000
max_gen=30000


# for(i in 1:length(unique(inter_tall_tall_file$rep))){
#   myine<-whale_gen(inter_tall_tall_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(inter_tall_tall_file$rep)[i])
#   plot(myine)
# 
# }
whale_gen(inter_tall_tall_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(inter_tall_tall_file$rep)[1])
```

### Pheno End 

```{r, end plots}


min_gen=45000
max_gen=50000


# for(i in 1:length(unique(inter_tall_tall_file$rep))){
#   myine<-whale_gen(inter_tall_tall_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(inter_tall_tall_file$rep)[i])
#   plot(myine)
# 
# }
whale_gen(inter_tall_tall_file, title="Space: Newt VS Snake Population Size Color=S-N Phenotype", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize", min_gen=min_gen, max_gen=max_gen, rep=unique(inter_tall_tall_file$rep)[1])
```

### Dif Beginning 
```{r, early plots 1a}


min_gen=100
max_gen=5000


# for(i in 1:length(unique(inter_tall_tall_file$rep))){
#   myine<-two_hist(inter_tall_tall_file, title="Snake-Newt Winning Hist", subt="Gen 16sims", y_label="Count", x_label="Snake-Newt Phenotype (purple) & Snake-Newt Popsize/100 (green)",  min_gen=min_gen, max_gen=max_gen, rep=unique(inter_tall_tall_file$rep)[i] )
#   suppressMessages(plot(myine))
# }

two_hist(inter_tall_tall_file, title="Snake-Newt Winning Hist", subt="Gen 16sims", y_label="Count", x_label="Snake-Newt Phenotype (purple) & Snake-Newt Popsize/100 (green)",  min_gen=min_gen, max_gen=max_gen, rep=unique(inter_tall_tall_file$rep)[1] )

```

### Dif Middle 
```{r, early plots 2a}


min_gen=25000
max_gen=30000


# for(i in 1:length(unique(inter_tall_tall_file$rep))){
#   myine<-two_hist(inter_tall_tall_file, title="Snake-Newt Winning Hist", subt="Gen 16sims", y_label="Count", x_label="Snake-Newt Phenotype (purple) & Snake-Newt Popsize/100 (green)",  min_gen=min_gen, max_gen=max_gen, rep=unique(inter_tall_tall_file$rep)[i] )
#   suppressMessages(plot(myine))
# }

two_hist(inter_tall_tall_file, title="Snake-Newt Winning Hist", subt="Gen 16sims", y_label="Count", x_label="Snake-Newt Phenotype (purple) & Snake-Newt Popsize/100 (green)",  min_gen=min_gen, max_gen=max_gen, rep=unique(inter_tall_tall_file$rep)[1] )

```

### Dif End 
```{r, early plots 3a}


min_gen=45000
max_gen=50000


# for(i in 1:length(unique(inter_tall_tall_file$rep))){
#   myine<-two_hist(inter_tall_tall_file, title="Snake-Newt Winning Hist", subt="Gen 16sims", y_label="Count", x_label="Snake-Newt Phenotype (purple) & Snake-Newt Popsize/100 (green)",  min_gen=min_gen, max_gen=max_gen, rep=unique(inter_tall_tall_file$rep)[i] )
#   suppressMessages(plot(myine))
# }

two_hist(inter_tall_tall_file, title="Snake-Newt Winning Hist", subt="Gen 16sims", y_label="Count", x_label="Snake-Newt Phenotype (purple) & Snake-Newt Popsize/100 (green)",  min_gen=min_gen, max_gen=max_gen, rep=unique(inter_tall_tall_file$rep)[1] )

```

## {-}

As seen in some previous plots, results are very mirrored across the diagonal. It seems like which ever species has a higher mutational variance or higher mutational effect size had a lower phenotype (seen in both types of figures). The populations remained constant across GA combinations (both types of figures). After an initial population size increase, population sizes became steady (snakes had a higher population size, probably due to fitness advantage for randomly being successful in eating a newt).

## Summary {.tabset}

In the summary section, I try to come up with a way to show how different GA combinations can change the simulations results. In all of these plots snakes GA is represented by color and newt GA is represented by shape. There 16 color-shape combinations (with 4 repeats for trials). There are four sets of plots: 1) newt by snake population size, 2) phenotype difference by snake population size, 3) phenotype difference by snake GA, and 4) phenotype difference by newt GA. There are three figures in each set, taken at the begging, middle, and end time chunks. 

### Early-Sim Population Size Summary 

```{r, early plots summary}

min_gen=100
max_gen=5000
GA_summary(inter_tall_tall_file, min_gen=min_gen, max_gen=max_gen, x_line="Newt_pop_size", y_line="Snake_pop_size", title="Space: Newt VS Snake Population Size", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize")
```

### Mid-Sim Population Size Summary
```{r, plots summary 2}
# summary

min_gen=25000
max_gen=30000

# summary
GA_summary(inter_tall_tall_file, min_gen=min_gen, max_gen=max_gen, x_line="Newt_pop_size", y_line="Snake_pop_size", title="Space: Newt VS Snake Population Size", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize")
```

### Late-Sim Population Size Summary
```{r, plots summary 3}
min_gen=45000
max_gen=50000

# summary
GA_summary(inter_tall_tall_file, min_gen=min_gen, max_gen=max_gen, x_line="Newt_pop_size", y_line="Snake_pop_size", title="Space: Newt VS Snake Population Size", subt="Gen 16sims", y_label="Snake Popsize", x_label="Newt Popsize")

```

### Early Difference Summary
```{r, dif plots summary 1}

min_gen=100
max_gen=5000

GA_summary(inter_tall_tall_file, min_gen=min_gen, max_gen=max_gen, x_line="dif", y_line="Snake_pop_size", title="Space: Dif VS Snake Population Size", subt="Gen 16sims", y_label="Snake Popsize", x_label="Dif")
```

### Mid Difference Summary
```{r, dif plots summary 2}
min_gen=25000
max_gen=30000


GA_summary(inter_tall_tall_file, min_gen=min_gen, max_gen=max_gen, x_line="dif", y_line="Snake_pop_size", title="Space: Dif VS Snake Population Size", subt="Gen 16sims", y_label="Snake Popsize", x_label="Dif")

```

### Late Difference Summary
```{r, dif plots summary 3}
min_gen=45000
max_gen=50000
GA_summary(inter_tall_tall_file, min_gen=min_gen, max_gen=max_gen, x_line="dif", y_line="Snake_pop_size", title="Space: Dif VS Snake Population Size", subt="Gen 16sims", y_label="Snake Popsize", x_label="Dif")


```

### By Snake GA (Early)
```{r, snakega plots summary 1}
min_gen=100
max_gen=5000
#

GA_summary_by_species(inter_tall_tall_file, min_gen=min_gen, max_gen=max_gen, x_line="dif", y_line="snake", title="Space: Dif VS Snake Population Size", subt="Gen 16sims", y_label="Snake GA", x_label="Dif")

```

### By Snake GA (Mid)
```{r, snakega plots summary 2}
min_gen=25000
max_gen=30000
#

GA_summary_by_species(inter_tall_tall_file, min_gen=min_gen, max_gen=max_gen, x_line="dif", y_line="snake", title="Space: Dif VS Snake Population Size", subt="Gen 16sims", y_label="Snake GA", x_label="Dif")

```

### By Snake GA (Late)
```{r, snakega plots summary 3}
min_gen=45000
max_gen=50000
#

GA_summary_by_species(inter_tall_tall_file, min_gen=min_gen, max_gen=max_gen, x_line="dif", y_line="snake", title="Space: Dif VS Snake Population Size", subt="Gen 16sims", y_label="Snake GA", x_label="Dif")

```

### By Newt GA (Early)
```{r, newtga plots summary 1}
min_gen=100
max_gen=5000
#

GA_summary_by_species(inter_tall_tall_file, min_gen=min_gen, max_gen=max_gen, x_line="dif", y_line="newt", title="Space: Dif VS Newt Population Size", subt="Gen 16sims", y_label="Newt GA", x_label="Dif")

```

### By Newt GA (Mid)
```{r, newtga plots summary 2}
min_gen=25000
max_gen=30000
#

GA_summary_by_species(inter_tall_tall_file, min_gen=min_gen, max_gen=max_gen, x_line="dif", y_line="newt", title="Space: Dif VS Newt Population Size", subt="Gen 16sims", y_label="Newt GA", x_label="Dif")

```


### By Newt GA (Late)
```{r, newtga plots summary 3}
min_gen=45000
max_gen=50000
#

GA_summary_by_species(inter_tall_tall_file, min_gen=min_gen, max_gen=max_gen, x_line="dif", y_line="newt", title="Space: Dif VS Newt Population Size", subt="Gen 16sims", y_label="Newt GA", x_label="Dif")

```

## {-}


After examining these plots I found that there is no relationship between GA and population size or population size and phenotype. However, there is an interaction between GA and phenotype blue/purple on the left and red/green on the right & (to a less noticeable degree) triangle/circle on the left and square/plus on the right (higher mutational variance lead to a lower phenotype). When looking at the by snake plot, GA newt GA is lined up from lowest mutation variance to highest mutational variance. This suggest that a higher newt variance led to a lower newt phenotype (possibly pushed down due to cost and no interaction). This pattern is reversed when looking at the plot of newt GA. On the newt GA plot, snake GA is lined up purple, blue, green, and red. This also indicates that a higher mutational variance led to a lower phenotype. This is really interesting!

## Heatmap {.tabset}

This next sections shows the results of the previous section in a more condensed fashion. There are two types of plots. Each have newt GA on the x-axis and snake GA and trial number on the y-axis. The first plot set shows the snake population size, while the second plot set shows the difference between mean snake and newt phenotype.

### Population Size (Early) 

```{r, early plots Heatmap}

min_gen=100
max_gen=5000
#heatmap
build_heatmap(inter_tall_tall_file, min_gen=min_gen, max_gen=max_gen, fill_line="Snake_pop_size", fill_line_text="Snake Population Size", title="Newt GA by Snake GA", subt="16 Sim Heatmap", y_label="Snake GA", x_label="Newt GA", red_blue=F)
```

### Population Size (Mid)  
```{r, early plots Heatmap 2}
min_gen=25000
max_gen=30000
#heatmap
build_heatmap(inter_tall_tall_file, min_gen=min_gen, max_gen=max_gen, fill_line="Snake_pop_size", fill_line_text="Snake Population Size", title="Newt GA by Snake GA", subt="16 Sim Heatmap", y_label="Snake GA", x_label="Newt GA", red_blue=F)

```

### Population Size (Late) 
```{r, early plots Heatmap 3}
min_gen=45000
max_gen=50000
#heatmap
build_heatmap(inter_tall_tall_file, min_gen=min_gen, max_gen=max_gen, fill_line="Snake_pop_size", fill_line_text="Snake Population Size", title="Newt GA by Snake GA", subt="16 Sim Heatmap", y_label="Snake GA", x_label="Newt GA", red_blue=F)
```

### Phenotype (Early) 
```{r, early plots Heatmap pheno 1}
min_gen=100
max_gen=5000
build_heatmap(inter_tall_tall_file, min_gen=min_gen, max_gen=max_gen, fill_line="dif", fill_line_text="Snake-Newt", title="Newt GA by Snake GA", subt="16 Sim Heatmap", y_label="Snake GA", x_label="Newt GA",red_blue=T)
```

### Phenotype (Mid) 
```{r, early plots Heatmap pheno 2}

min_gen=25000
max_gen=30000
#heatmap

build_heatmap(inter_tall_tall_file, min_gen=min_gen, max_gen=max_gen, fill_line="dif", fill_line_text="Snake-Newt", title="Newt GA by Snake GA", subt="16 Sim Heatmap", y_label="Snake GA", x_label="Newt GA",red_blue=T)
```

### Phenotype (Late) 
```{r, early plots Heatmap pheno 3}
min_gen=45000
max_gen=50000
#heatmap

build_heatmap(inter_tall_tall_file, min_gen=min_gen, max_gen=max_gen, fill_line="dif", fill_line_text="Snake-Newt", title="Newt GA by Snake GA", subt="16 Sim Heatmap", y_label="Snake GA", x_label="Newt GA",red_blue=T)

```

## {-}

The results of this section how that there is no relationship between GA and population size (colors seem random). There is a ver noticeable relationship between GA and phenotype. Again, the difference in phenotype is symmetrical across the diagonal (right diagonal this time). Species have a higher phenotype is they have a GA with lower mutational variance. This might be due to the mutational effect size distribution and phenotype cost. What would change if I re-did this simulation and removed the cost? - I think that it is possible for the phenotypes to drift upwards  

## What is up with the correlations

This is the last results section. These are the results from the grid calculations. I divided my map up into smaller area (grids) and calculated mean phenotype, SD phenotype, max phenotype, min phenotype, and population size. In each of these plots newts are represented by circles and snakes are represented by squares. Parameter values increase from a dark color to a lighter color (green-blue themed for phenotype, orange-pinked themed for population size) There is also a subplot that plots each parameter (mean, sd...) of newt by snake colored by map location (red=corner, green=edge, blue=middle). I look at the some simulation at one time in the begging, middle, and end.


### Early Simulation Correlation {.tabset}


#### Mean 
```{r, cor grid high cor mean}

#inter_inter_grid_tall_file


file_name="Snake_1e-08_0.005_Newt_1e-08_0.005_3"
spegen=101
 #"Snake_1e-11_0.158_Newt_1e-10_0.05_0"

#Snake_1.0e-08_0.005_Newt_1.0e-11_0.158_0

GA1<-inter_inter_grid_tall_file[which(inter_inter_grid_tall_file$snake_newt_rep==file_name & inter_inter_grid_tall_file$generation==spegen),]

GA1_mean = GA1[,grepl("generation|mean", names(GA1)) ]

data_long_mean <- gather(GA1_mean, condition, measurement, newt_mean_pheno_0:snake_mean_pheno_99, factor_key=TRUE)

data_long_mean[,c("species","type", "type2","location")]<- str_split_fixed(data_long_mean$condition, "_", 4)

data_long_mean_short<-data_long_mean

data_long_mean_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
data_long_mean_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))

main_plot<-ggplot(data_long_mean_short)+
  labs(title = "Mean Phenotype of Locations",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Toxicity/Resistance")+
  geom_point(data = data_long_mean_short[which(data_long_mean_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = data_long_mean_short[which(data_long_mean_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c()+
  theme_bw()+
  theme(legend.justification = "top")

snake<-data_long_mean_short[which(data_long_mean_short$species=="snake"),]
newt<-data_long_mean_short[which(data_long_mean_short$species=="newt"),]
newt$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt$measurement), use="complete.obs")


newt$info[newt$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt$info[newt$location %in% list(0, 19, 80, 99)] <- "corner"
newt$info[is.na(newt$info)]<- "middle"

extra_plot <- ggplot(newt)+
  ggtitle("Mean Phenotype") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)
```

#### SD 
```{r, cor grid high cor SD}

file_name="Snake_1e-08_0.005_Newt_1e-08_0.005_3"
spegen=101
# SD

GA1_sd = GA1[,grepl("generation|sd", names(GA1)) ]

data_long_sd <- gather(GA1_sd, condition, measurement, newt_sd_pheno_0:snake_sd_pheno_99, factor_key=TRUE)

data_long_sd[,c("species","type", "type2","location")]<- str_split_fixed(data_long_sd$condition, "_", 4)

data_long_sd_short<-data_long_sd

data_long_sd_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
data_long_sd_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))

main_plot<-ggplot(data_long_sd_short)+
  labs(title = "SD Phenotype of Locations",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Toxicity/Resistance")+
  geom_point(data = data_long_sd_short[which(data_long_sd_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = data_long_sd_short[which(data_long_sd_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c()+
  theme_bw()+
  theme(legend.justification = "top")

snake<-data_long_sd_short[which(data_long_sd_short$species=="snake"),]
newt<-data_long_sd_short[which(data_long_sd_short$species=="newt"),]
newt$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt$measurement), use="complete.obs")


newt$info[newt$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt$info[newt$location %in% list(0, 19, 80, 99)] <- "corner"
newt$info[is.na(newt$info)]<- "middle"

extra_plot <- ggplot(newt)+
  ggtitle("SD Phenotype") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)
```

#### Max Phenotype 
```{r, cor grid high cor max}

# max phenotype
file_name="Snake_1e-08_0.005_Newt_1e-08_0.005_3"
spegen=101

GA1_max = GA1[,grepl("generation|max", names(GA1)) ]

data_long_max <- gather(GA1_max, condition, measurement, newt_max_pheno_0:snake_max_pheno_99, factor_key=TRUE)

data_long_max[,c("species","type", "type2","location")]<- str_split_fixed(data_long_max$condition, "_", 4)

data_long_max_short<-data_long_max

data_long_max_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
data_long_max_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))

main_plot<-ggplot(data_long_max_short)+
  labs(title = "Max Phenotype of Locations",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Toxicity/Resistance")+
  geom_point(data = data_long_max_short[which(data_long_max_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = data_long_max_short[which(data_long_max_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c()+
  theme_bw()+
  theme(legend.justification = "top")

snake<-data_long_max_short[which(data_long_max_short$species=="snake"),]
newt<-data_long_max_short[which(data_long_max_short$species=="newt"),]
newt$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt$measurement), use="complete.obs")


newt$info[newt$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt$info[newt$location %in% list(0, 19, 80, 99)] <- "corner"
newt$info[is.na(newt$info)]<- "middle"

extra_plot <- ggplot(newt)+
  ggtitle("Max Phenotype") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)
```

#### Min Phenotype 
```{r, cor grid high cor min}

# min phenotype
file_name="Snake_1e-08_0.005_Newt_1e-08_0.005_3"
spegen=101

GA1_min = GA1[,grepl("generation|min", names(GA1)) ]

data_long_min <- gather(GA1_min, condition, measurement, newt_min_pheno_0:snake_min_pheno_99, factor_key=TRUE)

data_long_min[,c("species","type", "type2","location")]<- str_split_fixed(data_long_min$condition, "_", 4)

data_long_min_short<-data_long_min

data_long_min_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
data_long_min_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))

main_plot<-ggplot(data_long_min_short)+
  labs(title = "Min Phenotype of Locations",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Toxicity/Resistance")+
  geom_point(data = data_long_min_short[which(data_long_min_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = data_long_min_short[which(data_long_min_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c()+
  theme_bw()+
  theme(legend.justification = "top")

snake<-data_long_min_short[which(data_long_min_short$species=="snake"),]
newt<-data_long_min_short[which(data_long_min_short$species=="newt"),]
newt$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt$measurement), use="complete.obs")


newt$info[newt$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt$info[newt$location %in% list(0, 19, 80, 99)] <- "corner"
newt$info[is.na(newt$info)]<- "middle"

extra_plot <- ggplot(newt)+
  ggtitle("Min Phenotype") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)
```

#### Population Size
```{r, cor grid high cor popsize}

# popsize
file_name="Snake_1e-08_0.005_Newt_1e-08_0.005_3"
spegen=101
#inter_inter_grid_tall_file population size

GA1_ind = GA1[,grepl("generation|num_ind", names(GA1)) ]

GA1_data_long_ind <- gather(GA1_ind, condition, measurement, newt_num_ind_0:snake_num_ind_99, factor_key=TRUE)

GA1_data_long_ind[,c("species","type", "type2","location")]<- str_split_fixed(GA1_data_long_ind$condition, "_", 4)

GA1_data_long_ind_short<-GA1_data_long_ind

GA1_data_long_ind_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
GA1_data_long_ind_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))

GA1_data_long_ind_short$measurement[GA1_data_long_ind_short$measurement == 0]  <- NA

main_plot<-ggplot(GA1_data_long_ind_short)+
  labs(title = "Locations of Ind",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Number of Individuals")+
  geom_point(data = GA1_data_long_ind_short[which(GA1_data_long_ind_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = GA1_data_long_ind_short[which(GA1_data_long_ind_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c(option = "plasma")+
  theme_bw()+
  theme(legend.justification = "top")

snake<-GA1_data_long_ind_short[which(GA1_data_long_ind_short$species=="snake"),]
newt_GA1<-GA1_data_long_ind_short[which(GA1_data_long_ind_short$species=="newt"),]
newt_GA1$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt_GA1$measurement), use="complete.obs")



newt_GA1$info[newt_GA1$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt_GA1$info[newt_GA1$location %in% list(0, 19, 80, 99)] <- "corner"
newt_GA1$info[is.na(newt_GA1$info)]<- "middle"

extra_plot <- ggplot(newt_GA1)+
  ggtitle("Num of Ind") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)
    
```

### {-}

### Middle Simulation Correlation {.tabset}


#### Mean 
```{r, cor grid zerp cor mean}

file_name="Snake_1e-08_0.005_Newt_1e-08_0.005_3"
spegen=25001
 #"Snake_1e-11_0.158_Newt_1e-10_0.05_0"

#Snake_1.0e-08_0.005_Newt_1.0e-11_0.158_0


GA1<-inter_inter_grid_tall_file[which(inter_inter_grid_tall_file$snake_newt_rep==file_name & inter_inter_grid_tall_file$generation==spegen),]

GA1_mean = GA1[,grepl("generation|mean", names(GA1)) ]

data_long_mean <- gather(GA1_mean, condition, measurement, newt_mean_pheno_0:snake_mean_pheno_99, factor_key=TRUE)

data_long_mean[,c("species","type", "type2","location")]<- str_split_fixed(data_long_mean$condition, "_", 4)

data_long_mean_short<-data_long_mean

data_long_mean_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
data_long_mean_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))

main_plot<-ggplot(data_long_mean_short)+
  labs(title = "Mean Phenotype of Locations",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Toxicity/Resistance")+
  geom_point(data = data_long_mean_short[which(data_long_mean_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = data_long_mean_short[which(data_long_mean_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c()+
  theme_bw()+
  theme(legend.justification = "top")

snake<-data_long_mean_short[which(data_long_mean_short$species=="snake"),]
newt<-data_long_mean_short[which(data_long_mean_short$species=="newt"),]
newt$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt$measurement), use="complete.obs")


newt$info[newt$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt$info[newt$location %in% list(0, 19, 80, 99)] <- "corner"
newt$info[is.na(newt$info)]<- "middle"

extra_plot <- ggplot(newt)+
  ggtitle("Mean Phenotype") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)
```

#### SD 
```{r, cor grid zero cor SD}

file_name="Snake_1e-08_0.005_Newt_1e-08_0.005_3"
spegen=25001
# SD

GA1_sd = GA1[,grepl("generation|sd", names(GA1)) ]

data_long_sd <- gather(GA1_sd, condition, measurement, newt_sd_pheno_0:snake_sd_pheno_99, factor_key=TRUE)

data_long_sd[,c("species","type", "type2","location")]<- str_split_fixed(data_long_sd$condition, "_", 4)

data_long_sd_short<-data_long_sd

data_long_sd_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
data_long_sd_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))

main_plot<-ggplot(data_long_sd_short)+
  labs(title = "SD Phenotype of Locations",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Toxicity/Resistance")+
  geom_point(data = data_long_sd_short[which(data_long_sd_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = data_long_sd_short[which(data_long_sd_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c()+
  theme_bw()+
  theme(legend.justification = "top")

snake<-data_long_sd_short[which(data_long_sd_short$species=="snake"),]
newt<-data_long_sd_short[which(data_long_sd_short$species=="newt"),]
newt$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt$measurement), use="complete.obs")


newt$info[newt$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt$info[newt$location %in% list(0, 19, 80, 99)] <- "corner"
newt$info[is.na(newt$info)]<- "middle"

extra_plot <- ggplot(newt)+
  ggtitle("SD Phenotype") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)
```

#### Max Phenotype 
```{r, cor grid zero cor max}

# max phenotype
file_name="Snake_1e-08_0.005_Newt_1e-08_0.005_3"
spegen=25001
GA1_max = GA1[,grepl("generation|max", names(GA1)) ]

data_long_max <- gather(GA1_max, condition, measurement, newt_max_pheno_0:snake_max_pheno_99, factor_key=TRUE)

data_long_max[,c("species","type", "type2","location")]<- str_split_fixed(data_long_max$condition, "_", 4)

data_long_max_short<-data_long_max

data_long_max_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
data_long_max_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))

main_plot<-ggplot(data_long_max_short)+
  labs(title = "Max Phenotype of Locations",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Toxicity/Resistance")+
  geom_point(data = data_long_max_short[which(data_long_max_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = data_long_max_short[which(data_long_max_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c()+
  theme_bw()+
  theme(legend.justification = "top")

snake<-data_long_max_short[which(data_long_max_short$species=="snake"),]
newt<-data_long_max_short[which(data_long_max_short$species=="newt"),]
newt$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt$measurement), use="complete.obs")


newt$info[newt$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt$info[newt$location %in% list(0, 19, 80, 99)] <- "corner"
newt$info[is.na(newt$info)]<- "middle"

extra_plot <- ggplot(newt)+
  ggtitle("Max Phenotype") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)
```

#### Min Phenotype 
```{r, cor grid zero cor min}

# min phenotype
file_name="Snake_1e-08_0.005_Newt_1e-08_0.005_3"
spegen=25001
GA1_min = GA1[,grepl("generation|min", names(GA1)) ]

data_long_min <- gather(GA1_min, condition, measurement, newt_min_pheno_0:snake_min_pheno_99, factor_key=TRUE)

data_long_min[,c("species","type", "type2","location")]<- str_split_fixed(data_long_min$condition, "_", 4)

data_long_min_short<-data_long_min

data_long_min_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
data_long_min_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))

main_plot<-ggplot(data_long_min_short)+
  labs(title = "Min Phenotype of Locations",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Toxicity/Resistance")+
  geom_point(data = data_long_min_short[which(data_long_min_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = data_long_min_short[which(data_long_min_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c()+
  theme_bw()+
  theme(legend.justification = "top")

snake<-data_long_min_short[which(data_long_min_short$species=="snake"),]
newt<-data_long_min_short[which(data_long_min_short$species=="newt"),]
newt$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt$measurement), use="complete.obs")


newt$info[newt$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt$info[newt$location %in% list(0, 19, 80, 99)] <- "corner"
newt$info[is.na(newt$info)]<- "middle"

extra_plot <- ggplot(newt)+
  ggtitle("Min Phenotype") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)
```

#### Population Size
```{r, cor grid zer cor popsize}

# max phenotype
file_name="Snake_1e-08_0.005_Newt_1e-08_0.005_3"
spegen=25001

GA1_ind = GA1[,grepl("generation|num_ind", names(GA1)) ]

GA1_data_long_ind <- gather(GA1_ind, condition, measurement, newt_num_ind_0:snake_num_ind_99, factor_key=TRUE)

GA1_data_long_ind[,c("species","type", "type2","location")]<- str_split_fixed(GA1_data_long_ind$condition, "_", 4)

GA1_data_long_ind_short<-GA1_data_long_ind

GA1_data_long_ind_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
GA1_data_long_ind_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))

GA1_data_long_ind_short$measurement[GA1_data_long_ind_short$measurement == 0]  <- NA

main_plot<-ggplot(GA1_data_long_ind_short)+
  labs(title = "Locations of Ind",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Number of Individuals")+
  geom_point(data = GA1_data_long_ind_short[which(GA1_data_long_ind_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = GA1_data_long_ind_short[which(GA1_data_long_ind_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c(option = "plasma")+
  theme_bw()+
  theme(legend.justification = "top")

snake<-GA1_data_long_ind_short[which(GA1_data_long_ind_short$species=="snake"),]
newt_GA1<-GA1_data_long_ind_short[which(GA1_data_long_ind_short$species=="newt"),]
newt_GA1$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt_GA1$measurement), use="complete.obs")



newt_GA1$info[newt_GA1$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt_GA1$info[newt_GA1$location %in% list(0, 19, 80, 99)] <- "corner"
newt_GA1$info[is.na(newt_GA1$info)]<- "middle"

extra_plot <- ggplot(newt_GA1)+
  ggtitle("Num of Ind") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)
    
```

### {-}


### Late Simulation Correlation {.tabset}


#### Mean 
```{r, cor grid neg cor mean}
file_name="Snake_1e-08_0.005_Newt_1e-08_0.005_3"
spegen=48001
 #"Snake_1e-11_0.158_Newt_1e-10_0.05_0"
# file_name= "Snake_1e-08_0.005_Newt_1e-11_0.158_0"
# file_name= "Snake_1e-10_0.05_Newt_1e-11_0.158_3"
# file_name= "Snake_1e-08_0.005_Newt_1e-08_0.005_0"
# file_name= "Snake_1e-10_0.05_Newt_1e-09_0.0158_0"
#Snake_1.0e-08_0.005_Newt_1.0e-11_0.158_0


GA1<-inter_inter_grid_tall_file[which(inter_inter_grid_tall_file$snake_newt_rep==file_name & inter_inter_grid_tall_file$generation==spegen),]

GA1_mean = GA1[,grepl("generation|mean", names(GA1)) ]

data_long_mean <- gather(GA1_mean, condition, measurement, newt_mean_pheno_0:snake_mean_pheno_99, factor_key=TRUE)

data_long_mean[,c("species","type", "type2","location")]<- str_split_fixed(data_long_mean$condition, "_", 4)

data_long_mean_short<-data_long_mean

data_long_mean_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
data_long_mean_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))

main_plot<-ggplot(data_long_mean_short)+
  labs(title = "Mean Phenotype of Locations",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Toxicity/Resistance")+
  geom_point(data = data_long_mean_short[which(data_long_mean_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = data_long_mean_short[which(data_long_mean_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c()+
  theme_bw()+
  theme(legend.justification = "top")

snake<-data_long_mean_short[which(data_long_mean_short$species=="snake"),]
newt<-data_long_mean_short[which(data_long_mean_short$species=="newt"),]
newt$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt$measurement), use="complete.obs")


newt$info[newt$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt$info[newt$location %in% list(0, 19, 80, 99)] <- "corner"
newt$info[is.na(newt$info)]<- "middle"

extra_plot <- ggplot(newt)+
  ggtitle("Mean Phenotype") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)
```

#### SD 
```{r, cor grid neg cor SD}

file_name="Snake_1e-08_0.005_Newt_1e-08_0.005_3"
spegen=48001
# SD

GA1_sd = GA1[,grepl("generation|sd", names(GA1)) ]

data_long_sd <- gather(GA1_sd, condition, measurement, newt_sd_pheno_0:snake_sd_pheno_99, factor_key=TRUE)

data_long_sd[,c("species","type", "type2","location")]<- str_split_fixed(data_long_sd$condition, "_", 4)

data_long_sd_short<-data_long_sd

data_long_sd_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
data_long_sd_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))

main_plot<-ggplot(data_long_sd_short)+
  labs(title = "SD Phenotype of Locations",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Toxicity/Resistance")+
  geom_point(data = data_long_sd_short[which(data_long_sd_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = data_long_sd_short[which(data_long_sd_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c()+
  theme_bw()+
  theme(legend.justification = "top")

snake<-data_long_sd_short[which(data_long_sd_short$species=="snake"),]
newt<-data_long_sd_short[which(data_long_sd_short$species=="newt"),]
newt$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt$measurement), use="complete.obs")


newt$info[newt$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt$info[newt$location %in% list(0, 19, 80, 99)] <- "corner"
newt$info[is.na(newt$info)]<- "middle"

extra_plot <- ggplot(newt)+
  ggtitle("SD Phenotype") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)
```

#### Max Phenotype 
```{r, cor grid neg cor max}

# max phenotype
file_name="Snake_1e-08_0.005_Newt_1e-08_0.005_3"
spegen=48001

GA1_max = GA1[,grepl("generation|max", names(GA1)) ]

data_long_max <- gather(GA1_max, condition, measurement, newt_max_pheno_0:snake_max_pheno_99, factor_key=TRUE)

data_long_max[,c("species","type", "type2","location")]<- str_split_fixed(data_long_max$condition, "_", 4)

data_long_max_short<-data_long_max

data_long_max_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
data_long_max_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))

main_plot<-ggplot(data_long_max_short)+
  labs(title = "Max Phenotype of Locations",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Toxicity/Resistance")+
  geom_point(data = data_long_max_short[which(data_long_max_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = data_long_max_short[which(data_long_max_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c()+
  theme_bw()+
  theme(legend.justification = "top")

snake<-data_long_max_short[which(data_long_max_short$species=="snake"),]
newt<-data_long_max_short[which(data_long_max_short$species=="newt"),]
newt$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt$measurement), use="complete.obs")


newt$info[newt$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt$info[newt$location %in% list(0, 19, 80, 99)] <- "corner"
newt$info[is.na(newt$info)]<- "middle"

extra_plot <- ggplot(newt)+
  ggtitle("Max Phenotype") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)
```

#### Min Phenotype 
```{r, cor grid neg cor min}

# min phenotype
file_name="Snake_1e-08_0.005_Newt_1e-08_0.005_3"
spegen=48001
GA1_min = GA1[,grepl("generation|min", names(GA1)) ]

data_long_min <- gather(GA1_min, condition, measurement, newt_min_pheno_0:snake_min_pheno_99, factor_key=TRUE)

data_long_min[,c("species","type", "type2","location")]<- str_split_fixed(data_long_min$condition, "_", 4)

data_long_min_short<-data_long_min

data_long_min_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
data_long_min_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))

main_plot<-ggplot(data_long_min_short)+
  labs(title = "Min Phenotype of Locations",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Toxicity/Resistance")+
  geom_point(data = data_long_min_short[which(data_long_min_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = data_long_min_short[which(data_long_min_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c()+
  theme_bw()+
  theme(legend.justification = "top")

snake<-data_long_min_short[which(data_long_min_short$species=="snake"),]
newt<-data_long_min_short[which(data_long_min_short$species=="newt"),]
newt$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt$measurement), use="complete.obs")


newt$info[newt$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt$info[newt$location %in% list(0, 19, 80, 99)] <- "corner"
newt$info[is.na(newt$info)]<- "middle"

extra_plot <- ggplot(newt)+
  ggtitle("Min Phenotype") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)
```

#### Population Size
```{r, cor grid neg cor popsize}

# max phenotype

file_name="Snake_1e-08_0.005_Newt_1e-08_0.005_3"
spegen=48001
GA1_ind = GA1[,grepl("generation|num_ind", names(GA1)) ]

GA1_data_long_ind <- gather(GA1_ind, condition, measurement, newt_num_ind_0:snake_num_ind_99, factor_key=TRUE)

GA1_data_long_ind[,c("species","type", "type2","location")]<- str_split_fixed(GA1_data_long_ind$condition, "_", 4)

GA1_data_long_ind_short<-GA1_data_long_ind

GA1_data_long_ind_short$y_loc<- rep(c(rep.int(20, 2),rep.int(19, 2),rep.int(18, 2),rep.int(17, 2),rep.int(16, 2),rep.int(15, 2),rep.int(14, 2),rep.int(13, 2),rep.int(12, 2),rep.int(11, 2),rep.int(10, 2),rep.int(9, 2),rep.int(8, 2),rep.int(7, 2),rep.int(6, 2),rep.int(5, 2),rep.int(4, 2),rep.int(3, 2),rep.int(2, 2),rep.int(1, 2)),5)
GA1_data_long_ind_short$x_loc<-c(rep.int(1, 40),rep.int(2, 40),rep.int(3, 40),rep.int(4, 40),rep.int(5, 40))

GA1_data_long_ind_short$measurement[GA1_data_long_ind_short$measurement == 0]  <- NA

main_plot<-ggplot(GA1_data_long_ind_short)+
  labs(title = "Locations of Ind",
              subtitle = paste0(file_name, ", Generation: ", spegen),
              fill = "Number of Individuals")+
  geom_point(data = GA1_data_long_ind_short[which(GA1_data_long_ind_short$species=="snake"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 6, shape = 22, ) +
  geom_point(data = GA1_data_long_ind_short[which(GA1_data_long_ind_short$species=="newt"),], aes(x = x_loc, y = y_loc, fill = as.numeric(measurement)), size = 4, shape = 21, ) +
  scale_fill_viridis_c(option = "plasma")+
  theme_bw()+
  theme(legend.justification = "top")

snake<-GA1_data_long_ind_short[which(GA1_data_long_ind_short$species=="snake"),]
newt_GA1<-GA1_data_long_ind_short[which(GA1_data_long_ind_short$species=="newt"),]
newt_GA1$snake_value <- snake$measurement
cor(as.numeric(snake$measurement), as.numeric(newt_GA1$measurement), use="complete.obs")



newt_GA1$info[newt_GA1$location %in% list(1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20, 39, 40, 59, 60, 79, 81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98)]   <- "edge"
newt_GA1$info[newt_GA1$location %in% list(0, 19, 80, 99)] <- "corner"
newt_GA1$info[is.na(newt_GA1$info)]<- "middle"

extra_plot <- ggplot(newt_GA1)+
  ggtitle("Num of Ind") +
  xlab("Newt") + ylab("Snake")+
  geom_point(aes(x = as.numeric(measurement), y = as.numeric(snake_value), color=info), size = 1 ) +
  theme_bw()+
   theme(text = element_text(size=10),title =element_text(size=8),
         legend.text = element_text(size = 8),
         legend.position ="bottom",
         legend.key.size = unit(0.1, "lines"),
         legend.title=element_blank())+
  guides(shape = guide_legend(override.aes = list(size = 1)),
         color = guide_legend(override.aes = list(size = 1)))

#try to arrage the grids

main_plot +  inset_element(extra_plot, left = 1., bottom = -0.12, right = 1.35, top = 0.5)
    
```

### {-}

## Extra

This is a bonus section showing how long my simulation took to get to certain generations

```{r, time}

min_gen=0
max_gen=10000
x_label="generation"
y_label="time (hours)"
subt="test"
title="time test"
plot <- ggplot(inter_tall_tall_file[ which(inter_tall_tall_file$generation>=min_gen & inter_tall_tall_file$generation<=max_gen),]) +
    facet_wrap(~sim)+
    geom_line(aes(generation, time/3600, group=rep), col="grey")+
    ggtitle(title, subtitle = paste0(subt, " From ", min_gen, " gen to ", max_gen, " gen")) +
    xlab(x_label) + ylab(y_label)+
    theme_bw()  +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8),strip.background = element_blank(), strip.text.x = element_blank())

plot

```


