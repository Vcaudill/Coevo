---
title: "Correlation"
output: html_document
---

```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE,echo = FALSE) 

library(ggplot2)
library(viridis)
library(colorspace)
library(gridExtra)
library(tidyverse)
require(reshape2)
library(plyr)
library(gridGraphics)
library(grid)
library("reshape")
```

## Goals

I am starting to investigate what is going on in small scales in my co-evolution simulation. I decided to get newt and snake information and see in they were correlated in n-n grids. I collected correlated data from the GA experiments from the 5,000, 20,000, and 100,000 simulations. (I also tested the correlations with and without perUnitArea=T. It turns out when you don't have perUnitArea=T the edge of the simulation has a greater effect on the calculations turning the correlations positive.) I also will examine how the correlation values change when the grid has more boxes (smaller area to compare). I will specifically, test 5 by 5, 8 by 8, 10 by 10 and 20 by 20 grids

# Simulation Background

My simulation has newts and snakes coevolving in an arms race! The newts are toxic and interact with resistant snakes. Snakes are attacking and eating the newts, and in order to eat more newts they are becoming more resistant. However, if a snake eats a newt that is more toxic the snake dies. As snakes become more resistant, less toxic newts are being devoured, leaving only the most toxic newts. These toxic newts reproduce and create even more toxic newts. The cycle contentiously repeats. My simulation is run in a two-dimensional space with a x and y axis. 

GA1 experiment values:

- 1e-8*(0.005)^2 = 2.5e-13
- 1e-9*(0.05)^2 = 2.5e-12
- 1e-10*(0.5)^2 = 2.5e-11
- 1e-11*(5.0)^2 = 2.5e-10

GA2 experiment values:

- 1e-8*(0.05)^2 = 2.5e-11
- 1e-9*(0.1581139)^2 = 2.5e-11
- 1e-10*(0.5)^2 = 2.5e-11
- 1e-11*(1.581139)^2 = 2.5e-11
- 1e-12*(5)^2 = 2.5e-11

collected info:

- mean_newt_pheno_By_mean_snake_pheno = cor(c(newt_mean_pheno), c(snake_mean_pheno));
- num_newts_By_num_snakes = cor(c(newt_sum_ind), c(snake_sum_ind));
- sum_newt_pheno_By_num_snake = cor(c(newt_sum_pheno), c(snake_sum_ind));
- sum_snake_pheno_By_num_newt = cor(c(snake_sum_pheno), c(newt_sum_ind));
- sum_newt_pheno_By_num_newt = cor(c(newt_sum_pheno), c(newt_sum_ind));
- sum_snake_pheno_By_snake_newt = cor(c(snake_sum_pheno), c(snake_sum_ind));
	
Tested Grids

- (5, 5)
- (8, 8)
- (10, 10)
- (20, 20)

Something I noticed when playing around with different variables in my simulation was that there was a large effect when I was changing interaction rate. So I will also look at that here. Special note when interaction rate is increased newts and snake may avoid each other. 
	
## My Prediction

Before running this experiment, I thought about the possible outcomes. I am looking at relationships between species phenotypes, population size, and resistance and toxicity between different sized regions. I predicted that the number of newts and the amount of toxicity & the number of snakes and the amount of resistance will be very correlated (green line). I also predicted that when newts and snakes are co-evolving then their phenotypes would be positively correlated (blue line). I think that the number of newts will be negativity correlated with the population size of snakes and vice-versa (purple line). For example, if there are more snakes in a specific region (and the amount of snakes are increasing) then there wold be less newts (and the amount of newts would be decreasing). I also predict that the amount of toxin in a region will be negatively correlated with the population size of snakes & that resistance will also be negatively correlated with the population size of newts (red line). For example, if the newts on a specific region become more toxic (increasing the total amount of toxicity) the number of snakes will decrease (as they try to eat a more toxic newt they die). Below is a graphical representation of my predictions.

```{r, cor prediction}

timeline = 0:100

five_six = c(0, .2, .4, .7)
five_six = c(five_six, rep.int(1, length(timeline)-length(five_six)))
three_four = c(rep(0,9), -.03, -.1, rep(-.2,5), rep(-.3,4), rep(-.4,3), rep(-.5,3), rep(-.6,2))
three_four = c(three_four, rep(-.7, length(timeline)-length(three_four)))
two = c(rep(0,13),rep(-.05,9), rep(-.1,7), rep(-.2,5), rep(-.3,3))
two = c(two, rep(-.4, length(timeline)-length(two)))
one = c(rep(0,8), rep(0.2,5), rep(0.3,4), rep(0.4,9), rep(0.5,8), rep(0.6,7))
one = c(one, rep(0.7, length(timeline)-length(one)))

plot(timeline, one, type="l", col="blue", ylim=c(-1, 1),)
lines(timeline, two, col="purple")
lines(timeline, three_four, col="red")
lines(timeline, five_six, col="green")
legend(35, 0.5, legend=c("newt by snake pheno", "#newts by #snakes", "toxin by #snakes & resistance by #newts", "#newts by toxin & #snakes by resitance"), col=c("blue","purple", "red", "green"), lty=1, cex=0.8)
```

After, plotting the results number of newts by the amount toxin and the number of snakes by the amount of resistance was very close to 1. It is not plotted in my main results. 
	
## Data collection

First, I process the data that I collected from the cost 1on1 slim simulations. There are 16 different simulations in the GA1 experiment and 25 different simulations in the GA2 experiment (I will refer to these simulations as groups). Here I will output the groups simulation letter along with the mutation rate and effect size of both newts and snakes. I collected data from 8 different simulations groups testing what happens as the length of the simulation increases as and testing how the size of the measured area effects the correlation calculations. 
	
```{r, Cor data gather, cache=TRUE}
#Reading in the names of files to cycle through them
lit_5000_files <- list.files(path="~/Desktop/cor_5000/cor_byUnit/text_files", pattern="GA5_lit_", full.names=TRUE, recursive=FALSE)
cor_5000_files <- list.files(path="~/Desktop/cor_5000/cor_byUnit/text_files", pattern="GA5_cor_", full.names=TRUE, recursive=FALSE)

lit_5000_files_HI <- list.files(path="~/Desktop/cor_5000/cor_byUnit/text_files", pattern="GA55_lit_", full.names=TRUE, recursive=FALSE)
cor_5000_files_HI <- list.files(path="~/Desktop/cor_5000/cor_byUnit/text_files", pattern="GA55_cor_", full.names=TRUE, recursive=FALSE)

lit_20000_files <- list.files(path="~/Desktop/cor_20000/cor_byUnit/text_files", pattern="GA55_lit_", full.names=TRUE, recursive=FALSE)
cor_20000_files <- list.files(path="~/Desktop/cor_20000/cor_byUnit/text_files", pattern="GA55_cor_", full.names=TRUE, recursive=FALSE)

lit_100000_files <- list.files(path="~/Desktop/cor_100000/cor_byUnit/text_files", pattern="GA55_lit_", full.names=TRUE, recursive=FALSE)
cor_100000_files <- list.files(path="~/Desktop/cor_100000/cor_byUnit/text_files", pattern="GA55_cor_", full.names=TRUE, recursive=FALSE)

lit_5000_files_88 <- list.files(path="~/Desktop/cor_5000/cor_byUnit/text_files", pattern="GA88_lit_", full.names=TRUE, recursive=FALSE)
cor_5000_files_88 <- list.files(path="~/Desktop/cor_5000/cor_byUnit/text_files", pattern="GA88_cor_", full.names=TRUE, recursive=FALSE)

lit_5000_files_1010 <- list.files(path="~/Desktop/cor_5000/cor_byUnit/text_files", pattern="GA1010_lit_", full.names=TRUE, recursive=FALSE)
cor_5000_files_1010 <- list.files(path="~/Desktop/cor_5000/cor_byUnit/text_files", pattern="GA1010_cor_", full.names=TRUE, recursive=FALSE)

lit_5000_files_2020 <- list.files(path="~/Desktop/cor_5000/cor_byUnit/text_files", pattern="GA2020_lit_", full.names=TRUE, recursive=FALSE)
cor_5000_files_2020 <- list.files(path="~/Desktop/cor_5000/cor_byUnit/text_files", pattern="GA2020_cor_", full.names=TRUE, recursive=FALSE)

GA2_lit_5000_files <- list.files(path="~/Desktop/cor_GA2_5000/cor_byUnit/text_files", pattern="GA55_lit_", full.names=TRUE, recursive=FALSE)
GA2_cor_5000_files <- list.files(path="~/Desktop/cor_GA2_5000/cor_byUnit/text_files", pattern="GA55_cor_", full.names=TRUE, recursive=FALSE)

GA2_lit_30000_files <- list.files(path="~/Desktop/cor_GA2_30000", pattern="GA55_lit_", full.names=TRUE, recursive=FALSE)
GA2_cor_30000_files <- list.files(path="~/Desktop/cor_GA2_30000/", pattern="GA55_cor_", full.names=TRUE, recursive=FALSE)

#files <- list.files(path="~/Desktop/GA_lt/doover/text_files", pattern="GA_lit_", full.names=TRUE, recursive=FALSE)
# Reading in the first file from the list to add a new column. To compare simulations with different params
number=1
cor_5000_file <- read.table(cor_5000_files[number], header = TRUE)
GA_5000_file <- read.table(lit_5000_files[number], header = TRUE)

cor_20000_file <- read.table(cor_20000_files[number], header = TRUE)
GA_20000_file <- read.table(lit_20000_files[number], header = TRUE)

cor_100000_file <- read.table(cor_100000_files[number], header = TRUE)
GA_100000_file <- read.table(lit_100000_files[number], header = TRUE)

cor_5000_file_88 <- read.table(cor_5000_files_88[number], header = TRUE)
GA_5000_file_88 <- read.table(lit_5000_files_88[number], header = TRUE)

cor_5000_file_1010 <- read.table(cor_5000_files_1010[number], header = TRUE)
GA_5000_file_1010 <- read.table(lit_5000_files_1010[number], header = TRUE)

cor_5000_file_2020 <- read.table(cor_5000_files_2020[number], header = TRUE)
GA_5000_file_2020 <- read.table(lit_5000_files_2020[number], header = TRUE)

GA2_cor_5000_file <- read.table(GA2_cor_5000_files[number], header = TRUE)
GA2_GA_5000_file <- read.table(GA2_lit_5000_files[number], header = TRUE)

GA2_cor_30000_file <- read.table(GA2_cor_30000_files[number], header = TRUE)
GA2_GA_30000_file <- read.table(GA2_lit_30000_files[number], header = TRUE)

GA_5000_file$sim <-"A"
cor_5000_file$sim <-"A"

GA_20000_file$sim <-"A"
cor_20000_file$sim <-"A"

GA_100000_file$sim <-"A"
cor_100000_file$sim <-"A"

GA_5000_file_88$sim <-"A"
cor_5000_file_88$sim <-"A"

GA_5000_file_1010$sim <-"A"
cor_5000_file_1010$sim <-"A"

GA_5000_file_2020$sim <-"A"
cor_5000_file_2020$sim <-"A"

GA2_GA_5000_file$sim <-"A"
GA2_cor_5000_file$sim <-"A"

GA2_GA_30000_file$sim <-"A"
GA2_cor_30000_file$sim <-"A"

#Cycle through the different simulations to make one file. Not recommended for large files, but right now mine are small
for(i in seq(1, length(GA2_lit_5000_files), 1)){
  myletter <- LETTERS[i]
  
  GA2_lit_temp_file <- read.table(GA2_lit_5000_files[i], header = TRUE)
  GA2_lit_temp_file$sim <-LETTERS[i]
  GA2_cor_temp_file <- read.table(GA2_cor_5000_files[i], header = TRUE)
  GA2_cor_temp_file$sim <-LETTERS[i]
  
  GA2_lit_30_temp_file <- read.table(GA2_lit_30000_files[i], header = TRUE)
  GA2_lit_30_temp_file$sim <-LETTERS[i]
  GA2_cor_30_temp_file <- read.table(GA2_cor_30000_files[i], header = TRUE)
  GA2_cor_30_temp_file$sim <-LETTERS[i]
  
  GA2_GA_5000_file <- rbind(GA2_GA_5000_file, GA2_lit_temp_file)
  GA2_cor_5000_file <- rbind(GA2_cor_5000_file, GA2_cor_temp_file)
  
  GA2_GA_30000_file <- rbind(GA2_GA_30000_file, GA2_lit_30_temp_file)
  GA2_cor_30000_file <- rbind(GA2_cor_30000_file, GA2_cor_30_temp_file)
  
  if (i<=length(lit_5000_files)){
  lit_temp_file <- read.table(lit_5000_files[i], header = TRUE)
  lit_temp_file$sim <-LETTERS[i]
  
  lit_temp_file_2 <- read.table(lit_20000_files[i], header = TRUE)
  lit_temp_file_2$sim <-LETTERS[i]
  
  lit_temp_file_3 <- read.table(lit_100000_files[i], header = TRUE)
  lit_temp_file_3$sim <-LETTERS[i]
  
  lit_temp_file_4 <- read.table(lit_5000_files_88[i], header = TRUE)
  lit_temp_file_4$sim <-LETTERS[i]
  
  lit_temp_file_5 <- read.table(lit_5000_files_1010[i], header = TRUE)
  lit_temp_file_5$sim <-LETTERS[i]
  
  lit_temp_file_6 <- read.table(lit_5000_files_2020[i], header = TRUE)
  lit_temp_file_6$sim <-LETTERS[i]
  
  cor_temp_file <- read.table(cor_5000_files[i], header = TRUE)
  cor_temp_file$sim <-LETTERS[i]
  
  cor_temp_file_2 <- read.table(cor_20000_files[i], header = TRUE)
  cor_temp_file_2$sim <-LETTERS[i]
  
  cor_temp_file_3 <- read.table(cor_100000_files[i], header = TRUE)
  cor_temp_file_3$sim <-LETTERS[i]
  
  cor_temp_file_4 <- read.table(cor_5000_files_88[i], header = TRUE)
  cor_temp_file_4$sim <-LETTERS[i]
  
  cor_temp_file_5 <- read.table(cor_5000_files_1010[i], header = TRUE)
  cor_temp_file_5$sim <-LETTERS[i]
  
  cor_temp_file_6 <- read.table(cor_5000_files_2020[i], header = TRUE)
  cor_temp_file_6$sim <-LETTERS[i]
  
  
  GA_5000_file <- rbind(GA_5000_file, lit_temp_file)
  GA_20000_file <- rbind(GA_20000_file, lit_temp_file_2)
  GA_100000_file <- rbind(GA_100000_file, lit_temp_file_3)
  GA_5000_file_88 <- rbind(GA_5000_file_88, lit_temp_file_4)
  GA_5000_file_1010 <- rbind(GA_5000_file_1010, lit_temp_file_5)
  GA_5000_file_2020 <- rbind(GA_5000_file_2020, lit_temp_file_6)
  
  cor_5000_file <- rbind(cor_5000_file, cor_temp_file)
  cor_20000_file <- rbind(cor_20000_file, cor_temp_file_2)
  cor_100000_file <- rbind(cor_100000_file, cor_temp_file_3)
  cor_5000_file_88 <- rbind(cor_5000_file_88, cor_temp_file_4)
  cor_5000_file_1010 <- rbind(cor_5000_file_1010, cor_temp_file_5)
  cor_5000_file_2020 <- rbind(cor_5000_file_2020, cor_temp_file_6)
  
  snake_mu_rate <- unlist(str_split(unlist(str_split(lit_5000_files[i],"snake_mu_rate_"))[2], "_"))[1]
  newt_mu_rate <- unlist(str_split(unlist(str_split(lit_5000_files[i],"newt_mu_rate_"))[2], "_"))[1]
  snake_mu_effect_sd <- unlist(str_split(unlist(str_split(lit_5000_files[i],"snake_mu_effect_sd_"))[2], "_"))[1]
  newt_mu_effect_sd <- unlist(str_split(unlist(str_split(lit_5000_files[i],"newt_mu_effect_sd_"))[2], "_"))[1]
  print(paste0("Simulation ", LETTERS[i],": Snake mu-rate & effect sd (", snake_mu_rate,", ", snake_mu_effect_sd, ") Newt mu-rate & effect sd (", newt_mu_rate, ", ", newt_mu_effect_sd, ")" ))
  }
  
}

# Calculating the difference between mean snake pheno and mean newt pheno

GA_5000_file$dif <- GA_5000_file$Snake_mean_Pheno-GA_5000_file$Newt_mean_Pheno
GA_20000_file$dif <- GA_20000_file$Snake_mean_Pheno-GA_20000_file$Newt_mean_Pheno
GA_100000_file$dif <- GA_100000_file$Snake_mean_Pheno-GA_100000_file$Newt_mean_Pheno
GA_5000_file_88$dif <- GA_5000_file_88$Snake_mean_Pheno-GA_5000_file_88$Newt_mean_Pheno
GA_5000_file_1010$dif <- GA_5000_file_1010$Snake_mean_Pheno-GA_5000_file_1010$Newt_mean_Pheno
GA_5000_file_2020$dif <- GA_5000_file_2020$Snake_mean_Pheno-GA_5000_file_2020$Newt_mean_Pheno
GA2_GA_5000_file$dif <- GA2_GA_5000_file$Snake_mean_Pheno-GA2_GA_5000_file$Newt_mean_Pheno
GA2_GA_5000_file$dif <- GA2_GA_5000_file$Snake_mean_Pheno-GA2_GA_5000_file$Newt_mean_Pheno
GA2_GA_30000_file$dif <- GA2_GA_30000_file$Snake_mean_Pheno-GA2_GA_30000_file$Newt_mean_Pheno
```	




```{r, reusable figures, results='hide', message=FALSE, warning=FALSE, cache=TRUE}

cors_by_gen <- function(file, title, subt, x_label, y_label){
  print("CA = mean_newt_pheno_By_mean_snake_pheno")
  print("CB = num_newts_By_num_snakes")
  print("CC = sum_newt_pheno_By_num_snake")
  print("CD = sum_snake_pheno_By_num_newt")

  plot <- ggplot(file) +
  #xlim(0, 1000)+
  ggtitle(title, subtitle = subt) +
  xlab(x_label) + ylab(y_label)+
  geom_line(aes(x=as.numeric(gen), y=as.numeric(mean_newt_pheno_By_mean_snake_pheno), color = "CA"))+
  geom_line(aes(x=as.numeric(gen), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  geom_line(aes(x=as.numeric(gen), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  geom_line(aes(x=as.numeric(gen), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  theme(plot.title = element_text(size=5)) +

  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8))


  return(plot)
}

boxplot_cors_by_gen <- function(file, subt, x_label, y_label){

  plot <- ggplot(file) +
  ylim(-1.1, 1.1)+
  ggtitle(subt) +
  xlab(x_label) + ylab(y_label)+
  geom_boxplot(aes(x=factor("CA"), y=as.numeric(mean_newt_pheno_By_mean_snake_pheno), color = "CA"))+
  geom_boxplot(aes(x=factor("CB"), y=as.numeric(num_newts_By_num_snakes), color = "CB"))+
  geom_boxplot(aes(x=factor("CC"), y=as.numeric(sum_newt_pheno_By_num_snake), color = "CC"))+
  geom_boxplot(aes(x=factor("CD"), y=as.numeric(sum_snake_pheno_By_num_newt), color = "CD"))+
  theme(plot.title = element_text(size=5)) +
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())


  return(plot)
}


#boxplot_cors_by_gen(cor_5000_file[which(cor_5000_file$gen>4000),], subt, x_label, y_label)

boxplot_cors_by_type_gen <- function(file, subt, x_label, y_label, mycolor){

  plot <- ggplot(file) +
  ylim(-1.1, 1.1)+
  ggtitle(subt) +
  xlab(x_label) + ylab(y_label)+
  geom_boxplot(aes(x=factor("1"), y=as.numeric(C1)), color = mycolor)+
  geom_boxplot(aes(x=factor("2"), y=as.numeric(C2)), color = mycolor)+
  geom_boxplot(aes(x=factor("3"), y=as.numeric(C3)), color = mycolor)+
  geom_boxplot(aes(x=factor("4"), y=as.numeric(C4)), color = mycolor)+
  theme(plot.title = element_text(size=5)) +
  facet_wrap(~sim)+
  theme_bw() +  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8), legend.position="none",
                      strip.background = element_blank(), strip.text.x = element_blank(),
                      title =element_text(size=8, face='bold'), axis.title.x = element_blank(),
                      axis.title.y = element_blank())


  return(plot)
}

trends_by_gen <- function(file, title, subt, x_label, y_label){
  plot <- ggplot(file) +
    facet_wrap(~sim)+
    geom_line(aes(gen, dif, col="dif"))+
    ggtitle(title, subtitle = subt) +
    geom_line(aes(gen, Snake_mean_Pheno, color="Snake_mean_Pheno"),)+
    geom_line(aes(gen, Newt_mean_Pheno, color="Newt_mean_Pheno"))+
    ylim(-5,10)+
    xlab(x_label) + ylab(y_label)+
    scale_color_manual(name = "Type",
values = c( "Snake_mean_Pheno" = "steelblue", "Newt_mean_Pheno" = "darkred", "dif" = "black"),
labels = c("Snake", "Newt", "Dif"))+
    theme_bw() +theme(axis.text.x = element_text(angle = 45, hjust=1, size = 8))
  return(plot)
}

```

## Correlation Caculations for 5 by 5 grid

Correlation values were collected every 10th generation with the exception of the 1st generation (calculations started gen 2). The first figure presented is the correlation calculations for simulation A up to 5,000 generations with a 5 by 5 grid. The red line represents calculation A which is the correlation between mean newt phenotype and mean snake phenotype (I predict this would be positive). The green line (CB) is the correlation between the number of newts and the number of snakes (I predicted this would be negative). The blue line is (CC) and represents the correlation between the sum of toxicity and the number of snakes. The purple line (CD) is the correlation between the amount of resistance and the number of newt (predicted to be negative). The second figure shows the correlation calculations for all 16 simulations. The third figure shows the mean newt phenotype (red) the snake mean phenotype (blue) and the difference between the snake mean phenotype and the newt mean phenotype (black). I want to use the third figure which is a whole population calculation to the second figure which has a more localized calculation. 

```{r, lest see that correlation, fig.height = 8, fig.width = 10, cache=TRUE}

title="Space: Newt VS Snake"
subt="5,000 Gen Grid 5 by 5"
x_label="Generation"
y_label="Correlation"
my_letter="A"
subt=paste0("Sim ", my_letter, " ", subt)
cors_by_gen(cor_5000_file[which(cor_5000_file$sim==my_letter), ], title, subt, x_label, y_label)


title="Space: Newt VS Snake"
subt="5,000 Gen Grid 5 by 5"
x_label="Generation"
y_label="Correlation"
cors_by_gen(cor_5000_file, title, subt, x_label, y_label)

y_label="Phenotype"
x_label="Generation"
title="Phenotpe by Gen For all Sims"
subt="GA1 5000 Gen"
trends_by_gen(GA_5000_file, title, subt, x_label, y_label)




```

Looking at the figures, can I really tell what is going on? 

In the first figure of the correlation calculations in simulation A my answer would be "no". There are some concerns that I have. My first concern is why is CA starting out a **perfect** correlation. The second concern is the variability between each measurement. The points seem to jump around a lot, sometime being negative to being positive in 10 or so generations. These correlation values look like they are running through a cycle. I do not know if this is concerning but the blue, green, and purple lines are practically on top of each other. Is this due to both newts and snakes having the same GA or is the amount of newts (population size or phenotype) have similar trends to snakes?

In the second figure my answer would be "maybe". There is definitely a difference between the correlation values between these simulations, seen especially in the red line. Sometimes the red line is very high (correlation of 1) and sometimes it is lower or sometimes negative. For the most part the green, blue, and purple lines are close to each other. However, these three lines do differ in some of the simulations particularly when one of the species has a larger effect size. 

In the third figure I would say there is something going on, but is it coevolution "IDK". I have plotted this figure before and talked about its implications in Comparing GA. But now I want to combine what we see here with the figure above it. Let's first look at what the correlation lines are doing when the mean newt phenotypes of newts and snakes are similar/close or cross (A, B, D, E, F, G, M, N). In about half of these there is a high correlation between newt and snake phenotype, but in the other half the correlation is low or a bit negative. If we look at the correlations for the when the mean newt and snake phenotypes are further apart (C, H, I, J, K, L, O, P) the correlation between mean newt phenotype and mean snake phenotype is smaller. However, there might be an increase in the mean newt and mean snake correlation when the newt phenotype is (significantly) higher than the snake phenotype (C, O, P). I wonder if there is any avoiding occurring? Simulation N is a particular interesting case to look at.

#### Zooming in on Correlation Caculations for 5 by 5 grid

This subsection is looking at the above figures, but at a zoomed in section. I only look at the first 200 generations. The goal is to see where the correlation calculations begin and see how they change on a smaller, easier to see time scale.

```{r, cor 5000 zooom, fig.height = 8, fig.width = 10, cache=TRUE}

title="ZOOM Space: Newt VS Snake"
subt="5,000 Gen Grid 5 by 5"
x_label="Generation"
y_label="Correlation"
cors_by_gen(cor_5000_file[ which(cor_5000_file$gen<201),], title, subt, x_label, y_label)


title="ZOOM Phenotpe by Gen For all Sims"
subt="GA1 5000 Gen"
y_label="Phenotype"
trends_by_gen(GA_5000_file[ which(GA_5000_file$gen<201),], title, subt, x_label, y_label)


```

Here the four correlations are calculated and collected every 10 generations. The mean phenotype of newts and snakes are collected every 20 generations. The difference in collect times might lead to more smoothness in one plot vs the other (in this case I don't think that is happening). In the first graph I noticed that the red line (correlation of mean newt phenotype with mean snake phenotype) starts out very positively correlated in some of the simulations. Is this high positive correlation normal or random? When looking at both figures its weird how differently the correlation look when it seems like the mean phenotype of newts and snakes are unchanging. By looking at the correlation plot I wonder what is occurring to create some positive and negative correlations especially for CB, CC, and CD? Because nothing seems dramatic from the total population phenotype mean. What other information might be useful? 

## Running the experiment for longer

The next section I run the GA1 simulations for 20,000 generations and 100,000 generations. To see if there are any major correlation changes that might occur when running my simulation for longer.


```{r, correlation 20000, fig.height = 8, fig.width = 10, cache=TRUE}

title="Space: Newt VS Snake"
subt="20,000 Gen Grid 5 by 5"
x_label="Generation"
y_label="Correlation"
cors_by_gen(cor_20000_file, title, subt, x_label, y_label)

title="Phenotpe by Gen For all Sims"
subt="GA1 20000 Gen"
y_label="Phenotype"
trends_by_gen(GA_20000_file, title, subt, x_label, y_label)

```

The 20,000 generation plots looks very similar to the 5,000 generation plots. It does not look like anything dramatically changes.

```{r, correlation 100000, fig.height = 8, fig.width = 10, cache=TRUE}

title="Space: Newt VS Snake"
subt="100,000 Gen Grid 5 by 5"
x_label="Generation"
y_label="Correlation"
cors_by_gen(cor_100000_file, title, subt, x_label, y_label)

title="Phenotpe by Gen For all Sims"
subt="GA1 100000 Gen"
y_label="Phenotype"
trends_by_gen(GA_100000_file, title, subt, x_label, y_label)


```

Wow, it is extremely hard to tell what is going on when you plot all 100,000 generations at the same time! Something is going on that differentiates these simulations from each other. Some of the simulations have a lower CA or higher CD. Overall, it does not look like increasing the amount of generations has an effect of the correlation values (after a certain amount of generations nothing really changes, but maybe it cycles). It is difficult to determine what is going on in the simulation by looking at correlations alone. Take F and H from the 100,000  generation for an example. Both F and H have a higher CA throughout the simulation CB, CC, and CD are all about the same, but the average mean phenotype for the simulation looks very different. Maybe looking at the variance between different simulations peaks and valleys will give me a better idea of what is happening?

## Camparing Corrilations at Different Simulation Lengths

Here I am going to condense the data down to 1 box plot per calculation per simulation over the last 1,000 generations (of the 5,000, 20,000, and 100,000 generation simulations). This will hopefully be an easier plot to read and compare results between different simulation lengths. There will be three plots the first plot (top left) will be the results for the last 1,000 generations of the 5,000 generation simulation. The second plot (top right) will be the results for the last 1,000 generation of the 20,000 generation plot. The third plot (bottom left) will be the results of the last 1,000 generations of the 100,000 generation simulation. All plots will show the 16 genetic architecture experiments (in this case they are unlabeled due to space, but each starts with A and continues left to right then down to the next line). The x-axis and y-axis are also unlabeled (due to space), but represents which correlation was calculated and its value respectively. The four correlation calculations see printed below:


```{r, boxplotting 5000, fig.height = 8, fig.width = 8, cache=TRUE}
  print("CA = mean_newt_pheno_By_mean_snake_pheno")
  print("CB = num_newts_By_num_snakes")
  print("CC = sum_newt_pheno_By_num_snake")
  print("CD = sum_snake_pheno_By_num_newt")

title="Space: Newt VS Snake"
subt="16sims last 1000Gen 5000, Grid 5 by 5"
x_label="Type"
y_label="Correlation"
G1<-boxplot_cors_by_gen(cor_5000_file[which(cor_5000_file$gen>4000),], subt, x_label, y_label)
title="Space: Newt VS Snake"
subt="16sims last 1000Gen 20000, Grid 5 by 5"
x_label="Type"
y_label="Correlation"
G2<-boxplot_cors_by_gen(cor_20000_file[which(cor_20000_file$gen>19000),], subt, x_label, y_label)
title="Space: Newt VS Snake"
subt="16sims last 1000Gen 100000, Grid 5 by 5"
x_label="Type"
y_label="Correlation"
G3<-boxplot_cors_by_gen(cor_100000_file[which(cor_100000_file$gen>99000),], subt, x_label, y_label)


grid.arrange(G1, G2, G3, nrow=2, top=textGrob("Last 1,000 Gens for Different Simulation Lengths",gp=gpar(fontsize=16,font=3)))


```

The box plots differ between each of the 16 simulations, but are relatively similar between the different simulation lengths (when only looking at 1,000 generations). I was surprised that the box plots had similar lengths between the different simulation times. The correlation between newt phenotype and snake phenotype (CA red) is mostly positive, but can be negative or zero. The correlation between number of newts (newt density) and number of snakes (snake density) (CB green), the correlation between the amount of toxin and the number of snakes (CC blue), and the correlation between the amount of resistance and the number of snakes (CD purple) is mostly negative. These values are negative and do not get past -0.5.

## Corrilation Values as the Number of Boxes Increases

I re-ran the 5,000 generation simulation, but changed the grid size by decreasing the area where the correlation could be calculated. In this case I tried to divide an 35 by 35 area by 8, 10, and 20 boxes. As the number of boxes increase the area in which things may be calculated decreases. The goal is to get close to finding a good amount of area to calculation local adaptation, while not being too large or too small. I will compare the results of the following simulations. Note: I ran 16 slim simulations 4 times (setting the grid at 5, 8, 10, 20) with the same msprime files

```{r, correlation 5000 88, fig.height = 8, fig.width = 10, cache=TRUE}

title="Space: Newt VS Snake"
subt="5,000 Gen Grid 8 by 8"
x_label="Generation"
y_label="Correlation"
cors_by_gen(cor_5000_file_88, title, subt, x_label, y_label)

title="Phenotpe by Gen For all Sims"
subt="GA1 5,000 Gen"
y_label="Phenotype"
trends_by_gen(GA_5000_file_88, title, subt, x_label, y_label)

```

When I increased the number of grids to 8 by 8, the correlation values got lower. The different correlation calculations that I made were less correlated and do not fluctuate between measurements as much as they did when the grid was 5 by 5.

```{r, correlation 5000 1010, fig.height = 8, fig.width = 10, cache=TRUE}

title="Space: Newt VS Snake"
subt="5,000 Gen Grid 10 by 10"
x_label="Generation"
y_label="Correlation"
cors_by_gen(cor_5000_file_1010, title, subt, x_label, y_label)

title="Phenotpe by Gen For all Sims"
subt="GA1 5,000 Gen"
y_label="Phenotype"
trends_by_gen(GA_5000_file_1010, title, subt, x_label, y_label)

```

When I increased the number of grids to 10 by 10, the correlation values looked very similar to the 8 by 8 grid. The 10 by 10 grid had less correlated vales when compared to the 5 by 5 grid. These  correlation calculations were less correlated and do not fluctuate between measurements as much as they did when the grid was 5 by 5. It is also possible that the 10 by 10 grid was just a little bit less correlated than the 8 by 8, but it is a bit difficult to tell. 

```{r, correlation 5000 2020, fig.height = 8, fig.width = 10, cache=TRUE}

title="Space: Newt VS Snake"
subt="5,000 Gen Grid 20 by 20"
x_label="Generation"
y_label="Correlation"
cors_by_gen(cor_5000_file_2020, title, subt, x_label, y_label)

title="Phenotpe by Gen For all Sims"
subt="GA1 5,000 Gen"
y_label="Phenotype"
trends_by_gen(GA_5000_file_2020, title, subt, x_label, y_label)

```
When I change the grid to a 20 by 20 everything was negatively correlated and the correlations did not jump around. 

## Camparing Corrilations at Different Grid

Similar to what I did before, I made box plots of the last 1,000 generation of the 5,000 generation simulations. Here, I will visually compare how changing the amount of area where the correlation calculations took place effect the correlation output. In the top left will be the box plots of the correlations from the 5 by 5 grid to the right is the 8 by 8 grid. Under the 5 by 5 grind will be the 10 by 10 grid and next to it will be the 20 by 20 grid box plots. To save space and see the results there are no labels on the x-axis (correlation calculation), the y-axis (correlation values), or the simulation letter (A starts on the top left and continues right and then to the next line). The four correlation calculations are printed below:

```{r, boxplotting 5000 dif size, fig.height = 8, fig.width = 8, cache=TRUE}
  print("CA = mean_newt_pheno_By_mean_snake_pheno")
  print("CB = num_newts_By_num_snakes")
  print("CC = sum_newt_pheno_By_num_snake")
  print("CD = sum_snake_pheno_By_num_newt")


title="Space: Newt VS Snake"
subt="16sims last 1000Gen 5000, Grid 8 by 8"
x_label="Type"
y_label="Correlation"
G4<-boxplot_cors_by_gen(cor_5000_file_88[which(cor_5000_file_88$gen>4000),], subt, x_label, y_label)

title="Space: Newt VS Snake"
subt="16sims last 1000Gen 5000, Grid 10 by 10"
x_label="Type"
y_label="Correlation"
G5<-boxplot_cors_by_gen(cor_5000_file_1010[which(cor_5000_file_1010$gen>4000),], subt, x_label, y_label)

title="Space: Newt VS Snake"
subt="16sims last 1000Gen 5000, Grid 20 by 20"
x_label="Type"
y_label="Correlation"
G6<-boxplot_cors_by_gen(cor_5000_file_2020[which(cor_5000_file_2020$gen>4000),], subt, x_label, y_label)


grid.arrange(G1, G4, G5, G6, nrow=2, top=textGrob("1000 Gen at Differnt Time Points",gp=gpar(fontsize=16,font=3)))

```

At the number or grids increases the area in which individuals (phenotype or count) shrinks. This area shrinkage can lead to area where few individuals are which could have an effect on the correlation calculations. By decreasing the size of the measured area the variance between data collect points decreases (easily spotted with the red box plot newt phenotype by snake phenotype). When I increased the grid number there was less correlation both in the positive and negative directions. When the grid value was very high (20) everything became centered around 0. What is the best method for choosing the grid size? Is the correlation between the things I measure proof of co-evolution (especially when some of the values started of at 1)?

## GA2 Simulations

Now, I am going to look at the correlations that I calculated for the GA2 experiment. In this experiment the variance for mutations is equal between the species (mu*(effect_size^2)). Below, is the simulation letter and its associated mutation rate and effect size.  

```{r ga2 values, cache=TRUE}

for(i in seq(1, length(GA2_lit_5000_files), 1)){
  myletter <- LETTERS[i]

  snake_mu_rate <- unlist(str_split(unlist(str_split(GA2_lit_5000_files[i],"snake_mu_rate_"))[2], "_"))[1]
  newt_mu_rate <- unlist(str_split(unlist(str_split(GA2_lit_5000_files[i],"newt_mu_rate_"))[2], "_"))[1]
  snake_mu_effect_sd <- unlist(str_split(unlist(str_split(GA2_lit_5000_files[i],"snake_mu_effect_sd_"))[2], "_"))[1]
  newt_mu_effect_sd <- unlist(str_split(unlist(str_split(GA2_lit_5000_files[i],"newt_mu_effect_sd_"))[2], "_"))[1]
  print(paste0("Simulation ", LETTERS[i],": Snake mu-rate & effect sd (", snake_mu_rate,", ", snake_mu_effect_sd, ") Newt mu-rate & effect sd (", newt_mu_rate, ", ", newt_mu_effect_sd, ")" ))
  }


```

The next section contains the results of the correlation calculations and mean phenotypes in the GA2 experiment. The first figure shows 4 correlation results, which were collected with a 5 by 5 grid. The correlation between mean newt phenotype and mean snake phenotype is the red line (CA). The correlation between the number of newts and the number of snakes is the green line (CB). The correlation between the sum of toxicity and the number of snakes is the blue line (CC). The correlation between the amount of resistance and the number of newt is the purple line (CD). This figure shows all 25 simulations in this set. The second figure shows the mean newt phenotype (red) the snake mean phenotype (blue) and the difference between the snake mean phenotype and the newt mean phenotype (black) for all 25 simulations.

```{r, GA2 correlation, fig.height = 8, fig.width = 10, cache=TRUE}

title="GA2 Space: Newt VS Snake"
subt="5,000 Gen Grid 5 by 5"
x_label="Generation"
y_label="Correlation"
cors_by_gen(GA2_cor_5000_file, title, subt, x_label, y_label)

title="Phenotpe by Gen For all Sims"
subt="GA2 5,000 Gen"
y_label="Phenotype"
trends_by_gen(GA2_GA_5000_file, title, subt, x_label, y_label)


```

The first figure shows the 4 correlation calculations collected every 10 generations for a 5,000 simulation. The first thing that I noticed in the first figure was a diminished CA correlation value. I did notice that CA values got a bit higher when the mean newt and snake values on the second plot intersected. These results were similar to the results seen in the GA1 experiment, with the exception of lower CA values. CB, CC, CD are all negative and generally fluctuate between 0 and -0.5. CA has a larger positive fluctuation between 0.0 and 1. The second figure shows the interaction of the mean snake and mean newt phenotypes. In this figure the phenotypes are often close to each other. I looked at both figures and wondered if maybe 5,000 generations was not enough time for a co-evolutionary relationship to form or stabilize. I also wondered why CA was lower (and did not start at 1) in this set of simulations.

#### Zooming in on Correlation Caculations for 5 by 5 grid GA2

Now, I am going to look at the zoomed in section of the GA2 5,000 generation simulations. I plotted the first 200 generations of my simulation and looked at the four correlation calculations and the newt & snake mean phenotype. Mostly, I want to look at where the correlations start off at and see how they immediately change. I want to compare the mean newt and snake phenotypes to the correlations.


```{r, cor 5000 GA2 zooom, fig.height = 8, fig.width = 10, cache=TRUE}

title="GA2 ZOOM Space: Newt VS Snake"
subt="5,000 Gen Grid 5 by 5"
x_label="Generation"
y_label="Correlation"
cors_by_gen(GA2_cor_5000_file[ which(GA2_cor_5000_file$gen<210),], title, subt, x_label, y_label)

title="ZOOM Phenotpe by Gen For all Sims"
subt="GA2 5,000 Gen"
y_label="Phenotype"
trends_by_gen(GA2_GA_5000_file[ which(GA2_GA_5000_file$gen<210),], title, subt, x_label, y_label)

```

The first thing I looked at was the second figure. The blue and red lines are not close together and it doesn't look like there a lot of movement in most of the simulations. Some of the red and blue lines decrease, and very few of the lines seem to increase. However, when looking at the correlation plots a lot of things are happening. There are some cases where things are falling and in other simulations things are going up. The blue, green, and purple generally start near 0. The red line usually starts off positive then decreases then goes back up. Its kind of weird how all four correlation lines can cluster at a certain time, but the mean phenotypes don't seem to change. I looked back at the zoomed in version of the GA1 experiment and found that the red line is a lot further away from the other lines in this experiment set. There was more of a trend in the GA1 experiment than in the GA2 experiment. Maybe it takes more time for co-evolution to occur when the variation between newts and snakes are the same.

## 30,000 Generation Results

In this section, I re-run the 25 GA2 simulations and increased the amount of generations to 30,000 (after looking at the 100,000 gen results). Here, I will again look at the four correlation calculations (CA, CB, CC, CD) and the mean newt and snake phenotypes. I hope to see more interaction between newt and snake mean phenotypes and a stabilization in the correlation calculations. 

```{r, GA2 30000 correlation, fig.height = 8, fig.width = 10, cache=TRUE}

title="GA2 Space: Newt VS Snake"
subt="30,000 Gen Grid 5 by 5"
x_label="Generation"
y_label="Correlation"
cors_by_gen(GA2_cor_30000_file, title, subt, x_label, y_label)

title="Phenotpe by Gen For all Sims"
subt="GA2 30,000 Gen"
y_label="Phenotype"
trends_by_gen(GA2_GA_30000_file, title, subt, x_label, y_label)


```

After looking at the results, I noticed that the the red line (newt and snake phenotype correlation) generally stays high after a certain amount of generations. It is really difficult to see how the purple, blue, and green correlation lines interact. It seems like they are mostly overlap each other. It looks like these three correlations might become a bit more negative as the number of generations increase (at lease in some of the simulations). When looking at the second figure the mean newt and mean snake phenotype usually start out at with one species phenotype being higher and as the number of generations increase both phenotypes increase and eventually cross. There were four simulation where there was no crossing between mean newt and snake phenotype (B, F, H, Y). When snake mean phenotype was higher the correlation between newt and snake phenotype was diminished (F, H), but when newt mean phenotype was higher the correlation was a bit higher (B, Y).

#### Zooming in on 1,000 gen Period of Correlation Caculations for 5 by 5 grid

From the above section I wanted to zoom in on a 1,000 generation section where newt and snake phenotypes seem to be increasing. I choose to look at a section between 10,000 and 11,000 generations.

```{r, cor 30000 GA2 mid zooom, fig.height = 8, fig.width = 10, cache=TRUE}

title="GA2 midZOOM Space: Newt VS Snake"
subt="30,000 Gen Grid 5 by 5"
x_label="Generation"
y_label="Correlation"
cors_by_gen(GA2_cor_30000_file[which(GA2_cor_30000_file$gen>=10000 & GA2_cor_30000_file$gen<11010),], title, subt, x_label, y_label)

title="midZOOM Phenotpe by Gen For all Sims"
subt="GA2 30,000 Gen"
y_label="Phenotype"
trends_by_gen(GA2_GA_30000_file[ which(GA2_GA_30000_file$gen>=10000 & GA2_GA_30000_file$gen<11010),], title, subt, x_label, y_label)

```

I mainly focus on looking for trends in the correlation results and the first one I noticed was how some of the four correlations seem to be following the same up and down pattern (most notably F, H, I, L, M). The blue, green and purple lines are mostly the same. The red line is usually positive and separated from the three other correlation lines. When I add in the second figure to what I observe in the first figure I start thinking about the how the difference in correlations might be dependent on which species currently has a higher phenotype (maybe over all or locally?). Potentially, when the newt mean phenotype is higher (overall) snakes in areas with high local newt phenotypes are under under selection to be more resistant. This selection might create a strong correlation between newt and snake phenotype, but when snakes meet or proceed the high newt phenotype the correlation gets weaker (S, U, V).   

## Boxplot at Different Time Points

To get a better visual of what might be happening to the correlation calculation when I take them at different intervals. I decided to look at box plots. The first box plot I look at all four correlation calculations for each simulation separated by four 1,000 generation sections. The first section is the first 1,000 generation. The second section is taken from the 4,000- 5,000 generations. The third section is from the 10,000-11,000 generation and the last section is the lass 1,000 generation (29,000-30,000). As before, there are no labels on the x-axis (correlation calculation), the y-axis (correlation values), or the simulation letter (A starts on the top left and continues right and then to the next line). The four correlation calculations are printed below:

```{r, boxplotting 30000 dif time, fig.height = 8, fig.width = 8, cache=TRUE}
  print("CA = mean_newt_pheno_By_mean_snake_pheno")
  print("CB = num_newts_By_num_snakes")
  print("CC = sum_newt_pheno_By_num_snake")
  print("CD = sum_snake_pheno_By_num_newt")


title="Space: Newt VS Snake"
subt="25sims first 1000Gen, Grid 5 by 5"
x_label="Type"
y_label="Correlation"
G7<-boxplot_cors_by_gen(GA2_cor_30000_file[which(GA2_cor_30000_file$gen<=1000),], subt, x_label, y_label)

title="Space: Newt VS Snake"
subt="25sims 4000-5000 gen, Grid 5 by 5"
x_label="Type"
y_label="Correlation"
G8<-boxplot_cors_by_gen(GA2_cor_30000_file[which(GA2_cor_30000_file$gen>=4000 & GA2_cor_30000_file$gen<=5000),], subt, x_label, y_label)

title="Space: Newt VS Snake"
subt="25sims 10000-11000, Grid 5 by 5"
x_label="Type"
y_label="Correlation"
G9<-boxplot_cors_by_gen(GA2_cor_30000_file[which(GA2_cor_30000_file$gen>=10000 & GA2_cor_30000_file$gen<=11000),], subt, x_label, y_label)

title="Space: Newt VS Snake"
subt="25sims last 1000Gen 30000, Grid 5 by 5"
x_label="Type"
y_label="Correlation"
G10<-boxplot_cors_by_gen(GA2_cor_30000_file[which(GA2_cor_30000_file$gen>=29000),], subt, x_label, y_label)


grid.arrange(G7, G8, G9, G10, nrow=2, top=textGrob("1,000 Gen at Different Timepoints By Simulation",gp=gpar(fontsize=16,font=3)))

```

This figure is super difficult to read! The only thing I can tell is that the red box is consistently higher than the three other boxes. In the first 5,000 generations the purple box might be less negatively correlated in some of the simulations. However, for the most part the green, blue, and purple box plots look very similar. To see if the correlations were going up or down as the simulation kept running I decided to group the different box plots by which calculation I made. 

The first graph (red) in the next figure is the correlation between newt and snake phenotype (CA) at the four different time points (1 = 0-1,000 gen, 2 = 4,000-5,000 gen, 3 = 10,000-11,000 gen, 4 = 29,000-30,000 gen). The second, third and fourth graph (green, blue, purple) is the correlation between number of newts and number of snakes (CB), the correlation between the amount of toxin and snakes (CC), and the correlation between resistance and number of newts (CD). Again, 1 = 0-1,000 gen, 2 = 4,000-5,000 gen, 3 = 10,000-11,000 gen, 4 = 29,000-30,000 gen.

```{r, regrouping the box plot, cache=TRUE}
# out.width = "1026", out.height = "528"
myvars <- c("gen", "mean_newt_pheno_By_mean_snake_pheno", "sim")
data_CA<-GA2_cor_30000_file[which(GA2_cor_30000_file$gen<=1000),][myvars]
names(data_CA)[names(data_CA) == 'mean_newt_pheno_By_mean_snake_pheno'] <- 'C1'
CA2<-GA2_cor_30000_file[which(GA2_cor_30000_file$gen>=4000 & GA2_cor_30000_file$gen<=5000),]$mean_newt_pheno_By_mean_snake_pheno
CA3<-GA2_cor_30000_file[which(GA2_cor_30000_file$gen>=10000 & GA2_cor_30000_file$gen<=11000),]$mean_newt_pheno_By_mean_snake_pheno
CA4<-GA2_cor_30000_file[which(GA2_cor_30000_file$gen>=29000),]$mean_newt_pheno_By_mean_snake_pheno
data_CA$C2 <- CA2
data_CA$C3 <- CA3
data_CA$C4 <- CA4

myvars <- c("gen", "num_newts_By_num_snakes", "sim")
data_CB<-GA2_cor_30000_file[which(GA2_cor_30000_file$gen<=1000),][myvars]
names(data_CB)[names(data_CB) == 'num_newts_By_num_snakes'] <- 'C1'
CB2<-GA2_cor_30000_file[which(GA2_cor_30000_file$gen>=4000 & GA2_cor_30000_file$gen<=5000),]$num_newts_By_num_snakes
CB3<-GA2_cor_30000_file[which(GA2_cor_30000_file$gen>=10000 & GA2_cor_30000_file$gen<=11000),]$num_newts_By_num_snakes
CB4<-GA2_cor_30000_file[which(GA2_cor_30000_file$gen>=29000),]$num_newts_By_num_snakes
data_CB$C2 <- CB2
data_CB$C3 <- CB3
data_CB$C4 <- CB4

myvars <- c("gen", "sum_newt_pheno_By_num_snake", "sim")
data_CC<-GA2_cor_30000_file[which(GA2_cor_30000_file$gen<=1000),][myvars]
names(data_CC)[names(data_CC) == 'sum_newt_pheno_By_num_snake'] <- 'C1'
CC2<-GA2_cor_30000_file[which(GA2_cor_30000_file$gen>=4000 & GA2_cor_30000_file$gen<=5000),]$sum_newt_pheno_By_num_snake
CC3<-GA2_cor_30000_file[which(GA2_cor_30000_file$gen>=10000 & GA2_cor_30000_file$gen<=11000),]$sum_newt_pheno_By_num_snake
CC4<-GA2_cor_30000_file[which(GA2_cor_30000_file$gen>=29000),]$sum_newt_pheno_By_num_snake
data_CC$C2 <- CC2
data_CC$C3 <- CC3
data_CC$C4 <- CC4


myvars <- c("gen", "sum_snake_pheno_By_num_newt", "sim")
data_CD<-GA2_cor_30000_file[which(GA2_cor_30000_file$gen<=1000),][myvars]
names(data_CD)[names(data_CD) == 'sum_snake_pheno_By_num_newt'] <- 'C1'
CD2<-GA2_cor_30000_file[which(GA2_cor_30000_file$gen>=4000 & GA2_cor_30000_file$gen<=5000),]$sum_snake_pheno_By_num_newt
CD3<-GA2_cor_30000_file[which(GA2_cor_30000_file$gen>=10000 & GA2_cor_30000_file$gen<=11000),]$sum_snake_pheno_By_num_newt
CD4<-GA2_cor_30000_file[which(GA2_cor_30000_file$gen>=29000),]$sum_snake_pheno_By_num_newt
data_CD$C2 <- CD2
data_CD$C3 <- CD3
data_CD$C4 <- CD4

subt="CAs"
x_label="Type"
y_label="Correlation"
CAs<-boxplot_cors_by_type_gen(data_CA, subt, x_label, y_label, mycolor="#F8766D")

subt="CBs"
x_label="Type"
y_label="Correlation"
CBs<-boxplot_cors_by_type_gen(data_CB, subt, x_label, y_label, mycolor="#7CAE00")

subt="CCs"
x_label="Type"
y_label="Correlation"
CCs<-boxplot_cors_by_type_gen(data_CC, subt, x_label, y_label, mycolor="#00BFC4")

subt="CDs"
x_label="Type"
y_label="Correlation"
CDs<-boxplot_cors_by_type_gen(data_CD, subt, x_label, y_label, mycolor="#C77CFF")

```

```{r, regrouping the box plot figure, fig.height = 8, fig.width = 8, cache=TRUE}

grid.arrange(CAs, CBs, CCs, CDs, nrow=2, top = textGrob("1,000 Gens Grouped by Caculation",gp=gpar(fontsize=16,font=3)))


```

The trend between time points was easier to see in this figure. Generally, the correlation between newt and snake phenotype increased at the number of generation increased (except F). The correlation between number of newts and number of snakes (CB), the correlation between the amount of toxin and snakes (CC), and the correlation between resistance and number of newts (CD) generally stay about the same. There are instances where they seem to move in a curved motion (like ~). It makes me wonder what makes these correlations stay between 0 and -0.5. I am also curious to how the correlations are connect to each other, if they are connect to each other.                                                                                                         


## Future Ideas

- How does interaction rate effect the correlation calculations?
- How does avoidance change correlation?
- When I run multiple trials how do I show that information?

## Conclusion 
 
Write after meeting with Peter
